[INFO ] [2018-04-28 09:28:33] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 56876.
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-4c518723-8e6f-46ff-84ff-c7b58e730521
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 09:28:34] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 56885.
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Server created on 192.168.0.152:56885
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 56885, None)
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:56885 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 56885, None)
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 56885, None)
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 56885, None)
[INFO ] [2018-04-28 09:28:35] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:56885 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:56885 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:56885 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:28:36] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:28:37] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 09:28:37] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 09:28:37] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 09:28:38] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[ERROR] [2018-04-28 09:28:41] [ObjectStore:checkSchema:6684] Version information found in metastore differs 2.1.0 from expected schema version 1.2.0. Schema verififcation is disabled hive.metastore.schema.verification so setting version.
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:42] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:43] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Code generated in 235.371078 ms
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 224.7 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:56885 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Created broadcast 3 from 
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 12.3 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:56885 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Created broadcast 4 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 09:28:49] [Logging$class:logInfo:54] Code generated in 14.136273 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218615 bytes result sent to driver
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 416 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.431 s
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.505143 s
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 6.355829 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Removed broadcast_4_piece0 on 192.168.0.152:56885 in memory (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 64.5 MB, free 1926.6 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:56885 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Created broadcast 5 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 28.32805 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 14.429654 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA.scala:96
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Registering RDD 29 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Registering RDD 25 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Got job 1 (saveAsTable at HistoryDataToA.scala:96) with 200 output partitions
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Final stage: ResultStage 3 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Parents of final stage: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Missing parents: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Submitting ShuffleMapStage 1 (MapPartitionsRDD[29] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_6 stored as values in memory (estimated size 12.3 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_6_piece0 stored as bytes in memory (estimated size 6.4 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Added broadcast_6_piece0 in memory on 192.168.0.152:56885 (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Created broadcast 6 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[29] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Adding task set 1.0 with 1 tasks
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Submitting ShuffleMapStage 2 (MapPartitionsRDD[25] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Running task 0.0 in stage 1.0 (TID 1)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_7 stored as values in memory (estimated size 16.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Block broadcast_7_piece0 stored as bytes in memory (estimated size 7.4 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Added broadcast_7_piece0 in memory on 192.168.0.152:56885 (size: 7.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Created broadcast 7 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[25] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Adding task set 2.0 with 1 tasks
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 16.909609 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 14.981678 ms
[INFO ] [2018-04-28 09:28:50] [Logging$class:logInfo:54] Code generated in 57.161304 ms
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1). 1582 bytes result sent to driver
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Running task 0.0 in stage 2.0 (TID 2)
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1) in 1367 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Removed TaskSet 1.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] ShuffleMapStage 1 (saveAsTable at HistoryDataToA.scala:96) finished in 1.369 s
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] running: Set(ShuffleMapStage 2)
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Code generated in 14.913713 ms
[INFO ] [2018-04-28 09:28:52] [Logging$class:logInfo:54] Code generated in 78.166918 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2). 1539 bytes result sent to driver
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2) in 3181 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Removed TaskSet 2.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] ShuffleMapStage 2 (saveAsTable at HistoryDataToA.scala:96) finished in 4.525 s
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] running: Set()
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Submitting ResultStage 3 (MapPartitionsRDD[34] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Block broadcast_8 stored as values in memory (estimated size 114.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Block broadcast_8_piece0 stored as bytes in memory (estimated size 43.3 KB, free 1926.0 MB)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Added broadcast_8_piece0 in memory on 192.168.0.152:56885 (size: 43.3 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Created broadcast 8 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Submitting 200 missing tasks from ResultStage 3 (MapPartitionsRDD[34] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Adding task set 3.0 with 200 tasks
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Starting task 0.0 in stage 3.0 (TID 3, localhost, executor driver, partition 0, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Running task 0.0 in stage 3.0 (TID 3)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Started 0 remote fetches in 5 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 12.165676 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 9.88093 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 19.665954 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 7.05662 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 11.118641 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 14.811767 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Removed broadcast_7_piece0 on 192.168.0.152:56885 in memory (size: 7.4 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Removed broadcast_6_piece0 on 192.168.0.152:56885 in memory (size: 6.4 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 6.726236 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 22.706994 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Code generated in 9.484469 ms
[INFO ] [2018-04-28 09:28:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] attempt_20180428092855_0003_m_000000_0: Committed
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3). 3814 bytes result sent to driver
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Starting task 1.0 in stage 3.0 (TID 4, localhost, executor driver, partition 1, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Running task 1.0 in stage 3.0 (TID 4)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3) in 1269 ms on localhost (executor driver) (1/200)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] attempt_20180428092856_0003_m_000001_0: Committed
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4). 3771 bytes result sent to driver
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Starting task 2.0 in stage 3.0 (TID 5, localhost, executor driver, partition 2, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Running task 2.0 in stage 3.0 (TID 5)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4) in 124 ms on localhost (executor driver) (2/200)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 9 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] attempt_20180428092856_0003_m_000002_0: Committed
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Starting task 3.0 in stage 3.0 (TID 6, localhost, executor driver, partition 3, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5) in 156 ms on localhost (executor driver) (3/200)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Running task 3.0 in stage 3.0 (TID 6)
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092856_0003_m_000003_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 4.0 in stage 3.0 (TID 7, localhost, executor driver, partition 4, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6) in 176 ms on localhost (executor driver) (4/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 4.0 in stage 3.0 (TID 7)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000004_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 5.0 in stage 3.0 (TID 8, localhost, executor driver, partition 5, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 5.0 in stage 3.0 (TID 8)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7) in 169 ms on localhost (executor driver) (5/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000005_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 6.0 in stage 3.0 (TID 9, localhost, executor driver, partition 6, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 6.0 in stage 3.0 (TID 9)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8) in 125 ms on localhost (executor driver) (6/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000006_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 7.0 in stage 3.0 (TID 10, localhost, executor driver, partition 7, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 7.0 in stage 3.0 (TID 10)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9) in 165 ms on localhost (executor driver) (7/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000007_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 8.0 in stage 3.0 (TID 11, localhost, executor driver, partition 8, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 8.0 in stage 3.0 (TID 11)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10) in 129 ms on localhost (executor driver) (8/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 4 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000008_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 9.0 in stage 3.0 (TID 12, localhost, executor driver, partition 9, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 9.0 in stage 3.0 (TID 12)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11) in 151 ms on localhost (executor driver) (9/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000009_0: Committed
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Starting task 10.0 in stage 3.0 (TID 13, localhost, executor driver, partition 10, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Running task 10.0 in stage 3.0 (TID 13)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12) in 142 ms on localhost (executor driver) (10/200)
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092857_0003_m_000010_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 11.0 in stage 3.0 (TID 14, localhost, executor driver, partition 11, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13) in 128 ms on localhost (executor driver) (11/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 11.0 in stage 3.0 (TID 14)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000011_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 12.0 in stage 3.0 (TID 15, localhost, executor driver, partition 12, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14) in 146 ms on localhost (executor driver) (12/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 12.0 in stage 3.0 (TID 15)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000012_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 13.0 in stage 3.0 (TID 16, localhost, executor driver, partition 13, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 13.0 in stage 3.0 (TID 16)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15) in 254 ms on localhost (executor driver) (13/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000013_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16). 3771 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 14.0 in stage 3.0 (TID 17, localhost, executor driver, partition 14, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 14.0 in stage 3.0 (TID 17)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16) in 160 ms on localhost (executor driver) (14/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000014_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 15.0 in stage 3.0 (TID 18, localhost, executor driver, partition 15, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 15.0 in stage 3.0 (TID 18)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17) in 134 ms on localhost (executor driver) (15/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000015_0: Committed
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Starting task 16.0 in stage 3.0 (TID 19, localhost, executor driver, partition 16, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Running task 16.0 in stage 3.0 (TID 19)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18) in 191 ms on localhost (executor driver) (16/200)
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092858_0003_m_000016_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 17.0 in stage 3.0 (TID 20, localhost, executor driver, partition 17, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 17.0 in stage 3.0 (TID 20)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19) in 155 ms on localhost (executor driver) (17/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000017_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 18.0 in stage 3.0 (TID 21, localhost, executor driver, partition 18, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 18.0 in stage 3.0 (TID 21)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20) in 178 ms on localhost (executor driver) (18/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000018_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 19.0 in stage 3.0 (TID 22, localhost, executor driver, partition 19, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 19.0 in stage 3.0 (TID 22)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21) in 89 ms on localhost (executor driver) (19/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000019_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 20.0 in stage 3.0 (TID 23, localhost, executor driver, partition 20, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 20.0 in stage 3.0 (TID 23)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22) in 98 ms on localhost (executor driver) (20/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000020_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 21.0 in stage 3.0 (TID 24, localhost, executor driver, partition 21, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23) in 94 ms on localhost (executor driver) (21/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 21.0 in stage 3.0 (TID 24)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000021_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 22.0 in stage 3.0 (TID 25, localhost, executor driver, partition 22, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 22.0 in stage 3.0 (TID 25)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24) in 100 ms on localhost (executor driver) (22/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000022_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 23.0 in stage 3.0 (TID 26, localhost, executor driver, partition 23, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 23.0 in stage 3.0 (TID 26)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25) in 67 ms on localhost (executor driver) (23/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000023_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 24.0 in stage 3.0 (TID 27, localhost, executor driver, partition 24, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26) in 135 ms on localhost (executor driver) (24/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 24.0 in stage 3.0 (TID 27)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000024_0: Committed
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Starting task 25.0 in stage 3.0 (TID 28, localhost, executor driver, partition 25, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Running task 25.0 in stage 3.0 (TID 28)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27) in 134 ms on localhost (executor driver) (25/200)
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:28:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] attempt_20180428092859_0003_m_000025_0: Committed
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Starting task 26.0 in stage 3.0 (TID 29, localhost, executor driver, partition 26, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Running task 26.0 in stage 3.0 (TID 29)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28) in 198 ms on localhost (executor driver) (26/200)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] attempt_20180428092900_0003_m_000026_0: Committed
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Starting task 27.0 in stage 3.0 (TID 30, localhost, executor driver, partition 27, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29) in 137 ms on localhost (executor driver) (27/200)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Running task 27.0 in stage 3.0 (TID 30)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] attempt_20180428092900_0003_m_000027_0: Committed
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Starting task 28.0 in stage 3.0 (TID 31, localhost, executor driver, partition 28, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30) in 79 ms on localhost (executor driver) (28/200)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Running task 28.0 in stage 3.0 (TID 31)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] attempt_20180428092900_0003_m_000028_0: Committed
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Starting task 29.0 in stage 3.0 (TID 32, localhost, executor driver, partition 29, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Running task 29.0 in stage 3.0 (TID 32)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31) in 549 ms on localhost (executor driver) (29/200)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] attempt_20180428092900_0003_m_000029_0: Committed
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Starting task 30.0 in stage 3.0 (TID 33, localhost, executor driver, partition 30, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Running task 30.0 in stage 3.0 (TID 33)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32) in 100 ms on localhost (executor driver) (30/200)
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092900_0003_m_000030_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 31.0 in stage 3.0 (TID 34, localhost, executor driver, partition 31, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 31.0 in stage 3.0 (TID 34)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33) in 97 ms on localhost (executor driver) (31/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000031_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 32.0 in stage 3.0 (TID 35, localhost, executor driver, partition 32, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34) in 135 ms on localhost (executor driver) (32/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 32.0 in stage 3.0 (TID 35)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000032_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 33.0 in stage 3.0 (TID 36, localhost, executor driver, partition 33, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 33.0 in stage 3.0 (TID 36)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35) in 132 ms on localhost (executor driver) (33/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000033_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 34.0 in stage 3.0 (TID 37, localhost, executor driver, partition 34, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 34.0 in stage 3.0 (TID 37)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36) in 112 ms on localhost (executor driver) (34/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000034_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 35.0 in stage 3.0 (TID 38, localhost, executor driver, partition 35, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 35.0 in stage 3.0 (TID 38)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37) in 107 ms on localhost (executor driver) (35/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000035_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 36.0 in stage 3.0 (TID 39, localhost, executor driver, partition 36, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 36.0 in stage 3.0 (TID 39)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38) in 112 ms on localhost (executor driver) (36/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000036_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 37.0 in stage 3.0 (TID 40, localhost, executor driver, partition 37, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39) in 127 ms on localhost (executor driver) (37/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 37.0 in stage 3.0 (TID 40)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000037_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 38.0 in stage 3.0 (TID 41, localhost, executor driver, partition 38, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 38.0 in stage 3.0 (TID 41)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40) in 149 ms on localhost (executor driver) (38/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] attempt_20180428092901_0003_m_000038_0: Committed
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Starting task 39.0 in stage 3.0 (TID 42, localhost, executor driver, partition 39, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Running task 39.0 in stage 3.0 (TID 42)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41) in 50 ms on localhost (executor driver) (39/200)
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000039_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 40.0 in stage 3.0 (TID 43, localhost, executor driver, partition 40, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 40.0 in stage 3.0 (TID 43)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42) in 90 ms on localhost (executor driver) (40/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000040_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 41.0 in stage 3.0 (TID 44, localhost, executor driver, partition 41, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43) in 64 ms on localhost (executor driver) (41/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 41.0 in stage 3.0 (TID 44)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000041_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 42.0 in stage 3.0 (TID 45, localhost, executor driver, partition 42, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44) in 62 ms on localhost (executor driver) (42/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 42.0 in stage 3.0 (TID 45)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000042_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 43.0 in stage 3.0 (TID 46, localhost, executor driver, partition 43, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 43.0 in stage 3.0 (TID 46)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45) in 186 ms on localhost (executor driver) (43/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000043_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 44.0 in stage 3.0 (TID 47, localhost, executor driver, partition 44, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 44.0 in stage 3.0 (TID 47)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46) in 85 ms on localhost (executor driver) (44/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000044_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 45.0 in stage 3.0 (TID 48, localhost, executor driver, partition 45, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47) in 100 ms on localhost (executor driver) (45/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 45.0 in stage 3.0 (TID 48)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000045_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 46.0 in stage 3.0 (TID 49, localhost, executor driver, partition 46, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48) in 128 ms on localhost (executor driver) (46/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 46.0 in stage 3.0 (TID 49)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000046_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 47.0 in stage 3.0 (TID 50, localhost, executor driver, partition 47, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 47.0 in stage 3.0 (TID 50)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49) in 69 ms on localhost (executor driver) (47/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000047_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 48.0 in stage 3.0 (TID 51, localhost, executor driver, partition 48, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 48.0 in stage 3.0 (TID 51)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50) in 104 ms on localhost (executor driver) (48/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000048_0: Committed
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Starting task 49.0 in stage 3.0 (TID 52, localhost, executor driver, partition 49, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Running task 49.0 in stage 3.0 (TID 52)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51) in 84 ms on localhost (executor driver) (49/200)
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092902_0003_m_000049_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 50.0 in stage 3.0 (TID 53, localhost, executor driver, partition 50, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 50.0 in stage 3.0 (TID 53)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52) in 134 ms on localhost (executor driver) (50/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000050_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 51.0 in stage 3.0 (TID 54, localhost, executor driver, partition 51, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 51.0 in stage 3.0 (TID 54)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53) in 89 ms on localhost (executor driver) (51/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000051_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 52.0 in stage 3.0 (TID 55, localhost, executor driver, partition 52, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 52.0 in stage 3.0 (TID 55)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54) in 122 ms on localhost (executor driver) (52/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000052_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 53.0 in stage 3.0 (TID 56, localhost, executor driver, partition 53, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 53.0 in stage 3.0 (TID 56)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55) in 78 ms on localhost (executor driver) (53/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 3 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000053_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 54.0 in stage 3.0 (TID 57, localhost, executor driver, partition 54, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56) in 125 ms on localhost (executor driver) (54/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 54.0 in stage 3.0 (TID 57)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000054_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 55.0 in stage 3.0 (TID 58, localhost, executor driver, partition 55, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 55.0 in stage 3.0 (TID 58)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57) in 64 ms on localhost (executor driver) (55/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000055_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 56.0 in stage 3.0 (TID 59, localhost, executor driver, partition 56, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58) in 137 ms on localhost (executor driver) (56/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 56.0 in stage 3.0 (TID 59)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000056_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 57.0 in stage 3.0 (TID 60, localhost, executor driver, partition 57, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59) in 123 ms on localhost (executor driver) (57/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 57.0 in stage 3.0 (TID 60)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000057_0: Committed
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Starting task 58.0 in stage 3.0 (TID 61, localhost, executor driver, partition 58, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Running task 58.0 in stage 3.0 (TID 61)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60) in 66 ms on localhost (executor driver) (58/200)
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092903_0003_m_000058_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 59.0 in stage 3.0 (TID 62, localhost, executor driver, partition 59, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 59.0 in stage 3.0 (TID 62)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61) in 123 ms on localhost (executor driver) (59/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000059_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 60.0 in stage 3.0 (TID 63, localhost, executor driver, partition 60, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 60.0 in stage 3.0 (TID 63)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62) in 88 ms on localhost (executor driver) (60/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000060_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 61.0 in stage 3.0 (TID 64, localhost, executor driver, partition 61, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63) in 150 ms on localhost (executor driver) (61/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 61.0 in stage 3.0 (TID 64)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000061_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 62.0 in stage 3.0 (TID 65, localhost, executor driver, partition 62, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 62.0 in stage 3.0 (TID 65)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64) in 81 ms on localhost (executor driver) (62/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000062_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 63.0 in stage 3.0 (TID 66, localhost, executor driver, partition 63, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65) in 92 ms on localhost (executor driver) (63/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 63.0 in stage 3.0 (TID 66)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000063_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 64.0 in stage 3.0 (TID 67, localhost, executor driver, partition 64, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 64.0 in stage 3.0 (TID 67)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66) in 123 ms on localhost (executor driver) (64/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000064_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 65.0 in stage 3.0 (TID 68, localhost, executor driver, partition 65, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 65.0 in stage 3.0 (TID 68)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67) in 122 ms on localhost (executor driver) (65/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000065_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 66.0 in stage 3.0 (TID 69, localhost, executor driver, partition 66, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 66.0 in stage 3.0 (TID 69)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68) in 70 ms on localhost (executor driver) (66/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000066_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 67.0 in stage 3.0 (TID 70, localhost, executor driver, partition 67, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 67.0 in stage 3.0 (TID 70)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69) in 107 ms on localhost (executor driver) (67/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000067_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 68.0 in stage 3.0 (TID 71, localhost, executor driver, partition 68, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 68.0 in stage 3.0 (TID 71)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70) in 46 ms on localhost (executor driver) (68/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000068_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 69.0 in stage 3.0 (TID 72, localhost, executor driver, partition 69, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 69.0 in stage 3.0 (TID 72)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71) in 63 ms on localhost (executor driver) (69/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] attempt_20180428092904_0003_m_000069_0: Committed
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Starting task 70.0 in stage 3.0 (TID 73, localhost, executor driver, partition 70, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Running task 70.0 in stage 3.0 (TID 73)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72) in 50 ms on localhost (executor driver) (70/200)
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000070_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 71.0 in stage 3.0 (TID 74, localhost, executor driver, partition 71, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 71.0 in stage 3.0 (TID 74)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73) in 121 ms on localhost (executor driver) (71/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000071_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 72.0 in stage 3.0 (TID 75, localhost, executor driver, partition 72, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 72.0 in stage 3.0 (TID 75)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74) in 79 ms on localhost (executor driver) (72/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000072_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 73.0 in stage 3.0 (TID 76, localhost, executor driver, partition 73, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 73.0 in stage 3.0 (TID 76)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75) in 89 ms on localhost (executor driver) (73/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000073_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 74.0 in stage 3.0 (TID 77, localhost, executor driver, partition 74, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 74.0 in stage 3.0 (TID 77)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76) in 45 ms on localhost (executor driver) (74/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000074_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 75.0 in stage 3.0 (TID 78, localhost, executor driver, partition 75, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 75.0 in stage 3.0 (TID 78)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77) in 44 ms on localhost (executor driver) (75/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000075_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 76.0 in stage 3.0 (TID 79, localhost, executor driver, partition 76, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 76.0 in stage 3.0 (TID 79)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78) in 100 ms on localhost (executor driver) (76/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000076_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 77.0 in stage 3.0 (TID 80, localhost, executor driver, partition 77, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 77.0 in stage 3.0 (TID 80)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79) in 101 ms on localhost (executor driver) (77/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000077_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 78.0 in stage 3.0 (TID 81, localhost, executor driver, partition 78, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 78.0 in stage 3.0 (TID 81)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80) in 84 ms on localhost (executor driver) (78/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000078_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 79.0 in stage 3.0 (TID 82, localhost, executor driver, partition 79, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 79.0 in stage 3.0 (TID 82)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81) in 116 ms on localhost (executor driver) (79/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000079_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 80.0 in stage 3.0 (TID 83, localhost, executor driver, partition 80, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 80.0 in stage 3.0 (TID 83)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82) in 72 ms on localhost (executor driver) (80/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] attempt_20180428092905_0003_m_000080_0: Committed
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Starting task 81.0 in stage 3.0 (TID 84, localhost, executor driver, partition 81, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83) in 138 ms on localhost (executor driver) (81/200)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Running task 81.0 in stage 3.0 (TID 84)
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000081_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 82.0 in stage 3.0 (TID 85, localhost, executor driver, partition 82, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84) in 111 ms on localhost (executor driver) (82/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 82.0 in stage 3.0 (TID 85)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000082_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 83.0 in stage 3.0 (TID 86, localhost, executor driver, partition 83, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 83.0 in stage 3.0 (TID 86)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85) in 140 ms on localhost (executor driver) (83/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000083_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 84.0 in stage 3.0 (TID 87, localhost, executor driver, partition 84, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 84.0 in stage 3.0 (TID 87)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86) in 111 ms on localhost (executor driver) (84/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000084_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 85.0 in stage 3.0 (TID 88, localhost, executor driver, partition 85, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 85.0 in stage 3.0 (TID 88)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87) in 86 ms on localhost (executor driver) (85/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000085_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 86.0 in stage 3.0 (TID 89, localhost, executor driver, partition 86, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 86.0 in stage 3.0 (TID 89)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88) in 115 ms on localhost (executor driver) (86/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000086_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 87.0 in stage 3.0 (TID 90, localhost, executor driver, partition 87, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 87.0 in stage 3.0 (TID 90)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89) in 75 ms on localhost (executor driver) (87/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000087_0: Committed
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Starting task 88.0 in stage 3.0 (TID 91, localhost, executor driver, partition 88, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Running task 88.0 in stage 3.0 (TID 91)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90) in 287 ms on localhost (executor driver) (88/200)
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092906_0003_m_000088_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91). 3771 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 89.0 in stage 3.0 (TID 92, localhost, executor driver, partition 89, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91) in 151 ms on localhost (executor driver) (89/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 89.0 in stage 3.0 (TID 92)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000089_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 90.0 in stage 3.0 (TID 93, localhost, executor driver, partition 90, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 90.0 in stage 3.0 (TID 93)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92) in 90 ms on localhost (executor driver) (90/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000090_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 91.0 in stage 3.0 (TID 94, localhost, executor driver, partition 91, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 91.0 in stage 3.0 (TID 94)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93) in 85 ms on localhost (executor driver) (91/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000091_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 92.0 in stage 3.0 (TID 95, localhost, executor driver, partition 92, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 92.0 in stage 3.0 (TID 95)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94) in 95 ms on localhost (executor driver) (92/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000092_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 93.0 in stage 3.0 (TID 96, localhost, executor driver, partition 93, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95) in 126 ms on localhost (executor driver) (93/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 93.0 in stage 3.0 (TID 96)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 2 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000093_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 94.0 in stage 3.0 (TID 97, localhost, executor driver, partition 94, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 94.0 in stage 3.0 (TID 97)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96) in 123 ms on localhost (executor driver) (94/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000094_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 95.0 in stage 3.0 (TID 98, localhost, executor driver, partition 95, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 95.0 in stage 3.0 (TID 98)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97) in 131 ms on localhost (executor driver) (95/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000095_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 96.0 in stage 3.0 (TID 99, localhost, executor driver, partition 96, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98) in 64 ms on localhost (executor driver) (96/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 96.0 in stage 3.0 (TID 99)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000096_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 97.0 in stage 3.0 (TID 100, localhost, executor driver, partition 97, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99) in 78 ms on localhost (executor driver) (97/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 97.0 in stage 3.0 (TID 100)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000097_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 98.0 in stage 3.0 (TID 101, localhost, executor driver, partition 98, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 98.0 in stage 3.0 (TID 101)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100) in 49 ms on localhost (executor driver) (98/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000098_0: Committed
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Starting task 99.0 in stage 3.0 (TID 102, localhost, executor driver, partition 99, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101) in 45 ms on localhost (executor driver) (99/200)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Running task 99.0 in stage 3.0 (TID 102)
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092907_0003_m_000099_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 100.0 in stage 3.0 (TID 103, localhost, executor driver, partition 100, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 100.0 in stage 3.0 (TID 103)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102) in 87 ms on localhost (executor driver) (100/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000100_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 101.0 in stage 3.0 (TID 104, localhost, executor driver, partition 101, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 101.0 in stage 3.0 (TID 104)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103) in 74 ms on localhost (executor driver) (101/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000101_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 102.0 in stage 3.0 (TID 105, localhost, executor driver, partition 102, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104) in 47 ms on localhost (executor driver) (102/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 102.0 in stage 3.0 (TID 105)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000102_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 103.0 in stage 3.0 (TID 106, localhost, executor driver, partition 103, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 103.0 in stage 3.0 (TID 106)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105) in 79 ms on localhost (executor driver) (103/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000103_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 104.0 in stage 3.0 (TID 107, localhost, executor driver, partition 104, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 104.0 in stage 3.0 (TID 107)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106) in 82 ms on localhost (executor driver) (104/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000104_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 105.0 in stage 3.0 (TID 108, localhost, executor driver, partition 105, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 105.0 in stage 3.0 (TID 108)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107) in 117 ms on localhost (executor driver) (105/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000105_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 106.0 in stage 3.0 (TID 109, localhost, executor driver, partition 106, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 106.0 in stage 3.0 (TID 109)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108) in 73 ms on localhost (executor driver) (106/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000106_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 107.0 in stage 3.0 (TID 110, localhost, executor driver, partition 107, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 107.0 in stage 3.0 (TID 110)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109) in 49 ms on localhost (executor driver) (107/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000107_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 108.0 in stage 3.0 (TID 111, localhost, executor driver, partition 108, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 108.0 in stage 3.0 (TID 111)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110) in 45 ms on localhost (executor driver) (108/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000108_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 109.0 in stage 3.0 (TID 112, localhost, executor driver, partition 109, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 109.0 in stage 3.0 (TID 112)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111) in 44 ms on localhost (executor driver) (109/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000109_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 110.0 in stage 3.0 (TID 113, localhost, executor driver, partition 110, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112) in 93 ms on localhost (executor driver) (110/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 110.0 in stage 3.0 (TID 113)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000110_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 111.0 in stage 3.0 (TID 114, localhost, executor driver, partition 111, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 111.0 in stage 3.0 (TID 114)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113) in 84 ms on localhost (executor driver) (111/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000111_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 112.0 in stage 3.0 (TID 115, localhost, executor driver, partition 112, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 112.0 in stage 3.0 (TID 115)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114) in 89 ms on localhost (executor driver) (112/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000112_0: Committed
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Starting task 113.0 in stage 3.0 (TID 116, localhost, executor driver, partition 113, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Running task 113.0 in stage 3.0 (TID 116)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115) in 95 ms on localhost (executor driver) (113/200)
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092908_0003_m_000113_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 114.0 in stage 3.0 (TID 117, localhost, executor driver, partition 114, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116) in 112 ms on localhost (executor driver) (114/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 114.0 in stage 3.0 (TID 117)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000114_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 115.0 in stage 3.0 (TID 118, localhost, executor driver, partition 115, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 115.0 in stage 3.0 (TID 118)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117) in 143 ms on localhost (executor driver) (115/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000115_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 116.0 in stage 3.0 (TID 119, localhost, executor driver, partition 116, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 116.0 in stage 3.0 (TID 119)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118) in 40 ms on localhost (executor driver) (116/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000116_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 117.0 in stage 3.0 (TID 120, localhost, executor driver, partition 117, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 117.0 in stage 3.0 (TID 120)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119) in 139 ms on localhost (executor driver) (117/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000117_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 118.0 in stage 3.0 (TID 121, localhost, executor driver, partition 118, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 118.0 in stage 3.0 (TID 121)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120) in 114 ms on localhost (executor driver) (118/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000118_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121) in 86 ms on localhost (executor driver) (119/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 119.0 in stage 3.0 (TID 122, localhost, executor driver, partition 119, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 119.0 in stage 3.0 (TID 122)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000119_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 120.0 in stage 3.0 (TID 123, localhost, executor driver, partition 120, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 120.0 in stage 3.0 (TID 123)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122) in 97 ms on localhost (executor driver) (120/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000120_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 121.0 in stage 3.0 (TID 124, localhost, executor driver, partition 121, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 121.0 in stage 3.0 (TID 124)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123) in 61 ms on localhost (executor driver) (121/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000121_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 122.0 in stage 3.0 (TID 125, localhost, executor driver, partition 122, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124) in 133 ms on localhost (executor driver) (122/200)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 122.0 in stage 3.0 (TID 125)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] attempt_20180428092909_0003_m_000122_0: Committed
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Starting task 123.0 in stage 3.0 (TID 126, localhost, executor driver, partition 123, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Running task 123.0 in stage 3.0 (TID 126)
[INFO ] [2018-04-28 09:29:09] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125) in 114 ms on localhost (executor driver) (123/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000123_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 124.0 in stage 3.0 (TID 127, localhost, executor driver, partition 124, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126) in 152 ms on localhost (executor driver) (124/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 124.0 in stage 3.0 (TID 127)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000124_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 125.0 in stage 3.0 (TID 128, localhost, executor driver, partition 125, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 125.0 in stage 3.0 (TID 128)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127) in 116 ms on localhost (executor driver) (125/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000125_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 126.0 in stage 3.0 (TID 129, localhost, executor driver, partition 126, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 126.0 in stage 3.0 (TID 129)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128) in 132 ms on localhost (executor driver) (126/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000126_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 127.0 in stage 3.0 (TID 130, localhost, executor driver, partition 127, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 127.0 in stage 3.0 (TID 130)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129) in 89 ms on localhost (executor driver) (127/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000127_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 128.0 in stage 3.0 (TID 131, localhost, executor driver, partition 128, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 128.0 in stage 3.0 (TID 131)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130) in 133 ms on localhost (executor driver) (128/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000128_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 129.0 in stage 3.0 (TID 132, localhost, executor driver, partition 129, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 129.0 in stage 3.0 (TID 132)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131) in 46 ms on localhost (executor driver) (129/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000129_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 130.0 in stage 3.0 (TID 133, localhost, executor driver, partition 130, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 130.0 in stage 3.0 (TID 133)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132) in 41 ms on localhost (executor driver) (130/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000130_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 131.0 in stage 3.0 (TID 134, localhost, executor driver, partition 131, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 131.0 in stage 3.0 (TID 134)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133) in 58 ms on localhost (executor driver) (131/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000131_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 132.0 in stage 3.0 (TID 135, localhost, executor driver, partition 132, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 132.0 in stage 3.0 (TID 135)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134) in 42 ms on localhost (executor driver) (132/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000132_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 133.0 in stage 3.0 (TID 136, localhost, executor driver, partition 133, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 133.0 in stage 3.0 (TID 136)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135) in 110 ms on localhost (executor driver) (133/200)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] attempt_20180428092910_0003_m_000133_0: Committed
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Starting task 134.0 in stage 3.0 (TID 137, localhost, executor driver, partition 134, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Running task 134.0 in stage 3.0 (TID 137)
[INFO ] [2018-04-28 09:29:10] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136) in 90 ms on localhost (executor driver) (134/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000134_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 135.0 in stage 3.0 (TID 138, localhost, executor driver, partition 135, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137) in 77 ms on localhost (executor driver) (135/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 135.0 in stage 3.0 (TID 138)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000135_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 136.0 in stage 3.0 (TID 139, localhost, executor driver, partition 136, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 136.0 in stage 3.0 (TID 139)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138) in 50 ms on localhost (executor driver) (136/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000136_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 137.0 in stage 3.0 (TID 140, localhost, executor driver, partition 137, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 137.0 in stage 3.0 (TID 140)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139) in 105 ms on localhost (executor driver) (137/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000137_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 138.0 in stage 3.0 (TID 141, localhost, executor driver, partition 138, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 138.0 in stage 3.0 (TID 141)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140) in 48 ms on localhost (executor driver) (138/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000138_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 139.0 in stage 3.0 (TID 142, localhost, executor driver, partition 139, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 139.0 in stage 3.0 (TID 142)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141) in 80 ms on localhost (executor driver) (139/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000139_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 140.0 in stage 3.0 (TID 143, localhost, executor driver, partition 140, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 140.0 in stage 3.0 (TID 143)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142) in 78 ms on localhost (executor driver) (140/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000140_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 141.0 in stage 3.0 (TID 144, localhost, executor driver, partition 141, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 141.0 in stage 3.0 (TID 144)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143) in 74 ms on localhost (executor driver) (141/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000141_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 142.0 in stage 3.0 (TID 145, localhost, executor driver, partition 142, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 142.0 in stage 3.0 (TID 145)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144) in 47 ms on localhost (executor driver) (142/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000142_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 143.0 in stage 3.0 (TID 146, localhost, executor driver, partition 143, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 143.0 in stage 3.0 (TID 146)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145) in 87 ms on localhost (executor driver) (143/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000143_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 144.0 in stage 3.0 (TID 147, localhost, executor driver, partition 144, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 144.0 in stage 3.0 (TID 147)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146) in 103 ms on localhost (executor driver) (144/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000144_0: Committed
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Starting task 145.0 in stage 3.0 (TID 148, localhost, executor driver, partition 145, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Running task 145.0 in stage 3.0 (TID 148)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147) in 201 ms on localhost (executor driver) (145/200)
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092911_0003_m_000145_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 146.0 in stage 3.0 (TID 149, localhost, executor driver, partition 146, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 146.0 in stage 3.0 (TID 149)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148) in 83 ms on localhost (executor driver) (146/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000146_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 147.0 in stage 3.0 (TID 150, localhost, executor driver, partition 147, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 147.0 in stage 3.0 (TID 150)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149) in 43 ms on localhost (executor driver) (147/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000147_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 148.0 in stage 3.0 (TID 151, localhost, executor driver, partition 148, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 148.0 in stage 3.0 (TID 151)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150) in 39 ms on localhost (executor driver) (148/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000148_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 149.0 in stage 3.0 (TID 152, localhost, executor driver, partition 149, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 149.0 in stage 3.0 (TID 152)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151) in 40 ms on localhost (executor driver) (149/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000149_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 150.0 in stage 3.0 (TID 153, localhost, executor driver, partition 150, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 150.0 in stage 3.0 (TID 153)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152) in 35 ms on localhost (executor driver) (150/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000150_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153). 3771 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 151.0 in stage 3.0 (TID 154, localhost, executor driver, partition 151, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153) in 76 ms on localhost (executor driver) (151/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 151.0 in stage 3.0 (TID 154)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000151_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 152.0 in stage 3.0 (TID 155, localhost, executor driver, partition 152, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 152.0 in stage 3.0 (TID 155)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154) in 106 ms on localhost (executor driver) (152/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000152_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 153.0 in stage 3.0 (TID 156, localhost, executor driver, partition 153, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 153.0 in stage 3.0 (TID 156)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155) in 93 ms on localhost (executor driver) (153/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000153_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 154.0 in stage 3.0 (TID 157, localhost, executor driver, partition 154, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 154.0 in stage 3.0 (TID 157)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156) in 72 ms on localhost (executor driver) (154/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000154_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 155.0 in stage 3.0 (TID 158, localhost, executor driver, partition 155, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 155.0 in stage 3.0 (TID 158)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157) in 49 ms on localhost (executor driver) (155/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000155_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 156.0 in stage 3.0 (TID 159, localhost, executor driver, partition 156, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158) in 47 ms on localhost (executor driver) (156/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 156.0 in stage 3.0 (TID 159)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000156_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 157.0 in stage 3.0 (TID 160, localhost, executor driver, partition 157, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 157.0 in stage 3.0 (TID 160)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159) in 43 ms on localhost (executor driver) (157/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000157_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 158.0 in stage 3.0 (TID 161, localhost, executor driver, partition 158, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 158.0 in stage 3.0 (TID 161)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160) in 76 ms on localhost (executor driver) (158/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000158_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 159.0 in stage 3.0 (TID 162, localhost, executor driver, partition 159, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 159.0 in stage 3.0 (TID 162)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161) in 77 ms on localhost (executor driver) (159/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000159_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 160.0 in stage 3.0 (TID 163, localhost, executor driver, partition 160, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 160.0 in stage 3.0 (TID 163)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162) in 66 ms on localhost (executor driver) (160/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000160_0: Committed
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Starting task 161.0 in stage 3.0 (TID 164, localhost, executor driver, partition 161, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Running task 161.0 in stage 3.0 (TID 164)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163) in 89 ms on localhost (executor driver) (161/200)
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092912_0003_m_000161_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 162.0 in stage 3.0 (TID 165, localhost, executor driver, partition 162, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 162.0 in stage 3.0 (TID 165)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164) in 70 ms on localhost (executor driver) (162/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000162_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 163.0 in stage 3.0 (TID 166, localhost, executor driver, partition 163, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 163.0 in stage 3.0 (TID 166)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165) in 131 ms on localhost (executor driver) (163/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000163_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 164.0 in stage 3.0 (TID 167, localhost, executor driver, partition 164, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 164.0 in stage 3.0 (TID 167)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166) in 49 ms on localhost (executor driver) (164/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000164_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 165.0 in stage 3.0 (TID 168, localhost, executor driver, partition 165, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 165.0 in stage 3.0 (TID 168)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167) in 102 ms on localhost (executor driver) (165/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000165_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 166.0 in stage 3.0 (TID 169, localhost, executor driver, partition 166, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 166.0 in stage 3.0 (TID 169)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168) in 107 ms on localhost (executor driver) (166/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000166_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 167.0 in stage 3.0 (TID 170, localhost, executor driver, partition 167, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 167.0 in stage 3.0 (TID 170)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169) in 110 ms on localhost (executor driver) (167/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000167_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 168.0 in stage 3.0 (TID 171, localhost, executor driver, partition 168, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 168.0 in stage 3.0 (TID 171)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170) in 125 ms on localhost (executor driver) (168/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000168_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 169.0 in stage 3.0 (TID 172, localhost, executor driver, partition 169, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 169.0 in stage 3.0 (TID 172)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171) in 69 ms on localhost (executor driver) (169/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000169_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 170.0 in stage 3.0 (TID 173, localhost, executor driver, partition 170, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 170.0 in stage 3.0 (TID 173)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172) in 70 ms on localhost (executor driver) (170/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000170_0: Committed
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Starting task 171.0 in stage 3.0 (TID 174, localhost, executor driver, partition 171, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Running task 171.0 in stage 3.0 (TID 174)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173) in 117 ms on localhost (executor driver) (171/200)
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092913_0003_m_000171_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 172.0 in stage 3.0 (TID 175, localhost, executor driver, partition 172, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 172.0 in stage 3.0 (TID 175)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174) in 97 ms on localhost (executor driver) (172/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000172_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 173.0 in stage 3.0 (TID 176, localhost, executor driver, partition 173, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 173.0 in stage 3.0 (TID 176)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175) in 89 ms on localhost (executor driver) (173/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000173_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 174.0 in stage 3.0 (TID 177, localhost, executor driver, partition 174, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 174.0 in stage 3.0 (TID 177)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176) in 88 ms on localhost (executor driver) (174/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000174_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 175.0 in stage 3.0 (TID 178, localhost, executor driver, partition 175, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 175.0 in stage 3.0 (TID 178)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177) in 94 ms on localhost (executor driver) (175/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000175_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 176.0 in stage 3.0 (TID 179, localhost, executor driver, partition 176, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 176.0 in stage 3.0 (TID 179)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178) in 85 ms on localhost (executor driver) (176/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000176_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 177.0 in stage 3.0 (TID 180, localhost, executor driver, partition 177, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 177.0 in stage 3.0 (TID 180)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179) in 71 ms on localhost (executor driver) (177/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000177_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 178.0 in stage 3.0 (TID 181, localhost, executor driver, partition 178, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 178.0 in stage 3.0 (TID 181)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180) in 65 ms on localhost (executor driver) (178/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000178_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 179.0 in stage 3.0 (TID 182, localhost, executor driver, partition 179, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 179.0 in stage 3.0 (TID 182)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181) in 45 ms on localhost (executor driver) (179/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000179_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 180.0 in stage 3.0 (TID 183, localhost, executor driver, partition 180, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 180.0 in stage 3.0 (TID 183)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182) in 92 ms on localhost (executor driver) (180/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000180_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 181.0 in stage 3.0 (TID 184, localhost, executor driver, partition 181, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 181.0 in stage 3.0 (TID 184)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183) in 47 ms on localhost (executor driver) (181/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000181_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 182.0 in stage 3.0 (TID 185, localhost, executor driver, partition 182, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 182.0 in stage 3.0 (TID 185)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184) in 42 ms on localhost (executor driver) (182/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000182_0: Committed
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Starting task 183.0 in stage 3.0 (TID 186, localhost, executor driver, partition 183, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Running task 183.0 in stage 3.0 (TID 186)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185) in 179 ms on localhost (executor driver) (183/200)
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092914_0003_m_000183_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 184.0 in stage 3.0 (TID 187, localhost, executor driver, partition 184, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 184.0 in stage 3.0 (TID 187)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186) in 134 ms on localhost (executor driver) (184/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000184_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 185.0 in stage 3.0 (TID 188, localhost, executor driver, partition 185, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 185.0 in stage 3.0 (TID 188)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187) in 111 ms on localhost (executor driver) (185/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000185_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 186.0 in stage 3.0 (TID 189, localhost, executor driver, partition 186, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 186.0 in stage 3.0 (TID 189)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188) in 111 ms on localhost (executor driver) (186/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000186_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 187.0 in stage 3.0 (TID 190, localhost, executor driver, partition 187, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189) in 43 ms on localhost (executor driver) (187/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 187.0 in stage 3.0 (TID 190)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000187_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 188.0 in stage 3.0 (TID 191, localhost, executor driver, partition 188, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 188.0 in stage 3.0 (TID 191)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190) in 45 ms on localhost (executor driver) (188/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000188_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 189.0 in stage 3.0 (TID 192, localhost, executor driver, partition 189, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191) in 75 ms on localhost (executor driver) (189/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 189.0 in stage 3.0 (TID 192)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000189_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 190.0 in stage 3.0 (TID 193, localhost, executor driver, partition 190, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 190.0 in stage 3.0 (TID 193)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192) in 72 ms on localhost (executor driver) (190/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000190_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 191.0 in stage 3.0 (TID 194, localhost, executor driver, partition 191, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 191.0 in stage 3.0 (TID 194)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193) in 88 ms on localhost (executor driver) (191/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000191_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 192.0 in stage 3.0 (TID 195, localhost, executor driver, partition 192, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 192.0 in stage 3.0 (TID 195)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194) in 59 ms on localhost (executor driver) (192/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000192_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 193.0 in stage 3.0 (TID 196, localhost, executor driver, partition 193, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 193.0 in stage 3.0 (TID 196)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195) in 88 ms on localhost (executor driver) (193/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000193_0: Committed
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Starting task 194.0 in stage 3.0 (TID 197, localhost, executor driver, partition 194, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Running task 194.0 in stage 3.0 (TID 197)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196) in 263 ms on localhost (executor driver) (194/200)
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092915_0003_m_000194_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Starting task 195.0 in stage 3.0 (TID 198, localhost, executor driver, partition 195, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Running task 195.0 in stage 3.0 (TID 198)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197) in 62 ms on localhost (executor driver) (195/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092916_0003_m_000195_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Starting task 196.0 in stage 3.0 (TID 199, localhost, executor driver, partition 196, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Running task 196.0 in stage 3.0 (TID 199)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198) in 117 ms on localhost (executor driver) (196/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092916_0003_m_000196_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Starting task 197.0 in stage 3.0 (TID 200, localhost, executor driver, partition 197, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Running task 197.0 in stage 3.0 (TID 200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199) in 79 ms on localhost (executor driver) (197/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092916_0003_m_000197_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Starting task 198.0 in stage 3.0 (TID 201, localhost, executor driver, partition 198, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Running task 198.0 in stage 3.0 (TID 201)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200) in 78 ms on localhost (executor driver) (198/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092916_0003_m_000198_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Starting task 199.0 in stage 3.0 (TID 202, localhost, executor driver, partition 199, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Running task 199.0 in stage 3.0 (TID 202)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201) in 122 ms on localhost (executor driver) (199/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] attempt_20180428092916_0003_m_000199_0: Committed
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202) in 74 ms on localhost (executor driver) (200/200)
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Removed TaskSet 3.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] ResultStage 3 (saveAsTable at HistoryDataToA.scala:96) finished in 21.220 s
[INFO ] [2018-04-28 09:29:16] [Logging$class:logInfo:54] Job 1 finished: saveAsTable at HistoryDataToA.scala:96, took 25.871007 s
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Starting job: collect at posProductProcessor.scala:222
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Got job 2 (collect at posProductProcessor.scala:222) with 15 output partitions
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Final stage: ResultStage 4 (collect at posProductProcessor.scala:222)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Submitting ResultStage 4 (MapPartitionsRDD[41] at map at posProductProcessor.scala:217), which has no missing parents
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Block broadcast_9 stored as values in memory (estimated size 4.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Block broadcast_9_piece0 stored as bytes in memory (estimated size 2.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Added broadcast_9_piece0 in memory on 192.168.0.152:56885 (size: 2.2 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Created broadcast 9 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 4 (MapPartitionsRDD[41] at map at posProductProcessor.scala:217) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Adding task set 4.0 with 15 tasks
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Starting task 0.0 in stage 4.0 (TID 203, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Running task 0.0 in stage 4.0 (TID 203)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203). 212165 bytes result sent to driver
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Starting task 1.0 in stage 4.0 (TID 204, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Running task 1.0 in stage 4.0 (TID 204)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203) in 205 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 09:29:23] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Block taskresult_204 stored as bytes in memory (estimated size 9.0 MB, free 1917.1 MB)
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Added taskresult_204 in memory on 192.168.0.152:56885 (size: 9.0 MB, free: 1982.5 MB)
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204). 9456675 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Starting task 2.0 in stage 4.0 (TID 205, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Running task 2.0 in stage 4.0 (TID 205)
[INFO ] [2018-04-28 09:29:25] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20180101—20180424.txt:0+3542719
[INFO ] [2018-04-28 09:29:25] [TransportClientFactory:createClient:254] Successfully created connection to /192.168.0.152:56885 after 37 ms (0 ms spent in bootstraps)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204) in 2768 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Removed taskresult_204 on 192.168.0.152:56885 in memory (size: 9.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Block taskresult_205 stored as bytes in memory (estimated size 1275.7 KB, free 1924.8 MB)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Added taskresult_205 in memory on 192.168.0.152:56885 (size: 1275.7 KB, free: 1990.3 MB)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205). 1306351 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Starting task 3.0 in stage 4.0 (TID 206, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Running task 3.0 in stage 4.0 (TID 206)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Removed taskresult_205 on 192.168.0.152:56885 in memory (size: 1275.7 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:26] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205) in 572 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Block taskresult_206 stored as bytes in memory (estimated size 7.3 MB, free 1918.8 MB)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Added taskresult_206 in memory on 192.168.0.152:56885 (size: 7.3 MB, free: 1984.3 MB)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206). 7639217 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Starting task 4.0 in stage 4.0 (TID 207, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Running task 4.0 in stage 4.0 (TID 207)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Starting task 5.0 in stage 4.0 (TID 208, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Running task 5.0 in stage 4.0 (TID 208)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207) in 121 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品档案表.txt:0+5619732
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Removed taskresult_206 on 192.168.0.152:56885 in memory (size: 7.3 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206) in 2139 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Starting task 6.0 in stage 4.0 (TID 209, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Running task 6.0 in stage 4.0 (TID 209)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208) in 158 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Starting task 7.0 in stage 4.0 (TID 210, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Running task 7.0 in stage 4.0 (TID 210)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209) in 7 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Starting task 8.0 in stage 4.0 (TID 211, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210) in 149 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Running task 8.0 in stage 4.0 (TID 211)
[INFO ] [2018-04-28 09:29:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Block taskresult_211 stored as bytes in memory (estimated size 3.5 MB, free 1922.6 MB)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Added taskresult_211 in memory on 192.168.0.152:56885 (size: 3.5 MB, free: 1988.1 MB)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211). 3623649 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Starting task 9.0 in stage 4.0 (TID 212, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Running task 9.0 in stage 4.0 (TID 212)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211) in 957 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 09:29:29] [Logging$class:logInfo:54] Removed taskresult_211 on 192.168.0.152:56885 in memory (size: 3.5 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Block taskresult_212 stored as bytes in memory (estimated size 10.0 MB, free 1916.1 MB)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Added taskresult_212 in memory on 192.168.0.152:56885 (size: 10.0 MB, free: 1981.5 MB)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212). 10512126 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Starting task 10.0 in stage 4.0 (TID 213, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Running task 10.0 in stage 4.0 (TID 213)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212) in 2700 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 09:29:31] [Logging$class:logInfo:54] Removed taskresult_212 on 192.168.0.152:56885 in memory (size: 10.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Block taskresult_213 stored as bytes in memory (estimated size 12.6 MB, free 1913.5 MB)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Added taskresult_213 in memory on 192.168.0.152:56885 (size: 12.6 MB, free: 1978.9 MB)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213). 13243179 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Starting task 11.0 in stage 4.0 (TID 214, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Running task 11.0 in stage 4.0 (TID 214)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20180101—20180424.txt:0+1007100
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214). 426799 bytes result sent to driver
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Starting task 12.0 in stage 4.0 (TID 215, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Running task 12.0 in stage 4.0 (TID 215)
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合优惠商品明细表.txt:0+5532218
[INFO ] [2018-04-28 09:29:34] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214) in 165 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213) in 3438 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Removed taskresult_213 on 192.168.0.152:56885 in memory (size: 12.6 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Block taskresult_215 stored as bytes in memory (estimated size 1747.6 KB, free 1924.4 MB)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Added taskresult_215 in memory on 192.168.0.152:56885 (size: 1747.6 KB, free: 1989.8 MB)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215). 1789536 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Starting task 13.0 in stage 4.0 (TID 216, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Running task 13.0 in stage 4.0 (TID 216)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合商品.txt:0+6682758
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215) in 615 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Removed taskresult_215 on 192.168.0.152:56885 in memory (size: 1747.6 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216). 716 bytes result sent to driver
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Starting task 14.0 in stage 4.0 (TID 217, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Running task 14.0 in stage 4.0 (TID 217)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216) in 115 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217) in 50 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Removed TaskSet 4.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] ResultStage 4 (collect at posProductProcessor.scala:222) finished in 12.377 s
[INFO ] [2018-04-28 09:29:35] [Logging$class:logInfo:54] Job 2 finished: collect at posProductProcessor.scala:222, took 12.386902 s
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 19
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 13
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 0
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 23
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 16
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Removed broadcast_3_piece0 on 192.168.0.152:56885 in memory (size: 21.5 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 9
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 22
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 7
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 2
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 11
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 21
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 8
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 12
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 18
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 10
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Removed broadcast_8_piece0 on 192.168.0.152:56885 in memory (size: 43.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 15
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned shuffle 0
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 17
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 4
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 1
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned shuffle 1
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 3
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Removed broadcast_5_piece0 on 192.168.0.152:56885 in memory (size: 337.8 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 6
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Removed broadcast_9_piece0 on 192.168.0.152:56885 in memory (size: 2.2 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 24
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 20
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 14
[INFO ] [2018-04-28 09:29:38] [Logging$class:logInfo:54] Cleaned accumulator 5
[INFO ] [2018-04-28 09:29:39] [Logging$class:logInfo:54] Parsing command: ba_model.banner_promotion
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA.scala:108
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Got job 3 (saveAsTable at HistoryDataToA.scala:108) with 15 output partitions
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Final stage: ResultStage 5 (saveAsTable at HistoryDataToA.scala:108)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Submitting ResultStage 5 (MapPartitionsRDD[44] at saveAsTable at HistoryDataToA.scala:108), which has no missing parents
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Block broadcast_10 stored as values in memory (estimated size 81.5 KB, free 1991.2 MB)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Block broadcast_10_piece0 stored as bytes in memory (estimated size 31.0 KB, free 1991.2 MB)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Added broadcast_10_piece0 in memory on 192.168.0.152:56885 (size: 31.0 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Created broadcast 10 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 5 (MapPartitionsRDD[44] at saveAsTable at HistoryDataToA.scala:108) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Adding task set 5.0 with 15 tasks
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Starting task 0.0 in stage 5.0 (TID 218, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Running task 0.0 in stage 5.0 (TID 218)
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Code generated in 9.375348 ms
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Code generated in 6.285599 ms
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Code generated in 10.184505 ms
[INFO ] [2018-04-28 09:29:40] [Logging$class:logInfo:54] Code generated in 36.348636 ms
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Code generated in 19.25741 ms
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Code generated in 19.43072 ms
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Code generated in 16.830694 ms
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] attempt_20180428092941_0005_m_000000_0: Committed
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Starting task 1.0 in stage 5.0 (TID 219, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Running task 1.0 in stage 5.0 (TID 219)
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218) in 340 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 09:29:41] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] attempt_20180428092943_0005_m_000001_0: Committed
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Starting task 2.0 in stage 5.0 (TID 220, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219) in 2345 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Running task 2.0 in stage 5.0 (TID 220)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20180101—20180424.txt:0+3542719
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] attempt_20180428092943_0005_m_000002_0: Committed
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Starting task 3.0 in stage 5.0 (TID 221, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Running task 3.0 in stage 5.0 (TID 221)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220) in 348 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 09:29:43] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] attempt_20180428092945_0005_m_000003_0: Committed
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221). 1878 bytes result sent to driver
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Starting task 4.0 in stage 5.0 (TID 222, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Running task 4.0 in stage 5.0 (TID 222)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221) in 1557 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092945_0005_m_000004_0
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Starting task 5.0 in stage 5.0 (TID 223, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Running task 5.0 in stage 5.0 (TID 223)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222) in 60 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品档案表.txt:0+5619732
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092945_0005_m_000005_0
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Starting task 6.0 in stage 5.0 (TID 224, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Running task 6.0 in stage 5.0 (TID 224)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223) in 126 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092945_0005_m_000006_0
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224). 1710 bytes result sent to driver
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Starting task 7.0 in stage 5.0 (TID 225, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224) in 13 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Running task 7.0 in stage 5.0 (TID 225)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092945_0005_m_000007_0
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225). 1796 bytes result sent to driver
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Starting task 8.0 in stage 5.0 (TID 226, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Running task 8.0 in stage 5.0 (TID 226)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225) in 156 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 09:29:45] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] attempt_20180428092946_0005_m_000008_0: Committed
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226). 1878 bytes result sent to driver
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Starting task 9.0 in stage 5.0 (TID 227, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Running task 9.0 in stage 5.0 (TID 227)
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226) in 781 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 09:29:46] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] attempt_20180428092948_0005_m_000009_0: Committed
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227). 1878 bytes result sent to driver
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Starting task 10.0 in stage 5.0 (TID 228, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Running task 10.0 in stage 5.0 (TID 228)
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227) in 2052 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 09:29:48] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 09:29:50] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] attempt_20180428092950_0005_m_000010_0: Committed
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Starting task 11.0 in stage 5.0 (TID 229, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Running task 11.0 in stage 5.0 (TID 229)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228) in 2487 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20180101—20180424.txt:0+1007100
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] attempt_20180428092951_0005_m_000011_0: Committed
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229). 1792 bytes result sent to driver
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Starting task 12.0 in stage 5.0 (TID 230, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Running task 12.0 in stage 5.0 (TID 230)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229) in 189 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合优惠商品明细表.txt:0+5532218
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] attempt_20180428092951_0005_m_000012_0: Committed
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230). 1792 bytes result sent to driver
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Starting task 13.0 in stage 5.0 (TID 231, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Running task 13.0 in stage 5.0 (TID 231)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230) in 416 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合商品.txt:0+6682758
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092951_0005_m_000013_0
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231). 1796 bytes result sent to driver
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Starting task 14.0 in stage 5.0 (TID 232, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Running task 14.0 in stage 5.0 (TID 232)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231) in 112 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428092951_0005_m_000014_0
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232) in 58 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Removed TaskSet 5.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] ResultStage 5 (saveAsTable at HistoryDataToA.scala:108) finished in 11.032 s
[INFO ] [2018-04-28 09:29:51] [Logging$class:logInfo:54] Job 3 finished: saveAsTable at HistoryDataToA.scala:108, took 11.048395 s
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Persisting file based data source table `ba_model`.`banner_promotion` into Hive metastore in Hive compatible format.
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Recover all the partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Found 1 partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Finished to gather the fast stats for all 1 partitions.
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Recovered all partitions (1).
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 09:29:52] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-c48e3625-b467-47b2-be92-584c8dc852e2
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 09:51:41] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 57334.
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-893fa550-9cf9-4e9a-9ad3-70cd74c3de3c
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 57343.
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Server created on 192.168.0.152:57343
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 57343, None)
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:57343 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 57343, None)
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 57343, None)
[INFO ] [2018-04-28 09:51:42] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 57343, None)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:57343 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:57343 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:57343 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:51:43] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 09:51:45] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 09:51:45] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 09:51:45] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 09:51:45] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 09:51:49] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 09:51:49] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 09:51:49] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:50] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:51] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:51:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 09:51:56] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:51:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:51:56] [Logging$class:logInfo:54] Code generated in 239.091011 ms
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 224.7 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:57343 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Created broadcast 3 from 
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 12.3 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.1 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:57343 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Created broadcast 4 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Code generated in 11.452424 ms
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218658 bytes result sent to driver
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 412 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.427 s
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.504117 s
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Code generated in 7.907689 ms
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 64.5 MB, free 1926.6 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:57343 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Created broadcast 5 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Code generated in 36.478524 ms
[INFO ] [2018-04-28 09:51:57] [Logging$class:logInfo:54] Code generated in 13.898397 ms
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Removed broadcast_4_piece0 on 192.168.0.152:57343 in memory (size: 6.1 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA.scala:96
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Registering RDD 29 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Registering RDD 25 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Got job 1 (saveAsTable at HistoryDataToA.scala:96) with 200 output partitions
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Final stage: ResultStage 3 (saveAsTable at HistoryDataToA.scala:96)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Parents of final stage: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Missing parents: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Submitting ShuffleMapStage 1 (MapPartitionsRDD[29] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Block broadcast_6 stored as values in memory (estimated size 12.3 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Block broadcast_6_piece0 stored as bytes in memory (estimated size 6.4 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Added broadcast_6_piece0 in memory on 192.168.0.152:57343 (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Created broadcast 6 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[29] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Adding task set 1.0 with 1 tasks
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Submitting ShuffleMapStage 2 (MapPartitionsRDD[25] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Block broadcast_7 stored as values in memory (estimated size 16.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Block broadcast_7_piece0 stored as bytes in memory (estimated size 7.4 KB, free 1926.2 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Added broadcast_7_piece0 in memory on 192.168.0.152:57343 (size: 7.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Running task 0.0 in stage 1.0 (TID 1)
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Created broadcast 7 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[25] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Adding task set 2.0 with 1 tasks
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Code generated in 9.818251 ms
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Code generated in 16.688346 ms
[INFO ] [2018-04-28 09:51:58] [Logging$class:logInfo:54] Code generated in 38.710408 ms
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1). 1582 bytes result sent to driver
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Running task 0.0 in stage 2.0 (TID 2)
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1) in 1239 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] ShuffleMapStage 1 (saveAsTable at HistoryDataToA.scala:96) finished in 1.241 s
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] running: Set(ShuffleMapStage 2)
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Removed TaskSet 1.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Code generated in 14.26465 ms
[INFO ] [2018-04-28 09:51:59] [Logging$class:logInfo:54] Code generated in 88.928367 ms
[INFO ] [2018-04-28 09:52:00] [Logging$class:logInfo:54] Removed broadcast_6_piece0 on 192.168.0.152:57343 in memory (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2). 1625 bytes result sent to driver
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2) in 3259 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] ShuffleMapStage 2 (saveAsTable at HistoryDataToA.scala:96) finished in 4.482 s
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] running: Set()
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Submitting ResultStage 3 (MapPartitionsRDD[34] at saveAsTable at HistoryDataToA.scala:96), which has no missing parents
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Removed TaskSet 2.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Block broadcast_8 stored as values in memory (estimated size 114.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Block broadcast_8_piece0 stored as bytes in memory (estimated size 43.4 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Added broadcast_8_piece0 in memory on 192.168.0.152:57343 (size: 43.4 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Created broadcast 8 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Submitting 200 missing tasks from ResultStage 3 (MapPartitionsRDD[34] at saveAsTable at HistoryDataToA.scala:96) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Adding task set 3.0 with 200 tasks
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Starting task 0.0 in stage 3.0 (TID 3, localhost, executor driver, partition 0, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Running task 0.0 in stage 3.0 (TID 3)
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Started 0 remote fetches in 7 ms
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Code generated in 16.596971 ms
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Code generated in 12.380519 ms
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Code generated in 24.807103 ms
[INFO ] [2018-04-28 09:52:02] [Logging$class:logInfo:54] Code generated in 10.585497 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Removed broadcast_7_piece0 on 192.168.0.152:57343 in memory (size: 7.4 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Code generated in 9.136717 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Code generated in 11.731079 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Code generated in 7.464408 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Code generated in 19.52134 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Code generated in 12.849475 ms
[INFO ] [2018-04-28 09:52:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095203_0003_m_000000_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3). 3814 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 1.0 in stage 3.0 (TID 4, localhost, executor driver, partition 1, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3) in 1356 ms on localhost (executor driver) (1/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 1.0 in stage 3.0 (TID 4)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000001_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 2.0 in stage 3.0 (TID 5, localhost, executor driver, partition 2, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4) in 131 ms on localhost (executor driver) (2/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 2.0 in stage 3.0 (TID 5)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000002_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 3.0 in stage 3.0 (TID 6, localhost, executor driver, partition 3, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5) in 147 ms on localhost (executor driver) (3/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 3.0 in stage 3.0 (TID 6)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000003_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 4.0 in stage 3.0 (TID 7, localhost, executor driver, partition 4, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6) in 113 ms on localhost (executor driver) (4/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 4.0 in stage 3.0 (TID 7)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000004_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 5.0 in stage 3.0 (TID 8, localhost, executor driver, partition 5, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7) in 157 ms on localhost (executor driver) (5/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 5.0 in stage 3.0 (TID 8)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000005_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 6.0 in stage 3.0 (TID 9, localhost, executor driver, partition 6, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 6.0 in stage 3.0 (TID 9)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8) in 121 ms on localhost (executor driver) (6/200)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] attempt_20180428095204_0003_m_000006_0: Committed
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Starting task 7.0 in stage 3.0 (TID 10, localhost, executor driver, partition 7, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Running task 7.0 in stage 3.0 (TID 10)
[INFO ] [2018-04-28 09:52:04] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9) in 146 ms on localhost (executor driver) (7/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000007_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 8.0 in stage 3.0 (TID 11, localhost, executor driver, partition 8, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 8.0 in stage 3.0 (TID 11)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10) in 144 ms on localhost (executor driver) (8/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000008_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 9.0 in stage 3.0 (TID 12, localhost, executor driver, partition 9, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11) in 145 ms on localhost (executor driver) (9/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 9.0 in stage 3.0 (TID 12)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000009_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 10.0 in stage 3.0 (TID 13, localhost, executor driver, partition 10, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12) in 213 ms on localhost (executor driver) (10/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 10.0 in stage 3.0 (TID 13)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000010_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 11.0 in stage 3.0 (TID 14, localhost, executor driver, partition 11, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 11.0 in stage 3.0 (TID 14)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13) in 149 ms on localhost (executor driver) (11/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000011_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 12.0 in stage 3.0 (TID 15, localhost, executor driver, partition 12, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 12.0 in stage 3.0 (TID 15)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14) in 145 ms on localhost (executor driver) (12/200)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] attempt_20180428095205_0003_m_000012_0: Committed
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Starting task 13.0 in stage 3.0 (TID 16, localhost, executor driver, partition 13, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Running task 13.0 in stage 3.0 (TID 16)
[INFO ] [2018-04-28 09:52:05] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15) in 213 ms on localhost (executor driver) (13/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000013_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 14.0 in stage 3.0 (TID 17, localhost, executor driver, partition 14, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 14.0 in stage 3.0 (TID 17)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16) in 158 ms on localhost (executor driver) (14/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000014_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 15.0 in stage 3.0 (TID 18, localhost, executor driver, partition 15, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 15.0 in stage 3.0 (TID 18)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17) in 254 ms on localhost (executor driver) (15/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000015_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 16.0 in stage 3.0 (TID 19, localhost, executor driver, partition 16, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 16.0 in stage 3.0 (TID 19)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18) in 173 ms on localhost (executor driver) (16/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000016_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 17.0 in stage 3.0 (TID 20, localhost, executor driver, partition 17, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 17.0 in stage 3.0 (TID 20)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19) in 149 ms on localhost (executor driver) (17/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000017_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 18.0 in stage 3.0 (TID 21, localhost, executor driver, partition 18, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 18.0 in stage 3.0 (TID 21)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20) in 90 ms on localhost (executor driver) (18/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000018_0: Committed
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Starting task 19.0 in stage 3.0 (TID 22, localhost, executor driver, partition 19, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Running task 19.0 in stage 3.0 (TID 22)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21) in 106 ms on localhost (executor driver) (19/200)
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095206_0003_m_000019_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 20.0 in stage 3.0 (TID 23, localhost, executor driver, partition 20, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 20.0 in stage 3.0 (TID 23)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22) in 130 ms on localhost (executor driver) (20/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000020_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 21.0 in stage 3.0 (TID 24, localhost, executor driver, partition 21, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 21.0 in stage 3.0 (TID 24)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23) in 95 ms on localhost (executor driver) (21/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000021_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 22.0 in stage 3.0 (TID 25, localhost, executor driver, partition 22, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24) in 144 ms on localhost (executor driver) (22/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 22.0 in stage 3.0 (TID 25)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000022_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 23.0 in stage 3.0 (TID 26, localhost, executor driver, partition 23, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25) in 97 ms on localhost (executor driver) (23/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 23.0 in stage 3.0 (TID 26)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000023_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 24.0 in stage 3.0 (TID 27, localhost, executor driver, partition 24, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26) in 116 ms on localhost (executor driver) (24/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 24.0 in stage 3.0 (TID 27)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000024_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 25.0 in stage 3.0 (TID 28, localhost, executor driver, partition 25, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27) in 145 ms on localhost (executor driver) (25/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 25.0 in stage 3.0 (TID 28)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000025_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 26.0 in stage 3.0 (TID 29, localhost, executor driver, partition 26, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 26.0 in stage 3.0 (TID 29)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28) in 139 ms on localhost (executor driver) (26/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000026_0: Committed
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Starting task 27.0 in stage 3.0 (TID 30, localhost, executor driver, partition 27, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Running task 27.0 in stage 3.0 (TID 30)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29) in 118 ms on localhost (executor driver) (27/200)
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095207_0003_m_000027_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 28.0 in stage 3.0 (TID 31, localhost, executor driver, partition 28, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30) in 144 ms on localhost (executor driver) (28/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 28.0 in stage 3.0 (TID 31)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000028_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 29.0 in stage 3.0 (TID 32, localhost, executor driver, partition 29, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31) in 93 ms on localhost (executor driver) (29/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 29.0 in stage 3.0 (TID 32)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000029_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 30.0 in stage 3.0 (TID 33, localhost, executor driver, partition 30, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 30.0 in stage 3.0 (TID 33)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32) in 98 ms on localhost (executor driver) (30/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000030_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 31.0 in stage 3.0 (TID 34, localhost, executor driver, partition 31, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33) in 93 ms on localhost (executor driver) (31/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 31.0 in stage 3.0 (TID 34)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000031_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 32.0 in stage 3.0 (TID 35, localhost, executor driver, partition 32, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 32.0 in stage 3.0 (TID 35)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34) in 145 ms on localhost (executor driver) (32/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000032_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35). 3771 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 33.0 in stage 3.0 (TID 36, localhost, executor driver, partition 33, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 33.0 in stage 3.0 (TID 36)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35) in 82 ms on localhost (executor driver) (33/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000033_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 34.0 in stage 3.0 (TID 37, localhost, executor driver, partition 34, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 34.0 in stage 3.0 (TID 37)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36) in 118 ms on localhost (executor driver) (34/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000034_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 35.0 in stage 3.0 (TID 38, localhost, executor driver, partition 35, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 35.0 in stage 3.0 (TID 38)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37) in 52 ms on localhost (executor driver) (35/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000035_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 36.0 in stage 3.0 (TID 39, localhost, executor driver, partition 36, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 36.0 in stage 3.0 (TID 39)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38) in 79 ms on localhost (executor driver) (36/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000036_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 37.0 in stage 3.0 (TID 40, localhost, executor driver, partition 37, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 37.0 in stage 3.0 (TID 40)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39) in 79 ms on localhost (executor driver) (37/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000037_0: Committed
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Starting task 38.0 in stage 3.0 (TID 41, localhost, executor driver, partition 38, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Running task 38.0 in stage 3.0 (TID 41)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40) in 114 ms on localhost (executor driver) (38/200)
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095208_0003_m_000038_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 39.0 in stage 3.0 (TID 42, localhost, executor driver, partition 39, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 39.0 in stage 3.0 (TID 42)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41) in 265 ms on localhost (executor driver) (39/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000039_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 40.0 in stage 3.0 (TID 43, localhost, executor driver, partition 40, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 40.0 in stage 3.0 (TID 43)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42) in 121 ms on localhost (executor driver) (40/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000040_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 41.0 in stage 3.0 (TID 44, localhost, executor driver, partition 41, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 41.0 in stage 3.0 (TID 44)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43) in 73 ms on localhost (executor driver) (41/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000041_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 42.0 in stage 3.0 (TID 45, localhost, executor driver, partition 42, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 42.0 in stage 3.0 (TID 45)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44) in 270 ms on localhost (executor driver) (42/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000042_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 43.0 in stage 3.0 (TID 46, localhost, executor driver, partition 43, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45) in 109 ms on localhost (executor driver) (43/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 43.0 in stage 3.0 (TID 46)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000043_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 44.0 in stage 3.0 (TID 47, localhost, executor driver, partition 44, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 44.0 in stage 3.0 (TID 47)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46) in 91 ms on localhost (executor driver) (44/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] attempt_20180428095209_0003_m_000044_0: Committed
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Starting task 45.0 in stage 3.0 (TID 48, localhost, executor driver, partition 45, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Running task 45.0 in stage 3.0 (TID 48)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47) in 104 ms on localhost (executor driver) (45/200)
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000045_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 46.0 in stage 3.0 (TID 49, localhost, executor driver, partition 46, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 46.0 in stage 3.0 (TID 49)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48) in 50 ms on localhost (executor driver) (46/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000046_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 47.0 in stage 3.0 (TID 50, localhost, executor driver, partition 47, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 47.0 in stage 3.0 (TID 50)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49) in 61 ms on localhost (executor driver) (47/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000047_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 48.0 in stage 3.0 (TID 51, localhost, executor driver, partition 48, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 48.0 in stage 3.0 (TID 51)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50) in 96 ms on localhost (executor driver) (48/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000048_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 49.0 in stage 3.0 (TID 52, localhost, executor driver, partition 49, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 49.0 in stage 3.0 (TID 52)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51) in 119 ms on localhost (executor driver) (49/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000049_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 50.0 in stage 3.0 (TID 53, localhost, executor driver, partition 50, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 50.0 in stage 3.0 (TID 53)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52) in 144 ms on localhost (executor driver) (50/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000050_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 51.0 in stage 3.0 (TID 54, localhost, executor driver, partition 51, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 51.0 in stage 3.0 (TID 54)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53) in 89 ms on localhost (executor driver) (51/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000051_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 52.0 in stage 3.0 (TID 55, localhost, executor driver, partition 52, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 52.0 in stage 3.0 (TID 55)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54) in 129 ms on localhost (executor driver) (52/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000052_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 53.0 in stage 3.0 (TID 56, localhost, executor driver, partition 53, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55) in 89 ms on localhost (executor driver) (53/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 53.0 in stage 3.0 (TID 56)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000053_0: Committed
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Starting task 54.0 in stage 3.0 (TID 57, localhost, executor driver, partition 54, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Running task 54.0 in stage 3.0 (TID 57)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56) in 100 ms on localhost (executor driver) (54/200)
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095210_0003_m_000054_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 55.0 in stage 3.0 (TID 58, localhost, executor driver, partition 55, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 55.0 in stage 3.0 (TID 58)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57) in 269 ms on localhost (executor driver) (55/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000055_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 56.0 in stage 3.0 (TID 59, localhost, executor driver, partition 56, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 56.0 in stage 3.0 (TID 59)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58) in 109 ms on localhost (executor driver) (56/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000056_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 57.0 in stage 3.0 (TID 60, localhost, executor driver, partition 57, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 57.0 in stage 3.0 (TID 60)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59) in 87 ms on localhost (executor driver) (57/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000057_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 58.0 in stage 3.0 (TID 61, localhost, executor driver, partition 58, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 58.0 in stage 3.0 (TID 61)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60) in 52 ms on localhost (executor driver) (58/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000058_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 59.0 in stage 3.0 (TID 62, localhost, executor driver, partition 59, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 59.0 in stage 3.0 (TID 62)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61) in 130 ms on localhost (executor driver) (59/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000059_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 60.0 in stage 3.0 (TID 63, localhost, executor driver, partition 60, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62) in 99 ms on localhost (executor driver) (60/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 60.0 in stage 3.0 (TID 63)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000060_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 61.0 in stage 3.0 (TID 64, localhost, executor driver, partition 61, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 61.0 in stage 3.0 (TID 64)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63) in 125 ms on localhost (executor driver) (61/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000061_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 62.0 in stage 3.0 (TID 65, localhost, executor driver, partition 62, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64) in 93 ms on localhost (executor driver) (62/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 62.0 in stage 3.0 (TID 65)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000062_0: Committed
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Starting task 63.0 in stage 3.0 (TID 66, localhost, executor driver, partition 63, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Running task 63.0 in stage 3.0 (TID 66)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65) in 141 ms on localhost (executor driver) (63/200)
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095211_0003_m_000063_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 64.0 in stage 3.0 (TID 67, localhost, executor driver, partition 64, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66) in 144 ms on localhost (executor driver) (64/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 64.0 in stage 3.0 (TID 67)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000064_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 65.0 in stage 3.0 (TID 68, localhost, executor driver, partition 65, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 65.0 in stage 3.0 (TID 68)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67) in 120 ms on localhost (executor driver) (65/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000065_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 66.0 in stage 3.0 (TID 69, localhost, executor driver, partition 66, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 66.0 in stage 3.0 (TID 69)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68) in 80 ms on localhost (executor driver) (66/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000066_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 67.0 in stage 3.0 (TID 70, localhost, executor driver, partition 67, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 67.0 in stage 3.0 (TID 70)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69) in 132 ms on localhost (executor driver) (67/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000067_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 68.0 in stage 3.0 (TID 71, localhost, executor driver, partition 68, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 68.0 in stage 3.0 (TID 71)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70) in 73 ms on localhost (executor driver) (68/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000068_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 69.0 in stage 3.0 (TID 72, localhost, executor driver, partition 69, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 69.0 in stage 3.0 (TID 72)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71) in 84 ms on localhost (executor driver) (69/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000069_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 70.0 in stage 3.0 (TID 73, localhost, executor driver, partition 70, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 70.0 in stage 3.0 (TID 73)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72) in 99 ms on localhost (executor driver) (70/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000070_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 71.0 in stage 3.0 (TID 74, localhost, executor driver, partition 71, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 71.0 in stage 3.0 (TID 74)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73) in 95 ms on localhost (executor driver) (71/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000071_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 72.0 in stage 3.0 (TID 75, localhost, executor driver, partition 72, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 72.0 in stage 3.0 (TID 75)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74) in 110 ms on localhost (executor driver) (72/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000072_0: Committed
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Starting task 73.0 in stage 3.0 (TID 76, localhost, executor driver, partition 73, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Running task 73.0 in stage 3.0 (TID 76)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75) in 72 ms on localhost (executor driver) (73/200)
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095212_0003_m_000073_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 74.0 in stage 3.0 (TID 77, localhost, executor driver, partition 74, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 74.0 in stage 3.0 (TID 77)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76) in 117 ms on localhost (executor driver) (74/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000074_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 75.0 in stage 3.0 (TID 78, localhost, executor driver, partition 75, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 75.0 in stage 3.0 (TID 78)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77) in 123 ms on localhost (executor driver) (75/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000075_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 76.0 in stage 3.0 (TID 79, localhost, executor driver, partition 76, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 76.0 in stage 3.0 (TID 79)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78) in 74 ms on localhost (executor driver) (76/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000076_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 77.0 in stage 3.0 (TID 80, localhost, executor driver, partition 77, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 77.0 in stage 3.0 (TID 80)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79) in 103 ms on localhost (executor driver) (77/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000077_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 78.0 in stage 3.0 (TID 81, localhost, executor driver, partition 78, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80) in 71 ms on localhost (executor driver) (78/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 78.0 in stage 3.0 (TID 81)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000078_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 79.0 in stage 3.0 (TID 82, localhost, executor driver, partition 79, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81) in 44 ms on localhost (executor driver) (79/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 79.0 in stage 3.0 (TID 82)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000079_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 80.0 in stage 3.0 (TID 83, localhost, executor driver, partition 80, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 80.0 in stage 3.0 (TID 83)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82) in 85 ms on localhost (executor driver) (80/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000080_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 81.0 in stage 3.0 (TID 84, localhost, executor driver, partition 81, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 81.0 in stage 3.0 (TID 84)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83) in 119 ms on localhost (executor driver) (81/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000081_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 82.0 in stage 3.0 (TID 85, localhost, executor driver, partition 82, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 82.0 in stage 3.0 (TID 85)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84) in 120 ms on localhost (executor driver) (82/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000082_0: Committed
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Starting task 83.0 in stage 3.0 (TID 86, localhost, executor driver, partition 83, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Running task 83.0 in stage 3.0 (TID 86)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85) in 74 ms on localhost (executor driver) (83/200)
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095213_0003_m_000083_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 84.0 in stage 3.0 (TID 87, localhost, executor driver, partition 84, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 84.0 in stage 3.0 (TID 87)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86) in 125 ms on localhost (executor driver) (84/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000084_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 85.0 in stage 3.0 (TID 88, localhost, executor driver, partition 85, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 85.0 in stage 3.0 (TID 88)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87) in 47 ms on localhost (executor driver) (85/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000085_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 86.0 in stage 3.0 (TID 89, localhost, executor driver, partition 86, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88) in 82 ms on localhost (executor driver) (86/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 86.0 in stage 3.0 (TID 89)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000086_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 87.0 in stage 3.0 (TID 90, localhost, executor driver, partition 87, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 87.0 in stage 3.0 (TID 90)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89) in 203 ms on localhost (executor driver) (87/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000087_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90). 3814 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 88.0 in stage 3.0 (TID 91, localhost, executor driver, partition 88, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 88.0 in stage 3.0 (TID 91)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90) in 337 ms on localhost (executor driver) (88/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000088_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 89.0 in stage 3.0 (TID 92, localhost, executor driver, partition 89, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91) in 138 ms on localhost (executor driver) (89/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 89.0 in stage 3.0 (TID 92)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000089_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 90.0 in stage 3.0 (TID 93, localhost, executor driver, partition 90, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 90.0 in stage 3.0 (TID 93)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92) in 80 ms on localhost (executor driver) (90/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000090_0: Committed
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Starting task 91.0 in stage 3.0 (TID 94, localhost, executor driver, partition 91, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93) in 53 ms on localhost (executor driver) (91/200)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Running task 91.0 in stage 3.0 (TID 94)
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095214_0003_m_000091_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 92.0 in stage 3.0 (TID 95, localhost, executor driver, partition 92, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 92.0 in stage 3.0 (TID 95)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94) in 139 ms on localhost (executor driver) (92/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000092_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 93.0 in stage 3.0 (TID 96, localhost, executor driver, partition 93, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 93.0 in stage 3.0 (TID 96)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95) in 127 ms on localhost (executor driver) (93/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000093_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 94.0 in stage 3.0 (TID 97, localhost, executor driver, partition 94, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96) in 74 ms on localhost (executor driver) (94/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 94.0 in stage 3.0 (TID 97)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000094_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 95.0 in stage 3.0 (TID 98, localhost, executor driver, partition 95, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 95.0 in stage 3.0 (TID 98)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97) in 77 ms on localhost (executor driver) (95/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000095_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 96.0 in stage 3.0 (TID 99, localhost, executor driver, partition 96, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98) in 113 ms on localhost (executor driver) (96/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 96.0 in stage 3.0 (TID 99)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000096_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 97.0 in stage 3.0 (TID 100, localhost, executor driver, partition 97, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99) in 50 ms on localhost (executor driver) (97/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 97.0 in stage 3.0 (TID 100)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000097_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 98.0 in stage 3.0 (TID 101, localhost, executor driver, partition 98, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 98.0 in stage 3.0 (TID 101)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100) in 118 ms on localhost (executor driver) (98/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000098_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 99.0 in stage 3.0 (TID 102, localhost, executor driver, partition 99, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 99.0 in stage 3.0 (TID 102)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101) in 149 ms on localhost (executor driver) (99/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000099_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 100.0 in stage 3.0 (TID 103, localhost, executor driver, partition 100, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 100.0 in stage 3.0 (TID 103)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102) in 86 ms on localhost (executor driver) (100/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000100_0: Committed
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Starting task 101.0 in stage 3.0 (TID 104, localhost, executor driver, partition 101, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Running task 101.0 in stage 3.0 (TID 104)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103) in 50 ms on localhost (executor driver) (101/200)
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095215_0003_m_000101_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 102.0 in stage 3.0 (TID 105, localhost, executor driver, partition 102, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104) in 98 ms on localhost (executor driver) (102/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 102.0 in stage 3.0 (TID 105)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 3 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000102_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 103.0 in stage 3.0 (TID 106, localhost, executor driver, partition 103, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 103.0 in stage 3.0 (TID 106)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105) in 112 ms on localhost (executor driver) (103/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000103_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 104.0 in stage 3.0 (TID 107, localhost, executor driver, partition 104, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106) in 126 ms on localhost (executor driver) (104/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 104.0 in stage 3.0 (TID 107)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000104_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 105.0 in stage 3.0 (TID 108, localhost, executor driver, partition 105, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 105.0 in stage 3.0 (TID 108)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107) in 78 ms on localhost (executor driver) (105/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000105_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 106.0 in stage 3.0 (TID 109, localhost, executor driver, partition 106, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 106.0 in stage 3.0 (TID 109)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108) in 121 ms on localhost (executor driver) (106/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000106_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 107.0 in stage 3.0 (TID 110, localhost, executor driver, partition 107, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 107.0 in stage 3.0 (TID 110)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109) in 89 ms on localhost (executor driver) (107/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000107_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 108.0 in stage 3.0 (TID 111, localhost, executor driver, partition 108, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 108.0 in stage 3.0 (TID 111)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110) in 106 ms on localhost (executor driver) (108/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000108_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 109.0 in stage 3.0 (TID 112, localhost, executor driver, partition 109, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 109.0 in stage 3.0 (TID 112)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111) in 136 ms on localhost (executor driver) (109/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000109_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 110.0 in stage 3.0 (TID 113, localhost, executor driver, partition 110, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 110.0 in stage 3.0 (TID 113)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112) in 116 ms on localhost (executor driver) (110/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000110_0: Committed
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Starting task 111.0 in stage 3.0 (TID 114, localhost, executor driver, partition 111, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Running task 111.0 in stage 3.0 (TID 114)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113) in 99 ms on localhost (executor driver) (111/200)
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095216_0003_m_000111_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 112.0 in stage 3.0 (TID 115, localhost, executor driver, partition 112, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 112.0 in stage 3.0 (TID 115)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114) in 49 ms on localhost (executor driver) (112/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000112_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 113.0 in stage 3.0 (TID 116, localhost, executor driver, partition 113, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 113.0 in stage 3.0 (TID 116)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115) in 83 ms on localhost (executor driver) (113/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000113_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 114.0 in stage 3.0 (TID 117, localhost, executor driver, partition 114, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 114.0 in stage 3.0 (TID 117)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116) in 78 ms on localhost (executor driver) (114/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000114_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 115.0 in stage 3.0 (TID 118, localhost, executor driver, partition 115, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 115.0 in stage 3.0 (TID 118)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117) in 51 ms on localhost (executor driver) (115/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000115_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 116.0 in stage 3.0 (TID 119, localhost, executor driver, partition 116, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118) in 100 ms on localhost (executor driver) (116/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 116.0 in stage 3.0 (TID 119)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000116_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119) in 96 ms on localhost (executor driver) (117/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 117.0 in stage 3.0 (TID 120, localhost, executor driver, partition 117, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 117.0 in stage 3.0 (TID 120)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000117_0: Committed
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Starting task 118.0 in stage 3.0 (TID 121, localhost, executor driver, partition 118, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Running task 118.0 in stage 3.0 (TID 121)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120) in 515 ms on localhost (executor driver) (118/200)
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095217_0003_m_000118_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 119.0 in stage 3.0 (TID 122, localhost, executor driver, partition 119, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121) in 119 ms on localhost (executor driver) (119/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 119.0 in stage 3.0 (TID 122)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000119_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 120.0 in stage 3.0 (TID 123, localhost, executor driver, partition 120, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 120.0 in stage 3.0 (TID 123)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122) in 63 ms on localhost (executor driver) (120/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000120_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 121.0 in stage 3.0 (TID 124, localhost, executor driver, partition 121, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 121.0 in stage 3.0 (TID 124)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123) in 52 ms on localhost (executor driver) (121/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000121_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 122.0 in stage 3.0 (TID 125, localhost, executor driver, partition 122, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124) in 84 ms on localhost (executor driver) (122/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 122.0 in stage 3.0 (TID 125)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000122_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 123.0 in stage 3.0 (TID 126, localhost, executor driver, partition 123, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125) in 130 ms on localhost (executor driver) (123/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 123.0 in stage 3.0 (TID 126)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000123_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 124.0 in stage 3.0 (TID 127, localhost, executor driver, partition 124, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 124.0 in stage 3.0 (TID 127)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126) in 120 ms on localhost (executor driver) (124/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000124_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 125.0 in stage 3.0 (TID 128, localhost, executor driver, partition 125, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 125.0 in stage 3.0 (TID 128)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127) in 47 ms on localhost (executor driver) (125/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000125_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 126.0 in stage 3.0 (TID 129, localhost, executor driver, partition 126, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 126.0 in stage 3.0 (TID 129)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128) in 110 ms on localhost (executor driver) (126/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000126_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 127.0 in stage 3.0 (TID 130, localhost, executor driver, partition 127, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 127.0 in stage 3.0 (TID 130)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129) in 89 ms on localhost (executor driver) (127/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000127_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 128.0 in stage 3.0 (TID 131, localhost, executor driver, partition 128, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130) in 76 ms on localhost (executor driver) (128/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 128.0 in stage 3.0 (TID 131)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000128_0: Committed
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Starting task 129.0 in stage 3.0 (TID 132, localhost, executor driver, partition 129, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Running task 129.0 in stage 3.0 (TID 132)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131) in 147 ms on localhost (executor driver) (129/200)
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095218_0003_m_000129_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 130.0 in stage 3.0 (TID 133, localhost, executor driver, partition 130, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 130.0 in stage 3.0 (TID 133)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132) in 113 ms on localhost (executor driver) (130/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000130_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 131.0 in stage 3.0 (TID 134, localhost, executor driver, partition 131, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133) in 143 ms on localhost (executor driver) (131/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 131.0 in stage 3.0 (TID 134)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000131_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 132.0 in stage 3.0 (TID 135, localhost, executor driver, partition 132, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 132.0 in stage 3.0 (TID 135)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134) in 95 ms on localhost (executor driver) (132/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000132_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 133.0 in stage 3.0 (TID 136, localhost, executor driver, partition 133, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 133.0 in stage 3.0 (TID 136)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135) in 46 ms on localhost (executor driver) (133/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000133_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 134.0 in stage 3.0 (TID 137, localhost, executor driver, partition 134, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 134.0 in stage 3.0 (TID 137)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136) in 209 ms on localhost (executor driver) (134/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000134_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 135.0 in stage 3.0 (TID 138, localhost, executor driver, partition 135, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 135.0 in stage 3.0 (TID 138)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137) in 125 ms on localhost (executor driver) (135/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000135_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 136.0 in stage 3.0 (TID 139, localhost, executor driver, partition 136, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 136.0 in stage 3.0 (TID 139)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138) in 62 ms on localhost (executor driver) (136/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000136_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 137.0 in stage 3.0 (TID 140, localhost, executor driver, partition 137, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139) in 76 ms on localhost (executor driver) (137/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 137.0 in stage 3.0 (TID 140)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000137_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 138.0 in stage 3.0 (TID 141, localhost, executor driver, partition 138, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 138.0 in stage 3.0 (TID 141)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140) in 77 ms on localhost (executor driver) (138/200)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] attempt_20180428095219_0003_m_000138_0: Committed
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Starting task 139.0 in stage 3.0 (TID 142, localhost, executor driver, partition 139, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Running task 139.0 in stage 3.0 (TID 142)
[INFO ] [2018-04-28 09:52:19] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141) in 75 ms on localhost (executor driver) (139/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000139_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 140.0 in stage 3.0 (TID 143, localhost, executor driver, partition 140, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 140.0 in stage 3.0 (TID 143)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142) in 78 ms on localhost (executor driver) (140/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000140_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 141.0 in stage 3.0 (TID 144, localhost, executor driver, partition 141, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 141.0 in stage 3.0 (TID 144)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143) in 258 ms on localhost (executor driver) (141/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000141_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 142.0 in stage 3.0 (TID 145, localhost, executor driver, partition 142, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 142.0 in stage 3.0 (TID 145)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144) in 120 ms on localhost (executor driver) (142/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000142_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 143.0 in stage 3.0 (TID 146, localhost, executor driver, partition 143, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 143.0 in stage 3.0 (TID 146)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145) in 45 ms on localhost (executor driver) (143/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000143_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 144.0 in stage 3.0 (TID 147, localhost, executor driver, partition 144, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 144.0 in stage 3.0 (TID 147)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146) in 42 ms on localhost (executor driver) (144/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000144_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 145.0 in stage 3.0 (TID 148, localhost, executor driver, partition 145, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147) in 50 ms on localhost (executor driver) (145/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 145.0 in stage 3.0 (TID 148)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000145_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 146.0 in stage 3.0 (TID 149, localhost, executor driver, partition 146, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 146.0 in stage 3.0 (TID 149)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148) in 73 ms on localhost (executor driver) (146/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000146_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 147.0 in stage 3.0 (TID 150, localhost, executor driver, partition 147, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 147.0 in stage 3.0 (TID 150)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149) in 117 ms on localhost (executor driver) (147/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000147_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 148.0 in stage 3.0 (TID 151, localhost, executor driver, partition 148, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 148.0 in stage 3.0 (TID 151)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150) in 105 ms on localhost (executor driver) (148/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000148_0: Committed
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Starting task 149.0 in stage 3.0 (TID 152, localhost, executor driver, partition 149, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Running task 149.0 in stage 3.0 (TID 152)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151) in 101 ms on localhost (executor driver) (149/200)
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095220_0003_m_000149_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 150.0 in stage 3.0 (TID 153, localhost, executor driver, partition 150, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 150.0 in stage 3.0 (TID 153)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152) in 93 ms on localhost (executor driver) (150/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000150_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 151.0 in stage 3.0 (TID 154, localhost, executor driver, partition 151, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 151.0 in stage 3.0 (TID 154)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153) in 62 ms on localhost (executor driver) (151/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000151_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 152.0 in stage 3.0 (TID 155, localhost, executor driver, partition 152, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 152.0 in stage 3.0 (TID 155)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154) in 50 ms on localhost (executor driver) (152/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000152_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 153.0 in stage 3.0 (TID 156, localhost, executor driver, partition 153, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 153.0 in stage 3.0 (TID 156)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155) in 46 ms on localhost (executor driver) (153/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000153_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 154.0 in stage 3.0 (TID 157, localhost, executor driver, partition 154, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 154.0 in stage 3.0 (TID 157)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156) in 53 ms on localhost (executor driver) (154/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000154_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 155.0 in stage 3.0 (TID 158, localhost, executor driver, partition 155, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 155.0 in stage 3.0 (TID 158)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157) in 95 ms on localhost (executor driver) (155/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000155_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 156.0 in stage 3.0 (TID 159, localhost, executor driver, partition 156, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158) in 94 ms on localhost (executor driver) (156/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 156.0 in stage 3.0 (TID 159)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000156_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 157.0 in stage 3.0 (TID 160, localhost, executor driver, partition 157, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 157.0 in stage 3.0 (TID 160)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159) in 46 ms on localhost (executor driver) (157/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000157_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 158.0 in stage 3.0 (TID 161, localhost, executor driver, partition 158, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 158.0 in stage 3.0 (TID 161)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160) in 54 ms on localhost (executor driver) (158/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000158_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 159.0 in stage 3.0 (TID 162, localhost, executor driver, partition 159, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 159.0 in stage 3.0 (TID 162)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161) in 155 ms on localhost (executor driver) (159/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000159_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 160.0 in stage 3.0 (TID 163, localhost, executor driver, partition 160, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 160.0 in stage 3.0 (TID 163)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162) in 97 ms on localhost (executor driver) (160/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000160_0: Committed
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Starting task 161.0 in stage 3.0 (TID 164, localhost, executor driver, partition 161, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Running task 161.0 in stage 3.0 (TID 164)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163) in 116 ms on localhost (executor driver) (161/200)
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095221_0003_m_000161_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 162.0 in stage 3.0 (TID 165, localhost, executor driver, partition 162, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 162.0 in stage 3.0 (TID 165)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164) in 76 ms on localhost (executor driver) (162/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000162_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 163.0 in stage 3.0 (TID 166, localhost, executor driver, partition 163, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 163.0 in stage 3.0 (TID 166)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165) in 60 ms on localhost (executor driver) (163/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000163_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 164.0 in stage 3.0 (TID 167, localhost, executor driver, partition 164, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 164.0 in stage 3.0 (TID 167)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166) in 43 ms on localhost (executor driver) (164/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000164_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 165.0 in stage 3.0 (TID 168, localhost, executor driver, partition 165, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 165.0 in stage 3.0 (TID 168)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167) in 115 ms on localhost (executor driver) (165/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000165_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 166.0 in stage 3.0 (TID 169, localhost, executor driver, partition 166, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 166.0 in stage 3.0 (TID 169)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168) in 196 ms on localhost (executor driver) (166/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 8 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000166_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 167.0 in stage 3.0 (TID 170, localhost, executor driver, partition 167, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 167.0 in stage 3.0 (TID 170)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169) in 127 ms on localhost (executor driver) (167/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000167_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 168.0 in stage 3.0 (TID 171, localhost, executor driver, partition 168, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 168.0 in stage 3.0 (TID 171)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170) in 49 ms on localhost (executor driver) (168/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000168_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 169.0 in stage 3.0 (TID 172, localhost, executor driver, partition 169, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 169.0 in stage 3.0 (TID 172)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171) in 75 ms on localhost (executor driver) (169/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000169_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 170.0 in stage 3.0 (TID 173, localhost, executor driver, partition 170, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 170.0 in stage 3.0 (TID 173)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172) in 70 ms on localhost (executor driver) (170/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000170_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 171.0 in stage 3.0 (TID 174, localhost, executor driver, partition 171, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 171.0 in stage 3.0 (TID 174)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173) in 45 ms on localhost (executor driver) (171/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000171_0: Committed
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Starting task 172.0 in stage 3.0 (TID 175, localhost, executor driver, partition 172, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Running task 172.0 in stage 3.0 (TID 175)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174) in 75 ms on localhost (executor driver) (172/200)
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095222_0003_m_000172_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 173.0 in stage 3.0 (TID 176, localhost, executor driver, partition 173, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 173.0 in stage 3.0 (TID 176)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175) in 146 ms on localhost (executor driver) (173/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000173_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 174.0 in stage 3.0 (TID 177, localhost, executor driver, partition 174, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 174.0 in stage 3.0 (TID 177)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176) in 46 ms on localhost (executor driver) (174/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000174_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 175.0 in stage 3.0 (TID 178, localhost, executor driver, partition 175, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 175.0 in stage 3.0 (TID 178)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177) in 85 ms on localhost (executor driver) (175/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000175_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 176.0 in stage 3.0 (TID 179, localhost, executor driver, partition 176, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 176.0 in stage 3.0 (TID 179)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178) in 95 ms on localhost (executor driver) (176/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000176_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 177.0 in stage 3.0 (TID 180, localhost, executor driver, partition 177, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 177.0 in stage 3.0 (TID 180)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179) in 111 ms on localhost (executor driver) (177/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000177_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 178.0 in stage 3.0 (TID 181, localhost, executor driver, partition 178, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180) in 76 ms on localhost (executor driver) (178/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 178.0 in stage 3.0 (TID 181)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000178_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 179.0 in stage 3.0 (TID 182, localhost, executor driver, partition 179, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 179.0 in stage 3.0 (TID 182)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181) in 78 ms on localhost (executor driver) (179/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000179_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 180.0 in stage 3.0 (TID 183, localhost, executor driver, partition 180, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 180.0 in stage 3.0 (TID 183)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182) in 111 ms on localhost (executor driver) (180/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000180_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 181.0 in stage 3.0 (TID 184, localhost, executor driver, partition 181, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 181.0 in stage 3.0 (TID 184)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183) in 75 ms on localhost (executor driver) (181/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000181_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 182.0 in stage 3.0 (TID 185, localhost, executor driver, partition 182, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 182.0 in stage 3.0 (TID 185)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184) in 93 ms on localhost (executor driver) (182/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000182_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 183.0 in stage 3.0 (TID 186, localhost, executor driver, partition 183, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 183.0 in stage 3.0 (TID 186)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185) in 88 ms on localhost (executor driver) (183/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000183_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 184.0 in stage 3.0 (TID 187, localhost, executor driver, partition 184, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 184.0 in stage 3.0 (TID 187)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186) in 85 ms on localhost (executor driver) (184/200)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] attempt_20180428095223_0003_m_000184_0: Committed
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Starting task 185.0 in stage 3.0 (TID 188, localhost, executor driver, partition 185, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Running task 185.0 in stage 3.0 (TID 188)
[INFO ] [2018-04-28 09:52:23] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187) in 50 ms on localhost (executor driver) (185/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000185_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 186.0 in stage 3.0 (TID 189, localhost, executor driver, partition 186, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188) in 122 ms on localhost (executor driver) (186/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 186.0 in stage 3.0 (TID 189)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000186_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 187.0 in stage 3.0 (TID 190, localhost, executor driver, partition 187, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 187.0 in stage 3.0 (TID 190)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189) in 74 ms on localhost (executor driver) (187/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000187_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 188.0 in stage 3.0 (TID 191, localhost, executor driver, partition 188, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 188.0 in stage 3.0 (TID 191)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190) in 49 ms on localhost (executor driver) (188/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000188_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 189.0 in stage 3.0 (TID 192, localhost, executor driver, partition 189, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 189.0 in stage 3.0 (TID 192)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191) in 264 ms on localhost (executor driver) (189/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000189_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 190.0 in stage 3.0 (TID 193, localhost, executor driver, partition 190, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 190.0 in stage 3.0 (TID 193)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192) in 58 ms on localhost (executor driver) (190/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000190_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 191.0 in stage 3.0 (TID 194, localhost, executor driver, partition 191, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 191.0 in stage 3.0 (TID 194)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193) in 233 ms on localhost (executor driver) (191/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000191_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 192.0 in stage 3.0 (TID 195, localhost, executor driver, partition 192, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194) in 56 ms on localhost (executor driver) (192/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 192.0 in stage 3.0 (TID 195)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000192_0: Committed
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Starting task 193.0 in stage 3.0 (TID 196, localhost, executor driver, partition 193, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Running task 193.0 in stage 3.0 (TID 196)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195) in 113 ms on localhost (executor driver) (193/200)
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:24] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095224_0003_m_000193_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 194.0 in stage 3.0 (TID 197, localhost, executor driver, partition 194, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 194.0 in stage 3.0 (TID 197)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196) in 84 ms on localhost (executor driver) (194/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000194_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197). 3642 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 195.0 in stage 3.0 (TID 198, localhost, executor driver, partition 195, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 195.0 in stage 3.0 (TID 198)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197) in 101 ms on localhost (executor driver) (195/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000195_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 196.0 in stage 3.0 (TID 199, localhost, executor driver, partition 196, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 196.0 in stage 3.0 (TID 199)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198) in 128 ms on localhost (executor driver) (196/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000196_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199). 3728 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 197.0 in stage 3.0 (TID 200, localhost, executor driver, partition 197, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 197.0 in stage 3.0 (TID 200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199) in 106 ms on localhost (executor driver) (197/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000197_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 198.0 in stage 3.0 (TID 201, localhost, executor driver, partition 198, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200) in 50 ms on localhost (executor driver) (198/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 198.0 in stage 3.0 (TID 201)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000198_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Starting task 199.0 in stage 3.0 (TID 202, localhost, executor driver, partition 199, ANY, 5054 bytes)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Running task 199.0 in stage 3.0 (TID 202)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201) in 45 ms on localhost (executor driver) (199/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] attempt_20180428095225_0003_m_000199_0: Committed
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202). 3685 bytes result sent to driver
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202) in 43 ms on localhost (executor driver) (200/200)
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Removed TaskSet 3.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] ResultStage 3 (saveAsTable at HistoryDataToA.scala:96) finished in 22.684 s
[INFO ] [2018-04-28 09:52:25] [Logging$class:logInfo:54] Job 1 finished: saveAsTable at HistoryDataToA.scala:96, took 27.297678 s
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Starting job: collect at posProductProcessor.scala:222
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Got job 2 (collect at posProductProcessor.scala:222) with 15 output partitions
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Final stage: ResultStage 4 (collect at posProductProcessor.scala:222)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Submitting ResultStage 4 (MapPartitionsRDD[41] at map at posProductProcessor.scala:217), which has no missing parents
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Block broadcast_9 stored as values in memory (estimated size 4.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Block broadcast_9_piece0 stored as bytes in memory (estimated size 2.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Added broadcast_9_piece0 in memory on 192.168.0.152:57343 (size: 2.2 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Created broadcast 9 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 4 (MapPartitionsRDD[41] at map at posProductProcessor.scala:217) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Adding task set 4.0 with 15 tasks
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Starting task 0.0 in stage 4.0 (TID 203, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Running task 0.0 in stage 4.0 (TID 203)
[INFO ] [2018-04-28 09:52:31] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 09:52:32] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203). 212165 bytes result sent to driver
[INFO ] [2018-04-28 09:52:32] [Logging$class:logInfo:54] Starting task 1.0 in stage 4.0 (TID 204, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:52:32] [Logging$class:logInfo:54] Running task 1.0 in stage 4.0 (TID 204)
[INFO ] [2018-04-28 09:52:32] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203) in 190 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 09:52:32] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Block taskresult_204 stored as bytes in memory (estimated size 9.0 MB, free 1917.1 MB)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Added taskresult_204 in memory on 192.168.0.152:57343 (size: 9.0 MB, free: 1982.5 MB)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204). 9456718 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Starting task 2.0 in stage 4.0 (TID 205, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Running task 2.0 in stage 4.0 (TID 205)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20180101—20180424.txt:0+3542719
[INFO ] [2018-04-28 09:52:34] [TransportClientFactory:createClient:254] Successfully created connection to /192.168.0.152:57343 after 35 ms (0 ms spent in bootstraps)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204) in 2761 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Removed taskresult_204 on 192.168.0.152:57343 in memory (size: 9.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Block taskresult_205 stored as bytes in memory (estimated size 1275.7 KB, free 1924.8 MB)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Added taskresult_205 in memory on 192.168.0.152:57343 (size: 1275.7 KB, free: 1990.3 MB)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205). 1306308 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Starting task 3.0 in stage 4.0 (TID 206, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Running task 3.0 in stage 4.0 (TID 206)
[INFO ] [2018-04-28 09:52:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 09:52:35] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205) in 561 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 09:52:35] [Logging$class:logInfo:54] Removed taskresult_205 on 192.168.0.152:57343 in memory (size: 1275.7 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Block taskresult_206 stored as bytes in memory (estimated size 7.3 MB, free 1918.8 MB)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Added taskresult_206 in memory on 192.168.0.152:57343 (size: 7.3 MB, free: 1984.3 MB)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206). 7639217 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Starting task 4.0 in stage 4.0 (TID 207, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Running task 4.0 in stage 4.0 (TID 207)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Starting task 5.0 in stage 4.0 (TID 208, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207) in 120 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Running task 5.0 in stage 4.0 (TID 208)
[INFO ] [2018-04-28 09:52:36] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品档案表.txt:0+5619732
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206) in 2028 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Removed taskresult_206 on 192.168.0.152:57343 in memory (size: 7.3 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Starting task 6.0 in stage 4.0 (TID 209, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Running task 6.0 in stage 4.0 (TID 209)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208) in 167 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209). 673 bytes result sent to driver
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Starting task 7.0 in stage 4.0 (TID 210, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Running task 7.0 in stage 4.0 (TID 210)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209) in 4 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Starting task 8.0 in stage 4.0 (TID 211, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Running task 8.0 in stage 4.0 (TID 211)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210) in 149 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 09:52:37] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Block taskresult_211 stored as bytes in memory (estimated size 3.5 MB, free 1922.6 MB)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Added taskresult_211 in memory on 192.168.0.152:57343 (size: 3.5 MB, free: 1988.1 MB)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211). 3623649 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Starting task 9.0 in stage 4.0 (TID 212, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Running task 9.0 in stage 4.0 (TID 212)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211) in 929 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 09:52:38] [Logging$class:logInfo:54] Removed taskresult_211 on 192.168.0.152:57343 in memory (size: 3.5 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Block taskresult_212 stored as bytes in memory (estimated size 10.0 MB, free 1916.1 MB)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Added taskresult_212 in memory on 192.168.0.152:57343 (size: 10.0 MB, free: 1981.5 MB)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212). 10512126 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Starting task 10.0 in stage 4.0 (TID 213, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Running task 10.0 in stage 4.0 (TID 213)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212) in 2587 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 09:52:40] [Logging$class:logInfo:54] Removed taskresult_212 on 192.168.0.152:57343 in memory (size: 10.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Block taskresult_213 stored as bytes in memory (estimated size 12.6 MB, free 1913.5 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Added taskresult_213 in memory on 192.168.0.152:57343 (size: 12.6 MB, free: 1978.9 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213). 13243179 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Starting task 11.0 in stage 4.0 (TID 214, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Running task 11.0 in stage 4.0 (TID 214)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20180101—20180424.txt:0+1007100
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214). 426756 bytes result sent to driver
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Starting task 12.0 in stage 4.0 (TID 215, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Running task 12.0 in stage 4.0 (TID 215)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合优惠商品明细表.txt:0+5532218
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214) in 157 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213) in 3309 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Removed taskresult_213 on 192.168.0.152:57343 in memory (size: 12.6 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Block taskresult_215 stored as bytes in memory (estimated size 1747.6 KB, free 1924.4 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Added taskresult_215 in memory on 192.168.0.152:57343 (size: 1747.6 KB, free: 1989.8 MB)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215). 1789493 bytes result sent via BlockManager)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Starting task 13.0 in stage 4.0 (TID 216, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Running task 13.0 in stage 4.0 (TID 216)
[INFO ] [2018-04-28 09:52:43] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合商品.txt:0+6682758
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215) in 598 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Removed taskresult_215 on 192.168.0.152:57343 in memory (size: 1747.6 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216). 845 bytes result sent to driver
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Starting task 14.0 in stage 4.0 (TID 217, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Running task 14.0 in stage 4.0 (TID 217)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216) in 186 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217). 759 bytes result sent to driver
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217) in 57 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Removed TaskSet 4.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] ResultStage 4 (collect at posProductProcessor.scala:222) finished in 12.148 s
[INFO ] [2018-04-28 09:52:44] [Logging$class:logInfo:54] Job 2 finished: collect at posProductProcessor.scala:222, took 12.154656 s
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: ba_model.banner_promotion
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:52:47] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA.scala:108
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Got job 3 (saveAsTable at HistoryDataToA.scala:108) with 15 output partitions
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Final stage: ResultStage 5 (saveAsTable at HistoryDataToA.scala:108)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Submitting ResultStage 5 (MapPartitionsRDD[44] at saveAsTable at HistoryDataToA.scala:108), which has no missing parents
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Block broadcast_10 stored as values in memory (estimated size 81.5 KB, free 1926.0 MB)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Block broadcast_10_piece0 stored as bytes in memory (estimated size 31.0 KB, free 1926.0 MB)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Added broadcast_10_piece0 in memory on 192.168.0.152:57343 (size: 31.0 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Created broadcast 10 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 5 (MapPartitionsRDD[44] at saveAsTable at HistoryDataToA.scala:108) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Adding task set 5.0 with 15 tasks
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Starting task 0.0 in stage 5.0 (TID 218, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Running task 0.0 in stage 5.0 (TID 218)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 12.088271 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 7.070214 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 12.670124 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 34.868895 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 13.158714 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 20.918392 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Code generated in 8.130462 ms
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] attempt_20180428095248_0005_m_000000_0: Committed
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218). 1792 bytes result sent to driver
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Starting task 1.0 in stage 5.0 (TID 219, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218) in 274 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Running task 1.0 in stage 5.0 (TID 219)
[INFO ] [2018-04-28 09:52:48] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] attempt_20180428095250_0005_m_000001_0: Committed
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219). 1878 bytes result sent to driver
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Starting task 2.0 in stage 5.0 (TID 220, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219) in 2242 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Running task 2.0 in stage 5.0 (TID 220)
[INFO ] [2018-04-28 09:52:50] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表20180101—20180424.txt:0+3542719
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] attempt_20180428095251_0005_m_000002_0: Committed
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220). 1792 bytes result sent to driver
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Starting task 3.0 in stage 5.0 (TID 221, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Running task 3.0 in stage 5.0 (TID 221)
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220) in 352 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 09:52:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] attempt_20180428095252_0005_m_000003_0: Committed
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221). 1921 bytes result sent to driver
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Starting task 4.0 in stage 5.0 (TID 222, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Running task 4.0 in stage 5.0 (TID 222)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221) in 1612 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095252_0005_m_000004_0
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222). 1796 bytes result sent to driver
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Starting task 5.0 in stage 5.0 (TID 223, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Running task 5.0 in stage 5.0 (TID 223)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222) in 96 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/商品档案表.txt:0+5619732
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095252_0005_m_000005_0
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Starting task 6.0 in stage 5.0 (TID 224, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Running task 6.0 in stage 5.0 (TID 224)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223) in 119 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095252_0005_m_000006_0
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224). 1710 bytes result sent to driver
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Starting task 7.0 in stage 5.0 (TID 225, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Running task 7.0 in stage 5.0 (TID 225)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224) in 13 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 09:52:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/实物流水2018.04.24.txt:0+8238018
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095253_0005_m_000007_0
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Starting task 8.0 in stage 5.0 (TID 226, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Running task 8.0 in stage 5.0 (TID 226)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225) in 162 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] attempt_20180428095253_0005_m_000008_0: Committed
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Starting task 9.0 in stage 5.0 (TID 227, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Running task 9.0 in stage 5.0 (TID 227)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226) in 779 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 09:52:53] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 09:52:55] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] attempt_20180428095255_0005_m_000009_0: Committed
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] Starting task 10.0 in stage 5.0 (TID 228, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] Running task 10.0 in stage 5.0 (TID 228)
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227) in 2399 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 09:52:56] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] attempt_20180428095258_0005_m_000010_0: Committed
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Starting task 11.0 in stage 5.0 (TID 229, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Running task 11.0 in stage 5.0 (TID 229)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228) in 2488 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/等级优惠商品明细表20180101—20180424.txt:0+1007100
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] attempt_20180428095258_0005_m_000011_0: Committed
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229). 1792 bytes result sent to driver
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Starting task 12.0 in stage 5.0 (TID 230, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Running task 12.0 in stage 5.0 (TID 230)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229) in 162 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 09:52:58] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合优惠商品明细表.txt:0+5532218
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] attempt_20180428095259_0005_m_000012_0: Committed
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230). 1835 bytes result sent to driver
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Starting task 13.0 in stage 5.0 (TID 231, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Running task 13.0 in stage 5.0 (TID 231)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230) in 406 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/组合商品.txt:0+6682758
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095259_0005_m_000013_0
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231). 1753 bytes result sent to driver
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Starting task 14.0 in stage 5.0 (TID 232, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Running task 14.0 in stage 5.0 (TID 232)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231) in 114 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180424/金额流水2018.04.24.txt:0+2890924
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428095259_0005_m_000014_0
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232). 1796 bytes result sent to driver
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232) in 61 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Removed TaskSet 5.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] ResultStage 5 (saveAsTable at HistoryDataToA.scala:108) finished in 11.271 s
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Job 3 finished: saveAsTable at HistoryDataToA.scala:108, took 11.287565 s
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Persisting file based data source table `ba_model`.`banner_promotion` into Hive metastore in Hive compatible format.
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Recover all the partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Found 1 partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 09:52:59] [Logging$class:logInfo:54] Finished to gather the fast stats for all 1 partitions.
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Recovered all partitions (1).
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 09:53:00] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-c010a668-5d42-4df3-b9b6-430d655e4373
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 61134.
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 12:08:52] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-60c80494-6d33-4e60-9745-9d099c95c051
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 61143.
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Server created on 192.168.0.152:61143
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 61143, None)
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:61143 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 61143, None)
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 61143, None)
[INFO ] [2018-04-28 12:08:53] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 61143, None)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 215.1 KB, free 1991.8 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:61143 (size: 20.5 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 215.1 KB, free 1991.6 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.5 KB, free 1991.5 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:61143 (size: 20.5 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 215.1 KB, free 1991.3 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.5 KB, free 1991.3 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:61143 (size: 20.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 12:08:54] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:08:56] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 12:08:56] [Logging$class:logInfo:54] spark.sql.warehouse.dir is not set, but hive.metastore.warehouse.dir is set. Setting spark.sql.warehouse.dir to the value of hive.metastore.warehouse.dir ('/user/hive/warehouse').
[INFO ] [2018-04-28 12:08:56] [Logging$class:logInfo:54] Warehouse path is '/user/hive/warehouse'.
[INFO ] [2018-04-28 12:08:56] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[ERROR] [2018-04-28 12:09:00] [Log4JLogger:error:125] Failed initialising database.
Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

org.datanucleus.exceptions.NucleusDataStoreException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:516)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	... 92 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 94 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
Nested Throwables StackTrace:
java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 94 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
[ERROR] [2018-04-28 12:09:00] [Log4JLogger:error:125] Failed initialising database.
Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

org.datanucleus.exceptions.NucleusDataStoreException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:516)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	... 92 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 94 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
Nested Throwables StackTrace:
java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.metadata.Hive.getAllDatabases(Hive.java:1234)
	at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:174)
	at org.apache.hadoop.hive.ql.metadata.Hive.<clinit>(Hive.java:166)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 94 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 110 more
[ERROR] [2018-04-28 12:09:00] [Log4JLogger:error:125] Failed initialising database.
Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

org.datanucleus.exceptions.NucleusDataStoreException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:516)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	... 89 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 91 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
Nested Throwables StackTrace:
java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:620)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 91 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
[ERROR] [2018-04-28 12:09:00] [Log4JLogger:error:125] Failed initialising database.
Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

org.datanucleus.exceptions.NucleusDataStoreException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:516)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	... 89 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 91 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
Nested Throwables StackTrace:
java.sql.SQLException: Unable to open a test connection to the given database. JDBC url = jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
------

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.jolbox.bonecp.PoolUtil.generateSQLException(PoolUtil.java:192)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:422)
	at com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)
	at org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:501)
	at org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:298)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:631)
	at org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)
	at org.datanucleus.NucleusContext.createStoreManagerForProperties(NucleusContext.java:1187)
	at org.datanucleus.NucleusContext.initialise(NucleusContext.java:356)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:775)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:333)
	at org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:202)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1965)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1960)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1166)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:808)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:701)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:365)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:394)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:291)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:258)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:73)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:57)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:66)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStore(HiveMetaStore.java:593)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:571)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:66)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:72)
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:5762)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:199)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:74)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1521)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:86)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)
	at org.apache.spark.sql.hive.client.HiveClientImpl.<init>(HiveClientImpl.scala:191)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.spark.sql.hive.client.IsolatedClientLoader.createClient(IsolatedClientLoader.scala:264)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:362)
	at org.apache.spark.sql.hive.HiveUtils$.newClientForMetadata(HiveUtils.scala:266)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client$lzycompute(HiveExternalCatalog.scala:66)
	at org.apache.spark.sql.hive.HiveExternalCatalog.client(HiveExternalCatalog.scala:65)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply$mcZ$sp(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$databaseExists$1.apply(HiveExternalCatalog.scala:195)
	at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)
	at org.apache.spark.sql.hive.HiveExternalCatalog.databaseExists(HiveExternalCatalog.scala:194)
	at org.apache.spark.sql.internal.SharedState.externalCatalog$lzycompute(SharedState.scala:105)
	at org.apache.spark.sql.internal.SharedState.externalCatalog(SharedState.scala:93)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.externalCatalog(HiveSessionStateBuilder.scala:39)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog$lzycompute(HiveSessionStateBuilder.scala:54)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:52)
	at org.apache.spark.sql.hive.HiveSessionStateBuilder.catalog(HiveSessionStateBuilder.scala:35)
	at org.apache.spark.sql.internal.BaseSessionStateBuilder.build(BaseSessionStateBuilder.scala:289)
	at org.apache.spark.sql.SparkSession$.org$apache$spark$sql$SparkSession$$instantiateSessionState(SparkSession.scala:1059)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:137)
	at org.apache.spark.sql.SparkSession$$anonfun$sessionState$2.apply(SparkSession.scala:136)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession.sessionState$lzycompute(SparkSession.scala:136)
	at org.apache.spark.sql.SparkSession.sessionState(SparkSession.scala:133)
	at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:66)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:587)
	at org.apache.spark.sql.SparkSession.createDataFrame(SparkSession.scala:344)
	at com.dr.banner.posProductProcessor$.etlProductPosOperation(posProductProcessor.scala:65)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:66)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1137)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
	at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2490)
	at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2527)
	at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2309)
	at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
	at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:46)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:408)
	at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:419)
	at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:344)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)
	at com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)
	... 91 more
Caused by: java.net.UnknownHostException: master
	at java.net.InetAddress.getAllByName0(InetAddress.java:1280)
	at java.net.InetAddress.getAllByName(InetAddress.java:1192)
	at java.net.InetAddress.getAllByName(InetAddress.java:1126)
	at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:250)
	at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
	... 107 more
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] Invoking stop() from shutdown hook
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 12:09:00] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-341b98c8-476d-4833-8323-5751e9082919
[INFO ] [2018-04-28 12:11:43] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 12:11:43] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 61199.
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-a38ef924-827a-46ac-b016-5f4a2fc0d0eb
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 61208.
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Server created on 192.168.0.152:61208
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 61208, None)
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:61208 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 61208, None)
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 61208, None)
[INFO ] [2018-04-28 12:11:44] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 61208, None)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:61208 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:61208 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:61208 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 12:11:45] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 12:11:47] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 12:11:47] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 12:11:47] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 12:11:47] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 12:11:51] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 12:11:51] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 12:11:51] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:52] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:53] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:57] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Code generated in 222.847833 ms
[INFO ] [2018-04-28 12:11:58] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 224.7 KB, free 1991.1 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.1 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:61208 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Created broadcast 3 from 
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 12.3 KB, free 1991.1 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.1 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:61208 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Created broadcast 4 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Code generated in 12.301604 ms
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218615 bytes result sent to driver
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 407 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.424 s
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.493956 s
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Code generated in 8.219194 ms
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 64.5 MB, free 1926.6 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:61208 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Created broadcast 5 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Code generated in 32.073659 ms
[INFO ] [2018-04-28 12:11:59] [Logging$class:logInfo:54] Code generated in 14.132119 ms
[ERROR] [2018-04-28 12:12:02] [Logging$class:logError:91] Aborting job null.
org.apache.spark.sql.catalyst.errors.package$TreeNodeException: execute, tree:
Exchange hashpartitioning(flow_no#12, 200)
+- Scan ExistingRDD[flow_no#12,banner_code#13,retailer_shop_code#14,good_code#15,trade_date_time#16,trade_date_timestamp#17L,card_code#18,quantity#19,price#20,amount#21,day#22,banner#23]

	at org.apache.spark.sql.catalyst.errors.package$.attachTree(package.scala:56)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange.doExecute(ShuffleExchange.scala:115)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.InputAdapter.inputRDDs(WholeStageCodegenExec.scala:252)
	at org.apache.spark.sql.execution.SortExec.inputRDDs(SortExec.scala:121)
	at org.apache.spark.sql.execution.WholeStageCodegenExec.doExecute(WholeStageCodegenExec.scala:386)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec.doExecute(SortMergeJoinExec.scala:141)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.InputAdapter.inputRDDs(WholeStageCodegenExec.scala:252)
	at org.apache.spark.sql.execution.ProjectExec.inputRDDs(basicPhysicalOperators.scala:42)
	at org.apache.spark.sql.execution.joins.BroadcastHashJoinExec.inputRDDs(BroadcastHashJoinExec.scala:73)
	at org.apache.spark.sql.execution.ProjectExec.inputRDDs(basicPhysicalOperators.scala:42)
	at org.apache.spark.sql.execution.WholeStageCodegenExec.doExecute(WholeStageCodegenExec.scala:386)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.SortExec.doExecute(SortExec.scala:101)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply$mcV$sp(FileFormatWriter.scala:183)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:65)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:145)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:74)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.datasources.DataSource.writeInFileFormat(DataSource.scala:435)
	at org.apache.spark.sql.execution.datasources.DataSource.writeAndRead(DataSource.scala:451)
	at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.saveDataIntoTable(createDataSourceTables.scala:217)
	at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.run(createDataSourceTables.scala:167)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:74)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:92)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:609)
	at org.apache.spark.sql.DataFrameWriter.createTable(DataFrameWriter.scala:419)
	at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:398)
	at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:354)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:97)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.lang.IllegalArgumentException: java.net.UnknownHostException: malogic
	at org.apache.hadoop.security.SecurityUtil.buildTokenService(SecurityUtil.java:374)
	at org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:310)
	at org.apache.hadoop.hdfs.NameNodeProxies.createProxy(NameNodeProxies.java:176)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:668)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:604)
	at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:148)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2598)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:91)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2632)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2614)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:370)
	at org.apache.hadoop.fs.Path.getFileSystem(Path.java:296)
	at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:256)
	at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:228)
	at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:313)
	at org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:199)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.HadoopRDD$HadoopMapPartitionsWithSplitRDD.getPartitions(HadoopRDD.scala:396)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.ShuffleDependency.<init>(Dependency.scala:91)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$.prepareShuffleDependency(ShuffleExchange.scala:264)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange.prepareShuffleDependency(ShuffleExchange.scala:87)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$$anonfun$doExecute$1.apply(ShuffleExchange.scala:124)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$$anonfun$doExecute$1.apply(ShuffleExchange.scala:115)
	at org.apache.spark.sql.catalyst.errors.package$.attachTree(package.scala:52)
	... 84 more
Caused by: java.net.UnknownHostException: malogic
	... 160 more
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] Invoking stop() from shutdown hook
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 12:12:02] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-95f37198-ca31-4bb0-98ed-6e549881d3da
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 13:38:42] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 61938.
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-b272109a-a2f5-489c-bab2-d37a877bf484
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 61947.
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Server created on 192.168.0.152:61947
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 61947, None)
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:61947 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 61947, None)
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 61947, None)
[INFO ] [2018-04-28 13:38:43] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 61947, None)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:61947 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:61947 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:61947 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:38:44] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:38:46] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 13:38:46] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 13:38:46] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 13:38:46] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 13:38:50] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 13:38:51] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:52] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:38:57] [Logging$class:logInfo:54] Code generated in 233.56284 ms
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 224.7 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:61947 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Created broadcast 3 from 
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 12.3 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:61947 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Created broadcast 4 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[23] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Code generated in 12.036165 ms
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218658 bytes result sent to driver
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 415 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.431 s
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.503303 s
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Code generated in 7.713234 ms
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 64.5 MB, free 1926.6 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:61947 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Created broadcast 5 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 13:38:58] [Logging$class:logInfo:54] Code generated in 37.278242 ms
[INFO ] [2018-04-28 13:38:59] [Logging$class:logInfo:54] Code generated in 14.829512 ms
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Removed broadcast_4_piece0 on 192.168.0.152:61947 in memory (size: 6.1 KB, free: 1991.6 MB)
[ERROR] [2018-04-28 13:39:01] [Logging$class:logError:91] Aborting job null.
org.apache.spark.sql.catalyst.errors.package$TreeNodeException: execute, tree:
Exchange hashpartitioning(flow_no#12, 200)
+- Scan ExistingRDD[flow_no#12,banner_code#13,retailer_shop_code#14,good_code#15,trade_date_time#16,trade_date_timestamp#17L,card_code#18,quantity#19,price#20,amount#21,day#22,banner#23]

	at org.apache.spark.sql.catalyst.errors.package$.attachTree(package.scala:56)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange.doExecute(ShuffleExchange.scala:115)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.InputAdapter.inputRDDs(WholeStageCodegenExec.scala:252)
	at org.apache.spark.sql.execution.SortExec.inputRDDs(SortExec.scala:121)
	at org.apache.spark.sql.execution.WholeStageCodegenExec.doExecute(WholeStageCodegenExec.scala:386)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec.doExecute(SortMergeJoinExec.scala:141)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.InputAdapter.inputRDDs(WholeStageCodegenExec.scala:252)
	at org.apache.spark.sql.execution.ProjectExec.inputRDDs(basicPhysicalOperators.scala:42)
	at org.apache.spark.sql.execution.joins.BroadcastHashJoinExec.inputRDDs(BroadcastHashJoinExec.scala:73)
	at org.apache.spark.sql.execution.ProjectExec.inputRDDs(basicPhysicalOperators.scala:42)
	at org.apache.spark.sql.execution.WholeStageCodegenExec.doExecute(WholeStageCodegenExec.scala:386)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.SortExec.doExecute(SortExec.scala:101)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply$mcV$sp(FileFormatWriter.scala:183)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$$anonfun$write$1.apply(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:65)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:166)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:145)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:74)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.datasources.DataSource.writeInFileFormat(DataSource.scala:435)
	at org.apache.spark.sql.execution.datasources.DataSource.writeAndRead(DataSource.scala:451)
	at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.saveDataIntoTable(createDataSourceTables.scala:217)
	at org.apache.spark.sql.execution.command.CreateDataSourceTableAsSelectCommand.run(createDataSourceTables.scala:167)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:74)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)
	at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)
	at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:92)
	at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:92)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:609)
	at org.apache.spark.sql.DataFrameWriter.createTable(DataFrameWriter.scala:419)
	at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:398)
	at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:354)
	at com.dr.work.HistoryDataToA$.main(HistoryDataToA.scala:97)
	at com.dr.work.HistoryDataToA.main(HistoryDataToA.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
Caused by: java.lang.IllegalArgumentException: java.net.UnknownHostException: malogic
	at org.apache.hadoop.security.SecurityUtil.buildTokenService(SecurityUtil.java:374)
	at org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:310)
	at org.apache.hadoop.hdfs.NameNodeProxies.createProxy(NameNodeProxies.java:176)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:668)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:604)
	at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:148)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2598)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:91)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2632)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2614)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:370)
	at org.apache.hadoop.fs.Path.getFileSystem(Path.java:296)
	at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:256)
	at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:228)
	at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:313)
	at org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:199)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.HadoopRDD$HadoopMapPartitionsWithSplitRDD.getPartitions(HadoopRDD.scala:396)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:252)
	at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:250)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:250)
	at org.apache.spark.ShuffleDependency.<init>(Dependency.scala:91)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$.prepareShuffleDependency(ShuffleExchange.scala:264)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange.prepareShuffleDependency(ShuffleExchange.scala:87)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$$anonfun$doExecute$1.apply(ShuffleExchange.scala:124)
	at org.apache.spark.sql.execution.exchange.ShuffleExchange$$anonfun$doExecute$1.apply(ShuffleExchange.scala:115)
	at org.apache.spark.sql.catalyst.errors.package$.attachTree(package.scala:52)
	... 84 more
Caused by: java.net.UnknownHostException: malogic
	... 160 more
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Invoking stop() from shutdown hook
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 13:39:01] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-43387c76-0357-4b16-aaa6-95a15b0cde71
[ERROR] [2018-04-28 13:40:24] [HistoryDataToA_DateRange$:main:28] 请输入“开始日期  结束日期 格式为：yyyyMMdd
[INFO ] [2018-04-28 13:42:13] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 13:42:14] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 62011.
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-ddbc4062-80bd-49e8-9f93-3abc6df7ce45
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 62020.
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Server created on 192.168.0.152:62020
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 62020, None)
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:62020 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 62020, None)
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 62020, None)
[INFO ] [2018-04-28 13:42:15] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 62020, None)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 214.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 3 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 214.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 4 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 214.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 5 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_6 stored as values in memory (estimated size 214.6 KB, free 1990.4 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_6_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.4 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_6_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 6 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_7 stored as values in memory (estimated size 214.6 KB, free 1990.2 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_7_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.2 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_7_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.8 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 7 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_8 stored as values in memory (estimated size 214.6 KB, free 1990.0 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Block broadcast_8_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1989.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Added broadcast_8_piece0 in memory on 192.168.0.152:62020 (size: 20.6 KB, free: 1991.8 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Created broadcast 8 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_1_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.8 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_2_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_4_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_5_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_0_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:16] [Logging$class:logInfo:54] Removed broadcast_3_piece0 on 192.168.0.152:62020 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:18] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 13:42:18] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 13:42:18] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 13:42:18] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 13:42:22] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 13:42:23] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:24] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:29] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Code generated in 204.235331 ms
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Block broadcast_9 stored as values in memory (estimated size 224.7 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Block broadcast_9_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Added broadcast_9_piece0 in memory on 192.168.0.152:62020 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Created broadcast 9 from 
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[35] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Block broadcast_10 stored as values in memory (estimated size 12.3 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.1 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Added broadcast_10_piece0 in memory on 192.168.0.152:62020 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Created broadcast 10 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[35] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Code generated in 12.682962 ms
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218615 bytes result sent to driver
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 415 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.431 s
[INFO ] [2018-04-28 13:42:30] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.503230 s
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 8.470285 ms
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_11 stored as values in memory (estimated size 64.5 MB, free 1926.6 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_11_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Added broadcast_11_piece0 in memory on 192.168.0.152:62020 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Created broadcast 11 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 45.486485 ms
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 12.671257 ms
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA_DateRange.scala:121
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Registering RDD 37 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Registering RDD 41 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Got job 1 (saveAsTable at HistoryDataToA_DateRange.scala:121) with 200 output partitions
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Final stage: ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Parents of final stage: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Missing parents: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Submitting ShuffleMapStage 1 (MapPartitionsRDD[37] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_12 stored as values in memory (estimated size 16.8 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_12_piece0 stored as bytes in memory (estimated size 7.3 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Added broadcast_12_piece0 in memory on 192.168.0.152:62020 (size: 7.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Created broadcast 12 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[37] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Adding task set 1.0 with 1 tasks
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Submitting ShuffleMapStage 2 (MapPartitionsRDD[41] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Running task 0.0 in stage 1.0 (TID 1)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_13 stored as values in memory (estimated size 12.3 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Block broadcast_13_piece0 stored as bytes in memory (estimated size 6.4 KB, free 1926.2 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Added broadcast_13_piece0 in memory on 192.168.0.152:62020 (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Created broadcast 13 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[41] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Adding task set 2.0 with 1 tasks
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/实物流水2018.04.25.txt:0+8982999
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 18.603062 ms
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 13.123222 ms
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Removed broadcast_10_piece0 on 192.168.0.152:62020 in memory (size: 6.1 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:42:31] [Logging$class:logInfo:54] Code generated in 99.717381 ms
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1). 1625 bytes result sent to driver
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Running task 0.0 in stage 2.0 (TID 2)
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1) in 3786 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Removed TaskSet 1.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/金额流水2018.04.25.txt:0+3194310
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] ShuffleMapStage 1 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 3.791 s
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] running: Set(ShuffleMapStage 2)
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Code generated in 8.823701 ms
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Code generated in 35.730535 ms
[INFO ] [2018-04-28 13:42:35] [Logging$class:logInfo:54] Removed broadcast_12_piece0 on 192.168.0.152:62020 in memory (size: 7.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2). 1539 bytes result sent to driver
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2) in 1084 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Removed TaskSet 2.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] ShuffleMapStage 2 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 4.852 s
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] running: Set()
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Submitting ResultStage 3 (MapPartitionsRDD[46] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Block broadcast_14 stored as values in memory (estimated size 114.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Block broadcast_14_piece0 stored as bytes in memory (estimated size 43.3 KB, free 1926.1 MB)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Added broadcast_14_piece0 in memory on 192.168.0.152:62020 (size: 43.3 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Created broadcast 14 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Submitting 200 missing tasks from ResultStage 3 (MapPartitionsRDD[46] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Adding task set 3.0 with 200 tasks
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Starting task 0.0 in stage 3.0 (TID 3, localhost, executor driver, partition 0, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Running task 0.0 in stage 3.0 (TID 3)
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Started 0 remote fetches in 6 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 14.322799 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 25.270773 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 31.969824 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 10.984978 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 8.351347 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Code generated in 9.627195 ms
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:36] [Logging$class:logInfo:54] Removed broadcast_13_piece0 on 192.168.0.152:62020 in memory (size: 6.4 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Code generated in 8.153872 ms
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Code generated in 15.176888 ms
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Code generated in 9.426699 ms
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] attempt_20180428134236_0003_m_000000_0: Committed
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3). 3814 bytes result sent to driver
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Starting task 1.0 in stage 3.0 (TID 4, localhost, executor driver, partition 1, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Running task 1.0 in stage 3.0 (TID 4)
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3) in 1477 ms on localhost (executor driver) (1/200)
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:37] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134237_0003_m_000001_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 2.0 in stage 3.0 (TID 5, localhost, executor driver, partition 2, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4) in 152 ms on localhost (executor driver) (2/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 2.0 in stage 3.0 (TID 5)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000002_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 3.0 in stage 3.0 (TID 6, localhost, executor driver, partition 3, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 3.0 in stage 3.0 (TID 6)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5) in 159 ms on localhost (executor driver) (3/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000003_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 4.0 in stage 3.0 (TID 7, localhost, executor driver, partition 4, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 4.0 in stage 3.0 (TID 7)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6) in 155 ms on localhost (executor driver) (4/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000004_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 5.0 in stage 3.0 (TID 8, localhost, executor driver, partition 5, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 5.0 in stage 3.0 (TID 8)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7) in 162 ms on localhost (executor driver) (5/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000005_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 6.0 in stage 3.0 (TID 9, localhost, executor driver, partition 6, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 6.0 in stage 3.0 (TID 9)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8) in 192 ms on localhost (executor driver) (6/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000006_0: Committed
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Starting task 7.0 in stage 3.0 (TID 10, localhost, executor driver, partition 7, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Running task 7.0 in stage 3.0 (TID 10)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9) in 199 ms on localhost (executor driver) (7/200)
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:38] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134238_0003_m_000007_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 8.0 in stage 3.0 (TID 11, localhost, executor driver, partition 8, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 8.0 in stage 3.0 (TID 11)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10) in 112 ms on localhost (executor driver) (8/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000008_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 9.0 in stage 3.0 (TID 12, localhost, executor driver, partition 9, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11) in 213 ms on localhost (executor driver) (9/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 9.0 in stage 3.0 (TID 12)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000009_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 10.0 in stage 3.0 (TID 13, localhost, executor driver, partition 10, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12) in 138 ms on localhost (executor driver) (10/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 10.0 in stage 3.0 (TID 13)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000010_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 11.0 in stage 3.0 (TID 14, localhost, executor driver, partition 11, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13) in 69 ms on localhost (executor driver) (11/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 11.0 in stage 3.0 (TID 14)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000011_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 12.0 in stage 3.0 (TID 15, localhost, executor driver, partition 12, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 12.0 in stage 3.0 (TID 15)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14) in 105 ms on localhost (executor driver) (12/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000012_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 13.0 in stage 3.0 (TID 16, localhost, executor driver, partition 13, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15) in 76 ms on localhost (executor driver) (13/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 13.0 in stage 3.0 (TID 16)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000013_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 14.0 in stage 3.0 (TID 17, localhost, executor driver, partition 14, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16) in 104 ms on localhost (executor driver) (14/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 14.0 in stage 3.0 (TID 17)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000014_0: Committed
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17). 3771 bytes result sent to driver
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Starting task 15.0 in stage 3.0 (TID 18, localhost, executor driver, partition 15, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17) in 143 ms on localhost (executor driver) (15/200)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Running task 15.0 in stage 3.0 (TID 18)
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:39] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134239_0003_m_000015_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 16.0 in stage 3.0 (TID 19, localhost, executor driver, partition 16, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 16.0 in stage 3.0 (TID 19)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18) in 159 ms on localhost (executor driver) (16/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000016_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 17.0 in stage 3.0 (TID 20, localhost, executor driver, partition 17, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19) in 157 ms on localhost (executor driver) (17/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 17.0 in stage 3.0 (TID 20)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000017_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 18.0 in stage 3.0 (TID 21, localhost, executor driver, partition 18, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 18.0 in stage 3.0 (TID 21)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20) in 131 ms on localhost (executor driver) (18/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000018_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 19.0 in stage 3.0 (TID 22, localhost, executor driver, partition 19, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21) in 102 ms on localhost (executor driver) (19/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 19.0 in stage 3.0 (TID 22)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000019_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 20.0 in stage 3.0 (TID 23, localhost, executor driver, partition 20, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 20.0 in stage 3.0 (TID 23)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22) in 122 ms on localhost (executor driver) (20/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000020_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 21.0 in stage 3.0 (TID 24, localhost, executor driver, partition 21, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 21.0 in stage 3.0 (TID 24)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23) in 87 ms on localhost (executor driver) (21/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000021_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 22.0 in stage 3.0 (TID 25, localhost, executor driver, partition 22, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 22.0 in stage 3.0 (TID 25)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24) in 144 ms on localhost (executor driver) (22/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000022_0: Committed
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Starting task 23.0 in stage 3.0 (TID 26, localhost, executor driver, partition 23, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Running task 23.0 in stage 3.0 (TID 26)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25) in 93 ms on localhost (executor driver) (23/200)
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:40] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134240_0003_m_000023_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 24.0 in stage 3.0 (TID 27, localhost, executor driver, partition 24, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 24.0 in stage 3.0 (TID 27)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26) in 155 ms on localhost (executor driver) (24/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000024_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 25.0 in stage 3.0 (TID 28, localhost, executor driver, partition 25, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27) in 159 ms on localhost (executor driver) (25/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 25.0 in stage 3.0 (TID 28)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000025_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 26.0 in stage 3.0 (TID 29, localhost, executor driver, partition 26, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 26.0 in stage 3.0 (TID 29)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28) in 121 ms on localhost (executor driver) (26/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000026_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 27.0 in stage 3.0 (TID 30, localhost, executor driver, partition 27, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 27.0 in stage 3.0 (TID 30)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29) in 104 ms on localhost (executor driver) (27/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000027_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 28.0 in stage 3.0 (TID 31, localhost, executor driver, partition 28, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 28.0 in stage 3.0 (TID 31)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30) in 120 ms on localhost (executor driver) (28/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000028_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 29.0 in stage 3.0 (TID 32, localhost, executor driver, partition 29, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 29.0 in stage 3.0 (TID 32)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31) in 83 ms on localhost (executor driver) (29/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000029_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 30.0 in stage 3.0 (TID 33, localhost, executor driver, partition 30, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 30.0 in stage 3.0 (TID 33)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32) in 170 ms on localhost (executor driver) (30/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000030_0: Committed
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Starting task 31.0 in stage 3.0 (TID 34, localhost, executor driver, partition 31, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Running task 31.0 in stage 3.0 (TID 34)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33) in 171 ms on localhost (executor driver) (31/200)
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:41] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134241_0003_m_000031_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 32.0 in stage 3.0 (TID 35, localhost, executor driver, partition 32, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 32.0 in stage 3.0 (TID 35)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34) in 108 ms on localhost (executor driver) (32/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000032_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 33.0 in stage 3.0 (TID 36, localhost, executor driver, partition 33, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 33.0 in stage 3.0 (TID 36)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35) in 101 ms on localhost (executor driver) (33/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000033_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 34.0 in stage 3.0 (TID 37, localhost, executor driver, partition 34, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 34.0 in stage 3.0 (TID 37)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36) in 157 ms on localhost (executor driver) (34/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000034_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 35.0 in stage 3.0 (TID 38, localhost, executor driver, partition 35, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37) in 52 ms on localhost (executor driver) (35/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 35.0 in stage 3.0 (TID 38)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000035_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 36.0 in stage 3.0 (TID 39, localhost, executor driver, partition 36, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 36.0 in stage 3.0 (TID 39)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38) in 124 ms on localhost (executor driver) (36/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000036_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 37.0 in stage 3.0 (TID 40, localhost, executor driver, partition 37, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39) in 93 ms on localhost (executor driver) (37/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 37.0 in stage 3.0 (TID 40)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000037_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 38.0 in stage 3.0 (TID 41, localhost, executor driver, partition 38, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 38.0 in stage 3.0 (TID 41)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40) in 155 ms on localhost (executor driver) (38/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000038_0: Committed
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Starting task 39.0 in stage 3.0 (TID 42, localhost, executor driver, partition 39, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Running task 39.0 in stage 3.0 (TID 42)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41) in 144 ms on localhost (executor driver) (39/200)
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:42] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134242_0003_m_000039_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 40.0 in stage 3.0 (TID 43, localhost, executor driver, partition 40, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 40.0 in stage 3.0 (TID 43)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42) in 198 ms on localhost (executor driver) (40/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000040_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 41.0 in stage 3.0 (TID 44, localhost, executor driver, partition 41, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43) in 148 ms on localhost (executor driver) (41/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 41.0 in stage 3.0 (TID 44)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000041_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 42.0 in stage 3.0 (TID 45, localhost, executor driver, partition 42, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44) in 127 ms on localhost (executor driver) (42/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 42.0 in stage 3.0 (TID 45)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000042_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 43.0 in stage 3.0 (TID 46, localhost, executor driver, partition 43, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 43.0 in stage 3.0 (TID 46)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45) in 126 ms on localhost (executor driver) (43/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000043_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 44.0 in stage 3.0 (TID 47, localhost, executor driver, partition 44, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 44.0 in stage 3.0 (TID 47)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46) in 98 ms on localhost (executor driver) (44/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000044_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 45.0 in stage 3.0 (TID 48, localhost, executor driver, partition 45, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 45.0 in stage 3.0 (TID 48)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47) in 119 ms on localhost (executor driver) (45/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000045_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Starting task 46.0 in stage 3.0 (TID 49, localhost, executor driver, partition 46, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48) in 219 ms on localhost (executor driver) (46/200)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Running task 46.0 in stage 3.0 (TID 49)
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] attempt_20180428134243_0003_m_000046_0: Committed
[INFO ] [2018-04-28 13:42:43] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 47.0 in stage 3.0 (TID 50, localhost, executor driver, partition 47, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 47.0 in stage 3.0 (TID 50)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49) in 115 ms on localhost (executor driver) (47/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000047_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 48.0 in stage 3.0 (TID 51, localhost, executor driver, partition 48, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50) in 83 ms on localhost (executor driver) (48/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 48.0 in stage 3.0 (TID 51)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000048_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 49.0 in stage 3.0 (TID 52, localhost, executor driver, partition 49, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 49.0 in stage 3.0 (TID 52)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51) in 101 ms on localhost (executor driver) (49/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000049_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 50.0 in stage 3.0 (TID 53, localhost, executor driver, partition 50, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52) in 93 ms on localhost (executor driver) (50/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 50.0 in stage 3.0 (TID 53)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000050_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 51.0 in stage 3.0 (TID 54, localhost, executor driver, partition 51, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 51.0 in stage 3.0 (TID 54)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53) in 156 ms on localhost (executor driver) (51/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000051_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 52.0 in stage 3.0 (TID 55, localhost, executor driver, partition 52, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 52.0 in stage 3.0 (TID 55)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54) in 102 ms on localhost (executor driver) (52/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000052_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 53.0 in stage 3.0 (TID 56, localhost, executor driver, partition 53, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 53.0 in stage 3.0 (TID 56)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55) in 122 ms on localhost (executor driver) (53/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000053_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 54.0 in stage 3.0 (TID 57, localhost, executor driver, partition 54, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 54.0 in stage 3.0 (TID 57)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56) in 81 ms on localhost (executor driver) (54/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000054_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 55.0 in stage 3.0 (TID 58, localhost, executor driver, partition 55, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 55.0 in stage 3.0 (TID 58)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57) in 119 ms on localhost (executor driver) (55/200)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] attempt_20180428134244_0003_m_000055_0: Committed
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Starting task 56.0 in stage 3.0 (TID 59, localhost, executor driver, partition 56, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Running task 56.0 in stage 3.0 (TID 59)
[INFO ] [2018-04-28 13:42:44] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58) in 143 ms on localhost (executor driver) (56/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000056_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 57.0 in stage 3.0 (TID 60, localhost, executor driver, partition 57, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 57.0 in stage 3.0 (TID 60)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59) in 260 ms on localhost (executor driver) (57/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000057_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 58.0 in stage 3.0 (TID 61, localhost, executor driver, partition 58, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60) in 81 ms on localhost (executor driver) (58/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 58.0 in stage 3.0 (TID 61)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000058_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 59.0 in stage 3.0 (TID 62, localhost, executor driver, partition 59, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 59.0 in stage 3.0 (TID 62)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61) in 98 ms on localhost (executor driver) (59/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000059_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 60.0 in stage 3.0 (TID 63, localhost, executor driver, partition 60, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62) in 106 ms on localhost (executor driver) (60/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 60.0 in stage 3.0 (TID 63)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000060_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 61.0 in stage 3.0 (TID 64, localhost, executor driver, partition 61, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63) in 92 ms on localhost (executor driver) (61/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 61.0 in stage 3.0 (TID 64)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000061_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 62.0 in stage 3.0 (TID 65, localhost, executor driver, partition 62, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 62.0 in stage 3.0 (TID 65)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64) in 76 ms on localhost (executor driver) (62/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000062_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 63.0 in stage 3.0 (TID 66, localhost, executor driver, partition 63, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 63.0 in stage 3.0 (TID 66)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65) in 113 ms on localhost (executor driver) (63/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000063_0: Committed
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Starting task 64.0 in stage 3.0 (TID 67, localhost, executor driver, partition 64, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66) in 101 ms on localhost (executor driver) (64/200)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Running task 64.0 in stage 3.0 (TID 67)
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:45] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134245_0003_m_000064_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 65.0 in stage 3.0 (TID 68, localhost, executor driver, partition 65, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67) in 89 ms on localhost (executor driver) (65/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 65.0 in stage 3.0 (TID 68)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000065_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68). 3771 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 66.0 in stage 3.0 (TID 69, localhost, executor driver, partition 66, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 66.0 in stage 3.0 (TID 69)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68) in 63 ms on localhost (executor driver) (66/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000066_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 67.0 in stage 3.0 (TID 70, localhost, executor driver, partition 67, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69) in 43 ms on localhost (executor driver) (67/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 67.0 in stage 3.0 (TID 70)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000067_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 68.0 in stage 3.0 (TID 71, localhost, executor driver, partition 68, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 68.0 in stage 3.0 (TID 71)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70) in 55 ms on localhost (executor driver) (68/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000068_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 69.0 in stage 3.0 (TID 72, localhost, executor driver, partition 69, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 69.0 in stage 3.0 (TID 72)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71) in 46 ms on localhost (executor driver) (69/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000069_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 70.0 in stage 3.0 (TID 73, localhost, executor driver, partition 70, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 70.0 in stage 3.0 (TID 73)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72) in 130 ms on localhost (executor driver) (70/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000070_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 71.0 in stage 3.0 (TID 74, localhost, executor driver, partition 71, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 71.0 in stage 3.0 (TID 74)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73) in 130 ms on localhost (executor driver) (71/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000071_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 72.0 in stage 3.0 (TID 75, localhost, executor driver, partition 72, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 72.0 in stage 3.0 (TID 75)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74) in 46 ms on localhost (executor driver) (72/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000072_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 73.0 in stage 3.0 (TID 76, localhost, executor driver, partition 73, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 73.0 in stage 3.0 (TID 76)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75) in 99 ms on localhost (executor driver) (73/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000073_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 74.0 in stage 3.0 (TID 77, localhost, executor driver, partition 74, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 74.0 in stage 3.0 (TID 77)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76) in 125 ms on localhost (executor driver) (74/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000074_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 75.0 in stage 3.0 (TID 78, localhost, executor driver, partition 75, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 75.0 in stage 3.0 (TID 78)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77) in 134 ms on localhost (executor driver) (75/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000075_0: Committed
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Starting task 76.0 in stage 3.0 (TID 79, localhost, executor driver, partition 76, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Running task 76.0 in stage 3.0 (TID 79)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78) in 99 ms on localhost (executor driver) (76/200)
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:46] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134246_0003_m_000076_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 77.0 in stage 3.0 (TID 80, localhost, executor driver, partition 77, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 77.0 in stage 3.0 (TID 80)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79) in 122 ms on localhost (executor driver) (77/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000077_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 78.0 in stage 3.0 (TID 81, localhost, executor driver, partition 78, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 78.0 in stage 3.0 (TID 81)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80) in 97 ms on localhost (executor driver) (78/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000078_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 79.0 in stage 3.0 (TID 82, localhost, executor driver, partition 79, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 79.0 in stage 3.0 (TID 82)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81) in 124 ms on localhost (executor driver) (79/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000079_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 80.0 in stage 3.0 (TID 83, localhost, executor driver, partition 80, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82) in 61 ms on localhost (executor driver) (80/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 80.0 in stage 3.0 (TID 83)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000080_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 81.0 in stage 3.0 (TID 84, localhost, executor driver, partition 81, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 81.0 in stage 3.0 (TID 84)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83) in 86 ms on localhost (executor driver) (81/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000081_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 82.0 in stage 3.0 (TID 85, localhost, executor driver, partition 82, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 82.0 in stage 3.0 (TID 85)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84) in 66 ms on localhost (executor driver) (82/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000082_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 83.0 in stage 3.0 (TID 86, localhost, executor driver, partition 83, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 83.0 in stage 3.0 (TID 86)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85) in 122 ms on localhost (executor driver) (83/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000083_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 84.0 in stage 3.0 (TID 87, localhost, executor driver, partition 84, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 84.0 in stage 3.0 (TID 87)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86) in 87 ms on localhost (executor driver) (84/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000084_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 85.0 in stage 3.0 (TID 88, localhost, executor driver, partition 85, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 85.0 in stage 3.0 (TID 88)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87) in 124 ms on localhost (executor driver) (85/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000085_0: Committed
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Starting task 86.0 in stage 3.0 (TID 89, localhost, executor driver, partition 86, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Running task 86.0 in stage 3.0 (TID 89)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88) in 83 ms on localhost (executor driver) (86/200)
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:47] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134247_0003_m_000086_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 87.0 in stage 3.0 (TID 90, localhost, executor driver, partition 87, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 87.0 in stage 3.0 (TID 90)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89) in 118 ms on localhost (executor driver) (87/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000087_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 88.0 in stage 3.0 (TID 91, localhost, executor driver, partition 88, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 88.0 in stage 3.0 (TID 91)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90) in 47 ms on localhost (executor driver) (88/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000088_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 89.0 in stage 3.0 (TID 92, localhost, executor driver, partition 89, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91) in 57 ms on localhost (executor driver) (89/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 89.0 in stage 3.0 (TID 92)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000089_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 90.0 in stage 3.0 (TID 93, localhost, executor driver, partition 90, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 90.0 in stage 3.0 (TID 93)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92) in 100 ms on localhost (executor driver) (90/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000090_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 91.0 in stage 3.0 (TID 94, localhost, executor driver, partition 91, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 91.0 in stage 3.0 (TID 94)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93) in 122 ms on localhost (executor driver) (91/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000091_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 92.0 in stage 3.0 (TID 95, localhost, executor driver, partition 92, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94) in 99 ms on localhost (executor driver) (92/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 92.0 in stage 3.0 (TID 95)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000092_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 93.0 in stage 3.0 (TID 96, localhost, executor driver, partition 93, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 93.0 in stage 3.0 (TID 96)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95) in 47 ms on localhost (executor driver) (93/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000093_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 94.0 in stage 3.0 (TID 97, localhost, executor driver, partition 94, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 94.0 in stage 3.0 (TID 97)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96) in 56 ms on localhost (executor driver) (94/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000094_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 95.0 in stage 3.0 (TID 98, localhost, executor driver, partition 95, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97) in 60 ms on localhost (executor driver) (95/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 95.0 in stage 3.0 (TID 98)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000095_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 96.0 in stage 3.0 (TID 99, localhost, executor driver, partition 96, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 96.0 in stage 3.0 (TID 99)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98) in 89 ms on localhost (executor driver) (96/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000096_0: Committed
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Starting task 97.0 in stage 3.0 (TID 100, localhost, executor driver, partition 97, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Running task 97.0 in stage 3.0 (TID 100)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99) in 127 ms on localhost (executor driver) (97/200)
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:48] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134248_0003_m_000097_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 98.0 in stage 3.0 (TID 101, localhost, executor driver, partition 98, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 98.0 in stage 3.0 (TID 101)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100) in 202 ms on localhost (executor driver) (98/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000098_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 99.0 in stage 3.0 (TID 102, localhost, executor driver, partition 99, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101) in 86 ms on localhost (executor driver) (99/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 99.0 in stage 3.0 (TID 102)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000099_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 100.0 in stage 3.0 (TID 103, localhost, executor driver, partition 100, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 100.0 in stage 3.0 (TID 103)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102) in 55 ms on localhost (executor driver) (100/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000100_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 101.0 in stage 3.0 (TID 104, localhost, executor driver, partition 101, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 101.0 in stage 3.0 (TID 104)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103) in 114 ms on localhost (executor driver) (101/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000101_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 102.0 in stage 3.0 (TID 105, localhost, executor driver, partition 102, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 102.0 in stage 3.0 (TID 105)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104) in 102 ms on localhost (executor driver) (102/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000102_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 103.0 in stage 3.0 (TID 106, localhost, executor driver, partition 103, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 103.0 in stage 3.0 (TID 106)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105) in 108 ms on localhost (executor driver) (103/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000103_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 104.0 in stage 3.0 (TID 107, localhost, executor driver, partition 104, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 104.0 in stage 3.0 (TID 107)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106) in 91 ms on localhost (executor driver) (104/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000104_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 105.0 in stage 3.0 (TID 108, localhost, executor driver, partition 105, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107) in 127 ms on localhost (executor driver) (105/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 105.0 in stage 3.0 (TID 108)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000105_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 106.0 in stage 3.0 (TID 109, localhost, executor driver, partition 106, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 106.0 in stage 3.0 (TID 109)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108) in 153 ms on localhost (executor driver) (106/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000106_0: Committed
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Starting task 107.0 in stage 3.0 (TID 110, localhost, executor driver, partition 107, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Running task 107.0 in stage 3.0 (TID 110)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109) in 89 ms on localhost (executor driver) (107/200)
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:49] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134249_0003_m_000107_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 108.0 in stage 3.0 (TID 111, localhost, executor driver, partition 108, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 108.0 in stage 3.0 (TID 111)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110) in 47 ms on localhost (executor driver) (108/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000108_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 109.0 in stage 3.0 (TID 112, localhost, executor driver, partition 109, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 109.0 in stage 3.0 (TID 112)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111) in 71 ms on localhost (executor driver) (109/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000109_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 110.0 in stage 3.0 (TID 113, localhost, executor driver, partition 110, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112) in 45 ms on localhost (executor driver) (110/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 110.0 in stage 3.0 (TID 113)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000110_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 111.0 in stage 3.0 (TID 114, localhost, executor driver, partition 111, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113) in 48 ms on localhost (executor driver) (111/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 111.0 in stage 3.0 (TID 114)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000111_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114). 3771 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 112.0 in stage 3.0 (TID 115, localhost, executor driver, partition 112, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114) in 61 ms on localhost (executor driver) (112/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 112.0 in stage 3.0 (TID 115)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000112_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 113.0 in stage 3.0 (TID 116, localhost, executor driver, partition 113, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 113.0 in stage 3.0 (TID 116)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115) in 125 ms on localhost (executor driver) (113/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000113_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 114.0 in stage 3.0 (TID 117, localhost, executor driver, partition 114, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 114.0 in stage 3.0 (TID 117)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116) in 94 ms on localhost (executor driver) (114/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000114_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 115.0 in stage 3.0 (TID 118, localhost, executor driver, partition 115, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 115.0 in stage 3.0 (TID 118)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117) in 111 ms on localhost (executor driver) (115/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000115_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 116.0 in stage 3.0 (TID 119, localhost, executor driver, partition 116, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 116.0 in stage 3.0 (TID 119)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118) in 158 ms on localhost (executor driver) (116/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000116_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 117.0 in stage 3.0 (TID 120, localhost, executor driver, partition 117, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 117.0 in stage 3.0 (TID 120)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119) in 120 ms on localhost (executor driver) (117/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000117_0: Committed
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Starting task 118.0 in stage 3.0 (TID 121, localhost, executor driver, partition 118, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Running task 118.0 in stage 3.0 (TID 121)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120) in 75 ms on localhost (executor driver) (118/200)
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:50] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134250_0003_m_000118_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 119.0 in stage 3.0 (TID 122, localhost, executor driver, partition 119, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 119.0 in stage 3.0 (TID 122)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121) in 90 ms on localhost (executor driver) (119/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000119_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 120.0 in stage 3.0 (TID 123, localhost, executor driver, partition 120, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 120.0 in stage 3.0 (TID 123)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122) in 114 ms on localhost (executor driver) (120/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000120_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 121.0 in stage 3.0 (TID 124, localhost, executor driver, partition 121, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123) in 48 ms on localhost (executor driver) (121/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 121.0 in stage 3.0 (TID 124)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000121_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 122.0 in stage 3.0 (TID 125, localhost, executor driver, partition 122, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 122.0 in stage 3.0 (TID 125)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124) in 119 ms on localhost (executor driver) (122/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000122_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 123.0 in stage 3.0 (TID 126, localhost, executor driver, partition 123, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 123.0 in stage 3.0 (TID 126)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125) in 86 ms on localhost (executor driver) (123/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000123_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 124.0 in stage 3.0 (TID 127, localhost, executor driver, partition 124, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 124.0 in stage 3.0 (TID 127)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126) in 314 ms on localhost (executor driver) (124/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000124_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 125.0 in stage 3.0 (TID 128, localhost, executor driver, partition 125, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 125.0 in stage 3.0 (TID 128)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127) in 174 ms on localhost (executor driver) (125/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000125_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 126.0 in stage 3.0 (TID 129, localhost, executor driver, partition 126, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 126.0 in stage 3.0 (TID 129)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128) in 65 ms on localhost (executor driver) (126/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000126_0: Committed
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Starting task 127.0 in stage 3.0 (TID 130, localhost, executor driver, partition 127, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Running task 127.0 in stage 3.0 (TID 130)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129) in 65 ms on localhost (executor driver) (127/200)
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:51] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134251_0003_m_000127_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 128.0 in stage 3.0 (TID 131, localhost, executor driver, partition 128, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 128.0 in stage 3.0 (TID 131)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130) in 225 ms on localhost (executor driver) (128/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000128_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 129.0 in stage 3.0 (TID 132, localhost, executor driver, partition 129, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 129.0 in stage 3.0 (TID 132)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131) in 78 ms on localhost (executor driver) (129/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000129_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 130.0 in stage 3.0 (TID 133, localhost, executor driver, partition 130, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 130.0 in stage 3.0 (TID 133)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132) in 53 ms on localhost (executor driver) (130/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000130_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 131.0 in stage 3.0 (TID 134, localhost, executor driver, partition 131, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 131.0 in stage 3.0 (TID 134)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133) in 141 ms on localhost (executor driver) (131/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000131_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 132.0 in stage 3.0 (TID 135, localhost, executor driver, partition 132, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 132.0 in stage 3.0 (TID 135)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134) in 61 ms on localhost (executor driver) (132/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000132_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 133.0 in stage 3.0 (TID 136, localhost, executor driver, partition 133, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 133.0 in stage 3.0 (TID 136)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135) in 84 ms on localhost (executor driver) (133/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000133_0: Committed
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Starting task 134.0 in stage 3.0 (TID 137, localhost, executor driver, partition 134, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Running task 134.0 in stage 3.0 (TID 137)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136) in 200 ms on localhost (executor driver) (134/200)
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:52] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134252_0003_m_000134_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 135.0 in stage 3.0 (TID 138, localhost, executor driver, partition 135, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 135.0 in stage 3.0 (TID 138)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137) in 289 ms on localhost (executor driver) (135/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000135_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 136.0 in stage 3.0 (TID 139, localhost, executor driver, partition 136, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 136.0 in stage 3.0 (TID 139)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138) in 56 ms on localhost (executor driver) (136/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000136_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 137.0 in stage 3.0 (TID 140, localhost, executor driver, partition 137, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 137.0 in stage 3.0 (TID 140)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139) in 48 ms on localhost (executor driver) (137/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000137_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 138.0 in stage 3.0 (TID 141, localhost, executor driver, partition 138, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140) in 57 ms on localhost (executor driver) (138/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 138.0 in stage 3.0 (TID 141)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000138_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 139.0 in stage 3.0 (TID 142, localhost, executor driver, partition 139, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 139.0 in stage 3.0 (TID 142)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141) in 101 ms on localhost (executor driver) (139/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000139_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 140.0 in stage 3.0 (TID 143, localhost, executor driver, partition 140, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 140.0 in stage 3.0 (TID 143)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142) in 79 ms on localhost (executor driver) (140/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000140_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 141.0 in stage 3.0 (TID 144, localhost, executor driver, partition 141, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 141.0 in stage 3.0 (TID 144)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143) in 67 ms on localhost (executor driver) (141/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000141_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 142.0 in stage 3.0 (TID 145, localhost, executor driver, partition 142, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 142.0 in stage 3.0 (TID 145)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144) in 50 ms on localhost (executor driver) (142/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000142_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 143.0 in stage 3.0 (TID 146, localhost, executor driver, partition 143, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 143.0 in stage 3.0 (TID 146)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145) in 87 ms on localhost (executor driver) (143/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000143_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 144.0 in stage 3.0 (TID 147, localhost, executor driver, partition 144, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 144.0 in stage 3.0 (TID 147)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146) in 75 ms on localhost (executor driver) (144/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000144_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 145.0 in stage 3.0 (TID 148, localhost, executor driver, partition 145, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 145.0 in stage 3.0 (TID 148)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147) in 81 ms on localhost (executor driver) (145/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000145_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 146.0 in stage 3.0 (TID 149, localhost, executor driver, partition 146, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 146.0 in stage 3.0 (TID 149)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148) in 101 ms on localhost (executor driver) (146/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000146_0: Committed
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Starting task 147.0 in stage 3.0 (TID 150, localhost, executor driver, partition 147, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Running task 147.0 in stage 3.0 (TID 150)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149) in 77 ms on localhost (executor driver) (147/200)
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:53] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134253_0003_m_000147_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 148.0 in stage 3.0 (TID 151, localhost, executor driver, partition 148, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 148.0 in stage 3.0 (TID 151)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150) in 270 ms on localhost (executor driver) (148/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000148_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 149.0 in stage 3.0 (TID 152, localhost, executor driver, partition 149, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 149.0 in stage 3.0 (TID 152)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151) in 72 ms on localhost (executor driver) (149/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000149_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 150.0 in stage 3.0 (TID 153, localhost, executor driver, partition 150, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 150.0 in stage 3.0 (TID 153)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152) in 44 ms on localhost (executor driver) (150/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000150_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 151.0 in stage 3.0 (TID 154, localhost, executor driver, partition 151, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 151.0 in stage 3.0 (TID 154)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153) in 66 ms on localhost (executor driver) (151/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000151_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 152.0 in stage 3.0 (TID 155, localhost, executor driver, partition 152, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 152.0 in stage 3.0 (TID 155)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154) in 65 ms on localhost (executor driver) (152/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000152_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 153.0 in stage 3.0 (TID 156, localhost, executor driver, partition 153, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 153.0 in stage 3.0 (TID 156)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155) in 71 ms on localhost (executor driver) (153/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000153_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 154.0 in stage 3.0 (TID 157, localhost, executor driver, partition 154, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 154.0 in stage 3.0 (TID 157)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156) in 171 ms on localhost (executor driver) (154/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000154_0: Committed
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Starting task 155.0 in stage 3.0 (TID 158, localhost, executor driver, partition 155, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Running task 155.0 in stage 3.0 (TID 158)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157) in 154 ms on localhost (executor driver) (155/200)
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:54] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134254_0003_m_000155_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 156.0 in stage 3.0 (TID 159, localhost, executor driver, partition 156, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 156.0 in stage 3.0 (TID 159)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158) in 179 ms on localhost (executor driver) (156/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000156_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 157.0 in stage 3.0 (TID 160, localhost, executor driver, partition 157, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 157.0 in stage 3.0 (TID 160)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159) in 200 ms on localhost (executor driver) (157/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000157_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 158.0 in stage 3.0 (TID 161, localhost, executor driver, partition 158, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 158.0 in stage 3.0 (TID 161)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160) in 50 ms on localhost (executor driver) (158/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000158_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 159.0 in stage 3.0 (TID 162, localhost, executor driver, partition 159, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 159.0 in stage 3.0 (TID 162)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161) in 52 ms on localhost (executor driver) (159/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000159_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 160.0 in stage 3.0 (TID 163, localhost, executor driver, partition 160, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 160.0 in stage 3.0 (TID 163)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162) in 76 ms on localhost (executor driver) (160/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000160_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 161.0 in stage 3.0 (TID 164, localhost, executor driver, partition 161, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 161.0 in stage 3.0 (TID 164)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163) in 46 ms on localhost (executor driver) (161/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000161_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164) in 62 ms on localhost (executor driver) (162/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 162.0 in stage 3.0 (TID 165, localhost, executor driver, partition 162, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 162.0 in stage 3.0 (TID 165)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000162_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 163.0 in stage 3.0 (TID 166, localhost, executor driver, partition 163, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 163.0 in stage 3.0 (TID 166)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165) in 114 ms on localhost (executor driver) (163/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000163_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 164.0 in stage 3.0 (TID 167, localhost, executor driver, partition 164, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 164.0 in stage 3.0 (TID 167)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166) in 118 ms on localhost (executor driver) (164/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000164_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 165.0 in stage 3.0 (TID 168, localhost, executor driver, partition 165, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 165.0 in stage 3.0 (TID 168)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167) in 100 ms on localhost (executor driver) (165/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000165_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 166.0 in stage 3.0 (TID 169, localhost, executor driver, partition 166, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 166.0 in stage 3.0 (TID 169)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168) in 49 ms on localhost (executor driver) (166/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000166_0: Committed
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Starting task 167.0 in stage 3.0 (TID 170, localhost, executor driver, partition 167, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Running task 167.0 in stage 3.0 (TID 170)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169) in 57 ms on localhost (executor driver) (167/200)
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134255_0003_m_000167_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 168.0 in stage 3.0 (TID 171, localhost, executor driver, partition 168, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 168.0 in stage 3.0 (TID 171)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170) in 46 ms on localhost (executor driver) (168/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000168_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 169.0 in stage 3.0 (TID 172, localhost, executor driver, partition 169, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 169.0 in stage 3.0 (TID 172)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171) in 82 ms on localhost (executor driver) (169/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000169_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 170.0 in stage 3.0 (TID 173, localhost, executor driver, partition 170, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 170.0 in stage 3.0 (TID 173)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172) in 72 ms on localhost (executor driver) (170/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000170_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 171.0 in stage 3.0 (TID 174, localhost, executor driver, partition 171, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 171.0 in stage 3.0 (TID 174)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173) in 121 ms on localhost (executor driver) (171/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000171_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 172.0 in stage 3.0 (TID 175, localhost, executor driver, partition 172, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174) in 81 ms on localhost (executor driver) (172/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 172.0 in stage 3.0 (TID 175)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000172_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 173.0 in stage 3.0 (TID 176, localhost, executor driver, partition 173, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 173.0 in stage 3.0 (TID 176)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175) in 54 ms on localhost (executor driver) (173/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000173_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 174.0 in stage 3.0 (TID 177, localhost, executor driver, partition 174, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 174.0 in stage 3.0 (TID 177)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176) in 61 ms on localhost (executor driver) (174/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000174_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 175.0 in stage 3.0 (TID 178, localhost, executor driver, partition 175, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 175.0 in stage 3.0 (TID 178)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177) in 49 ms on localhost (executor driver) (175/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000175_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 176.0 in stage 3.0 (TID 179, localhost, executor driver, partition 176, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 176.0 in stage 3.0 (TID 179)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178) in 107 ms on localhost (executor driver) (176/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000176_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 177.0 in stage 3.0 (TID 180, localhost, executor driver, partition 177, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 177.0 in stage 3.0 (TID 180)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179) in 107 ms on localhost (executor driver) (177/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000177_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 178.0 in stage 3.0 (TID 181, localhost, executor driver, partition 178, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 178.0 in stage 3.0 (TID 181)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180) in 88 ms on localhost (executor driver) (178/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000178_0: Committed
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Starting task 179.0 in stage 3.0 (TID 182, localhost, executor driver, partition 179, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Running task 179.0 in stage 3.0 (TID 182)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181) in 115 ms on localhost (executor driver) (179/200)
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134256_0003_m_000179_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 180.0 in stage 3.0 (TID 183, localhost, executor driver, partition 180, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 180.0 in stage 3.0 (TID 183)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182) in 94 ms on localhost (executor driver) (180/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000180_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 181.0 in stage 3.0 (TID 184, localhost, executor driver, partition 181, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 181.0 in stage 3.0 (TID 184)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183) in 60 ms on localhost (executor driver) (181/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000181_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 182.0 in stage 3.0 (TID 185, localhost, executor driver, partition 182, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 182.0 in stage 3.0 (TID 185)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184) in 118 ms on localhost (executor driver) (182/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000182_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 183.0 in stage 3.0 (TID 186, localhost, executor driver, partition 183, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185) in 45 ms on localhost (executor driver) (183/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 183.0 in stage 3.0 (TID 186)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000183_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 184.0 in stage 3.0 (TID 187, localhost, executor driver, partition 184, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 184.0 in stage 3.0 (TID 187)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186) in 87 ms on localhost (executor driver) (184/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000184_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 185.0 in stage 3.0 (TID 188, localhost, executor driver, partition 185, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 185.0 in stage 3.0 (TID 188)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187) in 77 ms on localhost (executor driver) (185/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000185_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 186.0 in stage 3.0 (TID 189, localhost, executor driver, partition 186, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 186.0 in stage 3.0 (TID 189)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188) in 52 ms on localhost (executor driver) (186/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000186_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 187.0 in stage 3.0 (TID 190, localhost, executor driver, partition 187, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189) in 128 ms on localhost (executor driver) (187/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 187.0 in stage 3.0 (TID 190)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000187_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 188.0 in stage 3.0 (TID 191, localhost, executor driver, partition 188, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190) in 144 ms on localhost (executor driver) (188/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 188.0 in stage 3.0 (TID 191)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000188_0: Committed
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Starting task 189.0 in stage 3.0 (TID 192, localhost, executor driver, partition 189, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Running task 189.0 in stage 3.0 (TID 192)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191) in 87 ms on localhost (executor driver) (189/200)
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134257_0003_m_000189_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 190.0 in stage 3.0 (TID 193, localhost, executor driver, partition 190, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 190.0 in stage 3.0 (TID 193)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192) in 161 ms on localhost (executor driver) (190/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000190_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 191.0 in stage 3.0 (TID 194, localhost, executor driver, partition 191, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 191.0 in stage 3.0 (TID 194)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193) in 253 ms on localhost (executor driver) (191/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000191_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194). 3728 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 192.0 in stage 3.0 (TID 195, localhost, executor driver, partition 192, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194) in 63 ms on localhost (executor driver) (192/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 192.0 in stage 3.0 (TID 195)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000192_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 193.0 in stage 3.0 (TID 196, localhost, executor driver, partition 193, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 193.0 in stage 3.0 (TID 196)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195) in 71 ms on localhost (executor driver) (193/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000193_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 194.0 in stage 3.0 (TID 197, localhost, executor driver, partition 194, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 194.0 in stage 3.0 (TID 197)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196) in 62 ms on localhost (executor driver) (194/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000194_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 195.0 in stage 3.0 (TID 198, localhost, executor driver, partition 195, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 195.0 in stage 3.0 (TID 198)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197) in 43 ms on localhost (executor driver) (195/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000195_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 196.0 in stage 3.0 (TID 199, localhost, executor driver, partition 196, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 196.0 in stage 3.0 (TID 199)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198) in 48 ms on localhost (executor driver) (196/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000196_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 197.0 in stage 3.0 (TID 200, localhost, executor driver, partition 197, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 197.0 in stage 3.0 (TID 200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199) in 79 ms on localhost (executor driver) (197/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000197_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 198.0 in stage 3.0 (TID 201, localhost, executor driver, partition 198, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 198.0 in stage 3.0 (TID 201)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200) in 79 ms on localhost (executor driver) (198/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000198_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201). 3685 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Starting task 199.0 in stage 3.0 (TID 202, localhost, executor driver, partition 199, ANY, 5054 bytes)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Running task 199.0 in stage 3.0 (TID 202)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201) in 95 ms on localhost (executor driver) (199/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] attempt_20180428134258_0003_m_000199_0: Committed
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202). 3642 bytes result sent to driver
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202) in 77 ms on localhost (executor driver) (200/200)
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Removed TaskSet 3.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 22.437 s
[INFO ] [2018-04-28 13:42:58] [Logging$class:logInfo:54] Job 1 finished: saveAsTable at HistoryDataToA_DateRange.scala:121, took 27.447814 s
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Starting job: collect at posProductProcessor.scala:222
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Got job 2 (collect at posProductProcessor.scala:222) with 15 output partitions
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Final stage: ResultStage 4 (collect at posProductProcessor.scala:222)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Submitting ResultStage 4 (MapPartitionsRDD[53] at map at posProductProcessor.scala:217), which has no missing parents
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Block broadcast_15 stored as values in memory (estimated size 4.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Block broadcast_15_piece0 stored as bytes in memory (estimated size 2.2 KB, free 1926.1 MB)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Added broadcast_15_piece0 in memory on 192.168.0.152:62020 (size: 2.2 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Created broadcast 15 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 4 (MapPartitionsRDD[53] at map at posProductProcessor.scala:217) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Adding task set 4.0 with 15 tasks
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Starting task 0.0 in stage 4.0 (TID 203, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Running task 0.0 in stage 4.0 (TID 203)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203). 212251 bytes result sent to driver
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Starting task 1.0 in stage 4.0 (TID 204, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Running task 1.0 in stage 4.0 (TID 204)
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 13:43:05] [Logging$class:logInfo:54] Finished task 0.0 in stage 4.0 (TID 203) in 209 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Block taskresult_204 stored as bytes in memory (estimated size 9.0 MB, free 1917.1 MB)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Added taskresult_204 in memory on 192.168.0.152:62020 (size: 9.0 MB, free: 1982.5 MB)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204). 9456718 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Starting task 2.0 in stage 4.0 (TID 205, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Running task 2.0 in stage 4.0 (TID 205)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表20180101—20180425.txt:0+7172200
[INFO ] [2018-04-28 13:43:08] [TransportClientFactory:createClient:254] Successfully created connection to /192.168.0.152:62020 after 40 ms (0 ms spent in bootstraps)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Finished task 1.0 in stage 4.0 (TID 204) in 2804 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 13:43:08] [Logging$class:logInfo:54] Removed taskresult_204 on 192.168.0.152:62020 in memory (size: 9.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Block taskresult_205 stored as bytes in memory (estimated size 2.5 MB, free 1923.6 MB)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Added taskresult_205 in memory on 192.168.0.152:62020 (size: 2.5 MB, free: 1989.0 MB)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205). 2642984 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Starting task 3.0 in stage 4.0 (TID 206, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Running task 3.0 in stage 4.0 (TID 206)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Finished task 2.0 in stage 4.0 (TID 205) in 859 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 13:43:09] [Logging$class:logInfo:54] Removed taskresult_205 on 192.168.0.152:62020 in memory (size: 2.5 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Block taskresult_206 stored as bytes in memory (estimated size 7.3 MB, free 1918.8 MB)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Added taskresult_206 in memory on 192.168.0.152:62020 (size: 7.3 MB, free: 1984.3 MB)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206). 7639260 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Starting task 4.0 in stage 4.0 (TID 207, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Running task 4.0 in stage 4.0 (TID 207)
[INFO ] [2018-04-28 13:43:10] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207). 845 bytes result sent to driver
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Starting task 5.0 in stage 4.0 (TID 208, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 4.0 in stage 4.0 (TID 207) in 145 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Running task 5.0 in stage 4.0 (TID 208)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/商品档案表.txt:0+5619800
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Removed taskresult_206 on 192.168.0.152:62020 in memory (size: 7.3 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 3.0 in stage 4.0 (TID 206) in 2210 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208). 759 bytes result sent to driver
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Starting task 6.0 in stage 4.0 (TID 209, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Running task 6.0 in stage 4.0 (TID 209)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 5.0 in stage 4.0 (TID 208) in 246 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209). 716 bytes result sent to driver
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Starting task 7.0 in stage 4.0 (TID 210, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Running task 7.0 in stage 4.0 (TID 210)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 6.0 in stage 4.0 (TID 209) in 6 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/实物流水2018.04.25.txt:0+8982999
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210). 716 bytes result sent to driver
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Starting task 8.0 in stage 4.0 (TID 211, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Running task 8.0 in stage 4.0 (TID 211)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Finished task 7.0 in stage 4.0 (TID 210) in 188 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 13:43:11] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Block taskresult_211 stored as bytes in memory (estimated size 3.5 MB, free 1922.6 MB)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Added taskresult_211 in memory on 192.168.0.152:62020 (size: 3.5 MB, free: 1988.1 MB)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211). 3623692 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Starting task 9.0 in stage 4.0 (TID 212, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Running task 9.0 in stage 4.0 (TID 212)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Finished task 8.0 in stage 4.0 (TID 211) in 949 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 13:43:12] [Logging$class:logInfo:54] Removed taskresult_211 on 192.168.0.152:62020 in memory (size: 3.5 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Block taskresult_212 stored as bytes in memory (estimated size 10.0 MB, free 1916.1 MB)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Added taskresult_212 in memory on 192.168.0.152:62020 (size: 10.0 MB, free: 1981.5 MB)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212). 10512126 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Starting task 10.0 in stage 4.0 (TID 213, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Running task 10.0 in stage 4.0 (TID 213)
[INFO ] [2018-04-28 13:43:14] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 13:43:15] [Logging$class:logInfo:54] Removed taskresult_212 on 192.168.0.152:62020 in memory (size: 10.0 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:15] [Logging$class:logInfo:54] Finished task 9.0 in stage 4.0 (TID 212) in 2787 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Block taskresult_213 stored as bytes in memory (estimated size 12.6 MB, free 1913.5 MB)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Added taskresult_213 in memory on 192.168.0.152:62020 (size: 12.6 MB, free: 1978.9 MB)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213). 13243222 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Starting task 11.0 in stage 4.0 (TID 214, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Running task 11.0 in stage 4.0 (TID 214)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20180101—20180425.txt:0+1484090
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214). 629468 bytes result sent to driver
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Starting task 12.0 in stage 4.0 (TID 215, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Running task 12.0 in stage 4.0 (TID 215)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/组合优惠商品明细表.txt:0+5844435
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Finished task 11.0 in stage 4.0 (TID 214) in 204 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Finished task 10.0 in stage 4.0 (TID 213) in 3850 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Removed taskresult_213 on 192.168.0.152:62020 in memory (size: 12.6 MB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Block taskresult_215 stored as bytes in memory (estimated size 1877.8 KB, free 1924.2 MB)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Added taskresult_215 in memory on 192.168.0.152:62020 (size: 1877.8 KB, free: 1989.7 MB)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215). 1922867 bytes result sent via BlockManager)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Starting task 13.0 in stage 4.0 (TID 216, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Running task 13.0 in stage 4.0 (TID 216)
[INFO ] [2018-04-28 13:43:18] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/组合商品.txt:0+6682758
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Finished task 12.0 in stage 4.0 (TID 215) in 663 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Removed taskresult_215 on 192.168.0.152:62020 in memory (size: 1877.8 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216). 759 bytes result sent to driver
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Starting task 14.0 in stage 4.0 (TID 217, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Running task 14.0 in stage 4.0 (TID 217)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Finished task 13.0 in stage 4.0 (TID 216) in 126 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/金额流水2018.04.25.txt:0+3194310
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217). 716 bytes result sent to driver
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Finished task 14.0 in stage 4.0 (TID 217) in 57 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Removed TaskSet 4.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] ResultStage 4 (collect at posProductProcessor.scala:222) finished in 13.388 s
[INFO ] [2018-04-28 13:43:19] [Logging$class:logInfo:54] Job 2 finished: collect at posProductProcessor.scala:222, took 13.394473 s
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: ba_model.banner_promotion
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA_DateRange.scala:133
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Got job 3 (saveAsTable at HistoryDataToA_DateRange.scala:133) with 15 output partitions
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Final stage: ResultStage 5 (saveAsTable at HistoryDataToA_DateRange.scala:133)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Submitting ResultStage 5 (MapPartitionsRDD[56] at saveAsTable at HistoryDataToA_DateRange.scala:133), which has no missing parents
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Block broadcast_16 stored as values in memory (estimated size 81.5 KB, free 1926.0 MB)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Block broadcast_16_piece0 stored as bytes in memory (estimated size 31.0 KB, free 1926.0 MB)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Added broadcast_16_piece0 in memory on 192.168.0.152:62020 (size: 31.0 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Created broadcast 16 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Submitting 15 missing tasks from ResultStage 5 (MapPartitionsRDD[56] at saveAsTable at HistoryDataToA_DateRange.scala:133) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Adding task set 5.0 with 15 tasks
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Starting task 0.0 in stage 5.0 (TID 218, localhost, executor driver, partition 0, ANY, 4928 bytes)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Running task 0.0 in stage 5.0 (TID 218)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/全场总额优惠活动促销商品详细信息.txt:0+380868
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 12.214005 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 6.040926 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 9.571312 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 43.738661 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 6.529516 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 22.243324 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Code generated in 8.763666 ms
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] attempt_20180428134323_0005_m_000000_0: Committed
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218). 1792 bytes result sent to driver
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Starting task 1.0 in stage 5.0 (TID 219, localhost, executor driver, partition 1, ANY, 4935 bytes)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Running task 1.0 in stage 5.0 (TID 219)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Finished task 0.0 in stage 5.0 (TID 218) in 321 ms on localhost (executor driver) (1/15)
[INFO ] [2018-04-28 13:43:23] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表20170101—20171231.txt:0+24859329
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 4
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 23
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 5
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 16
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 11
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 2
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 18
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 15
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 7
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Removed broadcast_15_piece0 on 192.168.0.152:62020 in memory (size: 2.2 KB, free: 1991.5 MB)
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 24
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 9
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 12
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 20
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 8
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 6
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 10
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 21
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned shuffle 1
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Removed broadcast_11_piece0 on 192.168.0.152:62020 in memory (size: 337.8 KB, free: 1991.8 MB)
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 22
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 1
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Removed broadcast_14_piece0 on 192.168.0.152:62020 in memory (size: 43.3 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 19
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 13
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 14
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned shuffle 0
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 3
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Removed broadcast_9_piece0 on 192.168.0.152:62020 in memory (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 0
[INFO ] [2018-04-28 13:43:24] [Logging$class:logInfo:54] Cleaned accumulator 17
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] attempt_20180428134325_0005_m_000001_0: Committed
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219). 1878 bytes result sent to driver
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Starting task 2.0 in stage 5.0 (TID 220, localhost, executor driver, partition 2, ANY, 4935 bytes)
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Finished task 1.0 in stage 5.0 (TID 219) in 2531 ms on localhost (executor driver) (2/15)
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Running task 2.0 in stage 5.0 (TID 220)
[INFO ] [2018-04-28 13:43:25] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表20180101—20180425.txt:0+7172200
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] attempt_20180428134326_0005_m_000002_0: Committed
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220). 1878 bytes result sent to driver
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Starting task 3.0 in stage 5.0 (TID 221, localhost, executor driver, partition 3, ANY, 4925 bytes)
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Running task 3.0 in stage 5.0 (TID 221)
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Finished task 2.0 in stage 5.0 (TID 220) in 637 ms on localhost (executor driver) (3/15)
[INFO ] [2018-04-28 13:43:26] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/售价、进价促销商品明细表_20161231.txt:0+19752159
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] attempt_20180428134328_0005_m_000003_0: Committed
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221). 1878 bytes result sent to driver
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Starting task 4.0 in stage 5.0 (TID 222, localhost, executor driver, partition 4, ANY, 4922 bytes)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Running task 4.0 in stage 5.0 (TID 222)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 3.0 in stage 5.0 (TID 221) in 1664 ms on localhost (executor driver) (4/15)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/商品总额优惠促销商品详细信息.txt:0+3385742
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134328_0005_m_000004_0
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222). 1753 bytes result sent to driver
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Starting task 5.0 in stage 5.0 (TID 223, localhost, executor driver, partition 5, ANY, 4895 bytes)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Running task 5.0 in stage 5.0 (TID 223)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 4.0 in stage 5.0 (TID 222) in 98 ms on localhost (executor driver) (5/15)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/商品档案表.txt:0+5619800
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134328_0005_m_000005_0
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223). 1753 bytes result sent to driver
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Starting task 6.0 in stage 5.0 (TID 224, localhost, executor driver, partition 6, ANY, 4907 bytes)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Running task 6.0 in stage 5.0 (TID 224)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 5.0 in stage 5.0 (TID 223) in 140 ms on localhost (executor driver) (6/15)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/安达便利门店信息表.txt:0+9224
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134328_0005_m_000006_0
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224). 1710 bytes result sent to driver
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Starting task 7.0 in stage 5.0 (TID 225, localhost, executor driver, partition 7, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Running task 7.0 in stage 5.0 (TID 225)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 6.0 in stage 5.0 (TID 224) in 11 ms on localhost (executor driver) (7/15)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/实物流水2018.04.25.txt:0+8982999
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134328_0005_m_000007_0
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225). 1796 bytes result sent to driver
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Starting task 8.0 in stage 5.0 (TID 226, localhost, executor driver, partition 8, ANY, 4915 bytes)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Running task 8.0 in stage 5.0 (TID 226)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Finished task 7.0 in stage 5.0 (TID 225) in 190 ms on localhost (executor driver) (8/15)
[INFO ] [2018-04-28 13:43:28] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20151231.txt:0+8176619
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] attempt_20180428134329_0005_m_000008_0: Committed
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226). 1835 bytes result sent to driver
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Starting task 9.0 in stage 5.0 (TID 227, localhost, executor driver, partition 9, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Running task 9.0 in stage 5.0 (TID 227)
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Finished task 8.0 in stage 5.0 (TID 226) in 818 ms on localhost (executor driver) (9/15)
[INFO ] [2018-04-28 13:43:29] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20160701—20161231.txt:0+24288418
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] attempt_20180428134331_0005_m_000009_0: Committed
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227). 1835 bytes result sent to driver
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Starting task 10.0 in stage 5.0 (TID 228, localhost, executor driver, partition 10, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Finished task 9.0 in stage 5.0 (TID 227) in 2137 ms on localhost (executor driver) (10/15)
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Running task 10.0 in stage 5.0 (TID 228)
[INFO ] [2018-04-28 13:43:31] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20170101—20171231.txt:0+29747358
[INFO ] [2018-04-28 13:43:33] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:33] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:33] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] attempt_20180428134333_0005_m_000010_0: Committed
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228). 1835 bytes result sent to driver
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Starting task 11.0 in stage 5.0 (TID 229, localhost, executor driver, partition 11, ANY, 4926 bytes)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Running task 11.0 in stage 5.0 (TID 229)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 10.0 in stage 5.0 (TID 228) in 2594 ms on localhost (executor driver) (11/15)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/等级优惠商品明细表20180101—20180425.txt:0+1484090
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] attempt_20180428134334_0005_m_000011_0: Committed
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229). 1792 bytes result sent to driver
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Starting task 12.0 in stage 5.0 (TID 230, localhost, executor driver, partition 12, ANY, 4907 bytes)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Running task 12.0 in stage 5.0 (TID 230)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 11.0 in stage 5.0 (TID 229) in 197 ms on localhost (executor driver) (12/15)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/组合优惠商品明细表.txt:0+5844435
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "promotion_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_good_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_shop_id",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_start",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_end",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "promotion_banner",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary promotion_code (UTF8);
  optional binary promotion_good_id (UTF8);
  optional binary promotion_shop_id (UTF8);
  optional binary promotion_type (UTF8);
  optional int64 promotion_start;
  optional int64 promotion_end;
  optional binary promotion_banner (UTF8);
}

       
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] attempt_20180428134334_0005_m_000012_0: Committed
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230). 1835 bytes result sent to driver
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Starting task 13.0 in stage 5.0 (TID 231, localhost, executor driver, partition 13, ANY, 4892 bytes)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 12.0 in stage 5.0 (TID 230) in 480 ms on localhost (executor driver) (13/15)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Running task 13.0 in stage 5.0 (TID 231)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/组合商品.txt:0+6682758
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134334_0005_m_000013_0
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231). 1753 bytes result sent to driver
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Starting task 14.0 in stage 5.0 (TID 232, localhost, executor driver, partition 14, ANY, 4902 bytes)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Running task 14.0 in stage 5.0 (TID 232)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Finished task 13.0 in stage 5.0 (TID 231) in 145 ms on localhost (executor driver) (14/15)
[INFO ] [2018-04-28 13:43:34] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/金额流水2018.04.25.txt:0+3194310
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] No need to commit output of task because needsTaskCommit=false: attempt_20180428134335_0005_m_000014_0
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232). 1753 bytes result sent to driver
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Finished task 14.0 in stage 5.0 (TID 232) in 67 ms on localhost (executor driver) (15/15)
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Removed TaskSet 5.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] ResultStage 5 (saveAsTable at HistoryDataToA_DateRange.scala:133) finished in 12.024 s
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Job 3 finished: saveAsTable at HistoryDataToA_DateRange.scala:133, took 12.043664 s
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Persisting file based data source table `ba_model`.`banner_promotion` into Hive metastore in Hive compatible format.
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Recover all the partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Found 1 partitions in hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/banner_promotion
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Finished to gather the fast stats for all 1 partitions.
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Recovered all partitions (1).
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 13:43:35] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-2759b3ce-c74f-458c-833c-950170fb2133
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 14:03:34] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 62506.
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-f83a1e1b-cbb5-428f-a28c-2bdd839fb30b
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 62515.
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Server created on 192.168.0.152:62515
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 62515, None)
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:62515 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 62515, None)
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 62515, None)
[INFO ] [2018-04-28 14:03:35] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 62515, None)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 214.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 3 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 214.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 4 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 214.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:62515 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Created broadcast 5 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Removed broadcast_3_piece0 on 192.168.0.152:62515 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Removed broadcast_0_piece0 on 192.168.0.152:62515 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Removed broadcast_1_piece0 on 192.168.0.152:62515 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:36] [Logging$class:logInfo:54] Removed broadcast_2_piece0 on 192.168.0.152:62515 in memory (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:03:38] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 14:03:38] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 14:03:38] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 14:03:38] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 14:03:42] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 14:03:42] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 14:03:42] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:43] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:44] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:48] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:49] [Logging$class:logInfo:54] Code generated in 186.613981 ms
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_6 stored as values in memory (estimated size 224.7 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_6_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Added broadcast_6_piece0 in memory on 192.168.0.152:62515 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Created broadcast 6 from 
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[29] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_7 stored as values in memory (estimated size 12.3 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_7_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Added broadcast_7_piece0 in memory on 192.168.0.152:62515 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Created broadcast 7 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[29] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Code generated in 11.79187 ms
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218615 bytes result sent to driver
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 403 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.421 s
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.494969 s
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Code generated in 10.368765 ms
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Removed broadcast_7_piece0 on 192.168.0.152:62515 in memory (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_8 stored as values in memory (estimated size 64.5 MB, free 1926.8 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Block broadcast_8_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Added broadcast_8_piece0 in memory on 192.168.0.152:62515 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Created broadcast 8 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Code generated in 28.825703 ms
[INFO ] [2018-04-28 14:03:50] [Logging$class:logInfo:54] Code generated in 13.71829 ms
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA_DateRange.scala:121
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Registering RDD 35 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Registering RDD 31 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Got job 1 (saveAsTable at HistoryDataToA_DateRange.scala:121) with 200 output partitions
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Final stage: ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:121)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Parents of final stage: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Missing parents: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Submitting ShuffleMapStage 1 (MapPartitionsRDD[35] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Block broadcast_9 stored as values in memory (estimated size 12.3 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Block broadcast_9_piece0 stored as bytes in memory (estimated size 6.4 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Added broadcast_9_piece0 in memory on 192.168.0.152:62515 (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Created broadcast 9 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[35] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Adding task set 1.0 with 1 tasks
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Submitting ShuffleMapStage 2 (MapPartitionsRDD[31] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Block broadcast_10 stored as values in memory (estimated size 16.8 KB, free 1926.4 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Running task 0.0 in stage 1.0 (TID 1)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Block broadcast_10_piece0 stored as bytes in memory (estimated size 7.3 KB, free 1926.4 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Added broadcast_10_piece0 in memory on 192.168.0.152:62515 (size: 7.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Created broadcast 10 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[31] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Adding task set 2.0 with 1 tasks
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/金额流水2018.04.25.txt:0+3194310
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Code generated in 10.84414 ms
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Code generated in 13.800981 ms
[INFO ] [2018-04-28 14:03:51] [Logging$class:logInfo:54] Code generated in 68.986024 ms
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1). 1625 bytes result sent to driver
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Running task 0.0 in stage 2.0 (TID 2)
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/实物流水2018.04.25.txt:0+8982999
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1) in 1319 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] ShuffleMapStage 1 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 1.321 s
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] running: Set(ShuffleMapStage 2)
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Removed TaskSet 1.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Code generated in 15.862198 ms
[INFO ] [2018-04-28 14:03:52] [Logging$class:logInfo:54] Code generated in 103.335366 ms
[INFO ] [2018-04-28 14:03:53] [Logging$class:logInfo:54] Removed broadcast_9_piece0 on 192.168.0.152:62515 in memory (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2). 1539 bytes result sent to driver
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2) in 3187 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Removed TaskSet 2.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] ShuffleMapStage 2 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 4.473 s
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] running: Set()
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Submitting ResultStage 3 (MapPartitionsRDD[40] at saveAsTable at HistoryDataToA_DateRange.scala:121), which has no missing parents
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Block broadcast_11 stored as values in memory (estimated size 114.2 KB, free 1926.3 MB)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Block broadcast_11_piece0 stored as bytes in memory (estimated size 43.3 KB, free 1926.3 MB)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Added broadcast_11_piece0 in memory on 192.168.0.152:62515 (size: 43.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Created broadcast 11 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Submitting 200 missing tasks from ResultStage 3 (MapPartitionsRDD[40] at saveAsTable at HistoryDataToA_DateRange.scala:121) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Adding task set 3.0 with 200 tasks
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Starting task 0.0 in stage 3.0 (TID 3, localhost, executor driver, partition 0, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Running task 0.0 in stage 3.0 (TID 3)
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Started 0 remote fetches in 4 ms
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Code generated in 12.076566 ms
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Code generated in 11.642347 ms
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Code generated in 12.132448 ms
[INFO ] [2018-04-28 14:03:55] [Logging$class:logInfo:54] Code generated in 5.49381 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Code generated in 13.365629 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Code generated in 14.061512 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Removed broadcast_10_piece0 on 192.168.0.152:62515 in memory (size: 7.3 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Code generated in 9.643809 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Code generated in 22.289013 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Code generated in 10.92381 ms
[INFO ] [2018-04-28 14:03:56] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140356_0003_m_000000_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3). 3814 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 1.0 in stage 3.0 (TID 4, localhost, executor driver, partition 1, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 1.0 in stage 3.0 (TID 4)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3) in 1253 ms on localhost (executor driver) (1/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000001_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 2.0 in stage 3.0 (TID 5, localhost, executor driver, partition 2, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4) in 130 ms on localhost (executor driver) (2/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 2.0 in stage 3.0 (TID 5)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000002_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 3.0 in stage 3.0 (TID 6, localhost, executor driver, partition 3, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 3.0 in stage 3.0 (TID 6)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5) in 152 ms on localhost (executor driver) (3/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000003_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 4.0 in stage 3.0 (TID 7, localhost, executor driver, partition 4, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6) in 160 ms on localhost (executor driver) (4/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 4.0 in stage 3.0 (TID 7)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000004_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 5.0 in stage 3.0 (TID 8, localhost, executor driver, partition 5, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 5.0 in stage 3.0 (TID 8)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7) in 189 ms on localhost (executor driver) (5/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000005_0: Committed
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Starting task 6.0 in stage 3.0 (TID 9, localhost, executor driver, partition 6, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8) in 212 ms on localhost (executor driver) (6/200)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Running task 6.0 in stage 3.0 (TID 9)
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:57] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140357_0003_m_000006_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 7.0 in stage 3.0 (TID 10, localhost, executor driver, partition 7, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 7.0 in stage 3.0 (TID 10)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9) in 283 ms on localhost (executor driver) (7/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000007_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 8.0 in stage 3.0 (TID 11, localhost, executor driver, partition 8, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 8.0 in stage 3.0 (TID 11)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10) in 177 ms on localhost (executor driver) (8/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000008_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 9.0 in stage 3.0 (TID 12, localhost, executor driver, partition 9, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 9.0 in stage 3.0 (TID 12)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11) in 144 ms on localhost (executor driver) (9/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000009_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 10.0 in stage 3.0 (TID 13, localhost, executor driver, partition 10, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12) in 179 ms on localhost (executor driver) (10/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 10.0 in stage 3.0 (TID 13)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000010_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 11.0 in stage 3.0 (TID 14, localhost, executor driver, partition 11, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13) in 157 ms on localhost (executor driver) (11/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 11.0 in stage 3.0 (TID 14)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000011_0: Committed
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Starting task 12.0 in stage 3.0 (TID 15, localhost, executor driver, partition 12, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Running task 12.0 in stage 3.0 (TID 15)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14) in 105 ms on localhost (executor driver) (12/200)
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:58] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140358_0003_m_000012_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15). 3814 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 13.0 in stage 3.0 (TID 16, localhost, executor driver, partition 13, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15) in 126 ms on localhost (executor driver) (13/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 13.0 in stage 3.0 (TID 16)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000013_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 14.0 in stage 3.0 (TID 17, localhost, executor driver, partition 14, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 14.0 in stage 3.0 (TID 17)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16) in 112 ms on localhost (executor driver) (14/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000014_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 15.0 in stage 3.0 (TID 18, localhost, executor driver, partition 15, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 15.0 in stage 3.0 (TID 18)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17) in 116 ms on localhost (executor driver) (15/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000015_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 16.0 in stage 3.0 (TID 19, localhost, executor driver, partition 16, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 16.0 in stage 3.0 (TID 19)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18) in 110 ms on localhost (executor driver) (16/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000016_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 17.0 in stage 3.0 (TID 20, localhost, executor driver, partition 17, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19) in 117 ms on localhost (executor driver) (17/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 17.0 in stage 3.0 (TID 20)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000017_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 18.0 in stage 3.0 (TID 21, localhost, executor driver, partition 18, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 18.0 in stage 3.0 (TID 21)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20) in 121 ms on localhost (executor driver) (18/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000018_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 19.0 in stage 3.0 (TID 22, localhost, executor driver, partition 19, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 19.0 in stage 3.0 (TID 22)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21) in 145 ms on localhost (executor driver) (19/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000019_0: Committed
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Starting task 20.0 in stage 3.0 (TID 23, localhost, executor driver, partition 20, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Running task 20.0 in stage 3.0 (TID 23)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22) in 159 ms on localhost (executor driver) (20/200)
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:03:59] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140359_0003_m_000020_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 21.0 in stage 3.0 (TID 24, localhost, executor driver, partition 21, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 21.0 in stage 3.0 (TID 24)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23) in 142 ms on localhost (executor driver) (21/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000021_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 22.0 in stage 3.0 (TID 25, localhost, executor driver, partition 22, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 22.0 in stage 3.0 (TID 25)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24) in 144 ms on localhost (executor driver) (22/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000022_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 23.0 in stage 3.0 (TID 26, localhost, executor driver, partition 23, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25) in 148 ms on localhost (executor driver) (23/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 23.0 in stage 3.0 (TID 26)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000023_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 24.0 in stage 3.0 (TID 27, localhost, executor driver, partition 24, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26) in 105 ms on localhost (executor driver) (24/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 24.0 in stage 3.0 (TID 27)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000024_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 25.0 in stage 3.0 (TID 28, localhost, executor driver, partition 25, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 25.0 in stage 3.0 (TID 28)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27) in 148 ms on localhost (executor driver) (25/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 2 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000025_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 26.0 in stage 3.0 (TID 29, localhost, executor driver, partition 26, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28) in 92 ms on localhost (executor driver) (26/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 26.0 in stage 3.0 (TID 29)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000026_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 27.0 in stage 3.0 (TID 30, localhost, executor driver, partition 27, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 27.0 in stage 3.0 (TID 30)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29) in 64 ms on localhost (executor driver) (27/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000027_0: Committed
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Starting task 28.0 in stage 3.0 (TID 31, localhost, executor driver, partition 28, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Running task 28.0 in stage 3.0 (TID 31)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30) in 122 ms on localhost (executor driver) (28/200)
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:00] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140400_0003_m_000028_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 29.0 in stage 3.0 (TID 32, localhost, executor driver, partition 29, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 29.0 in stage 3.0 (TID 32)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31) in 152 ms on localhost (executor driver) (29/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000029_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 30.0 in stage 3.0 (TID 33, localhost, executor driver, partition 30, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 30.0 in stage 3.0 (TID 33)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32) in 226 ms on localhost (executor driver) (30/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000030_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 31.0 in stage 3.0 (TID 34, localhost, executor driver, partition 31, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 31.0 in stage 3.0 (TID 34)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33) in 114 ms on localhost (executor driver) (31/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000031_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 32.0 in stage 3.0 (TID 35, localhost, executor driver, partition 32, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34) in 160 ms on localhost (executor driver) (32/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 32.0 in stage 3.0 (TID 35)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000032_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 33.0 in stage 3.0 (TID 36, localhost, executor driver, partition 33, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 33.0 in stage 3.0 (TID 36)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35) in 108 ms on localhost (executor driver) (33/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000033_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 34.0 in stage 3.0 (TID 37, localhost, executor driver, partition 34, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36) in 53 ms on localhost (executor driver) (34/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 34.0 in stage 3.0 (TID 37)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000034_0: Committed
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Starting task 35.0 in stage 3.0 (TID 38, localhost, executor driver, partition 35, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Running task 35.0 in stage 3.0 (TID 38)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37) in 254 ms on localhost (executor driver) (35/200)
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:01] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140401_0003_m_000035_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 36.0 in stage 3.0 (TID 39, localhost, executor driver, partition 36, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 36.0 in stage 3.0 (TID 39)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38) in 117 ms on localhost (executor driver) (36/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000036_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 37.0 in stage 3.0 (TID 40, localhost, executor driver, partition 37, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 37.0 in stage 3.0 (TID 40)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39) in 210 ms on localhost (executor driver) (37/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000037_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 38.0 in stage 3.0 (TID 41, localhost, executor driver, partition 38, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 38.0 in stage 3.0 (TID 41)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40) in 136 ms on localhost (executor driver) (38/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000038_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 39.0 in stage 3.0 (TID 42, localhost, executor driver, partition 39, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41) in 133 ms on localhost (executor driver) (39/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 39.0 in stage 3.0 (TID 42)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000039_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 40.0 in stage 3.0 (TID 43, localhost, executor driver, partition 40, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42) in 107 ms on localhost (executor driver) (40/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 40.0 in stage 3.0 (TID 43)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000040_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 41.0 in stage 3.0 (TID 44, localhost, executor driver, partition 41, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 41.0 in stage 3.0 (TID 44)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43) in 115 ms on localhost (executor driver) (41/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000041_0: Committed
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Starting task 42.0 in stage 3.0 (TID 45, localhost, executor driver, partition 42, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44) in 91 ms on localhost (executor driver) (42/200)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Running task 42.0 in stage 3.0 (TID 45)
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140402_0003_m_000042_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 43.0 in stage 3.0 (TID 46, localhost, executor driver, partition 43, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 43.0 in stage 3.0 (TID 46)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45) in 160 ms on localhost (executor driver) (43/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000043_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 44.0 in stage 3.0 (TID 47, localhost, executor driver, partition 44, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46) in 119 ms on localhost (executor driver) (44/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 44.0 in stage 3.0 (TID 47)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000044_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 45.0 in stage 3.0 (TID 48, localhost, executor driver, partition 45, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47) in 80 ms on localhost (executor driver) (45/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 45.0 in stage 3.0 (TID 48)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000045_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 46.0 in stage 3.0 (TID 49, localhost, executor driver, partition 46, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 46.0 in stage 3.0 (TID 49)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48) in 130 ms on localhost (executor driver) (46/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000046_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 47.0 in stage 3.0 (TID 50, localhost, executor driver, partition 47, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 47.0 in stage 3.0 (TID 50)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49) in 90 ms on localhost (executor driver) (47/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000047_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 48.0 in stage 3.0 (TID 51, localhost, executor driver, partition 48, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50) in 75 ms on localhost (executor driver) (48/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 48.0 in stage 3.0 (TID 51)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000048_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 49.0 in stage 3.0 (TID 52, localhost, executor driver, partition 49, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 49.0 in stage 3.0 (TID 52)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51) in 76 ms on localhost (executor driver) (49/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000049_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 50.0 in stage 3.0 (TID 53, localhost, executor driver, partition 50, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 50.0 in stage 3.0 (TID 53)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52) in 115 ms on localhost (executor driver) (50/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000050_0: Committed
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Starting task 51.0 in stage 3.0 (TID 54, localhost, executor driver, partition 51, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53) in 264 ms on localhost (executor driver) (51/200)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Running task 51.0 in stage 3.0 (TID 54)
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140403_0003_m_000051_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 52.0 in stage 3.0 (TID 55, localhost, executor driver, partition 52, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 52.0 in stage 3.0 (TID 55)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54) in 132 ms on localhost (executor driver) (52/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000052_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 53.0 in stage 3.0 (TID 56, localhost, executor driver, partition 53, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55) in 78 ms on localhost (executor driver) (53/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 53.0 in stage 3.0 (TID 56)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000053_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 54.0 in stage 3.0 (TID 57, localhost, executor driver, partition 54, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56) in 89 ms on localhost (executor driver) (54/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 54.0 in stage 3.0 (TID 57)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000054_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 55.0 in stage 3.0 (TID 58, localhost, executor driver, partition 55, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 55.0 in stage 3.0 (TID 58)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57) in 100 ms on localhost (executor driver) (55/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000055_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 56.0 in stage 3.0 (TID 59, localhost, executor driver, partition 56, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 56.0 in stage 3.0 (TID 59)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58) in 75 ms on localhost (executor driver) (56/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000056_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 57.0 in stage 3.0 (TID 60, localhost, executor driver, partition 57, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59) in 96 ms on localhost (executor driver) (57/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 57.0 in stage 3.0 (TID 60)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000057_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 58.0 in stage 3.0 (TID 61, localhost, executor driver, partition 58, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 58.0 in stage 3.0 (TID 61)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60) in 64 ms on localhost (executor driver) (58/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000058_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 59.0 in stage 3.0 (TID 62, localhost, executor driver, partition 59, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 59.0 in stage 3.0 (TID 62)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61) in 49 ms on localhost (executor driver) (59/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000059_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 60.0 in stage 3.0 (TID 63, localhost, executor driver, partition 60, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 60.0 in stage 3.0 (TID 63)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62) in 62 ms on localhost (executor driver) (60/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000060_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 61.0 in stage 3.0 (TID 64, localhost, executor driver, partition 61, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 61.0 in stage 3.0 (TID 64)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63) in 95 ms on localhost (executor driver) (61/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000061_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 62.0 in stage 3.0 (TID 65, localhost, executor driver, partition 62, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64) in 133 ms on localhost (executor driver) (62/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 62.0 in stage 3.0 (TID 65)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000062_0: Committed
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Starting task 63.0 in stage 3.0 (TID 66, localhost, executor driver, partition 63, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Running task 63.0 in stage 3.0 (TID 66)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65) in 46 ms on localhost (executor driver) (63/200)
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140404_0003_m_000063_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 64.0 in stage 3.0 (TID 67, localhost, executor driver, partition 64, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 64.0 in stage 3.0 (TID 67)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66) in 92 ms on localhost (executor driver) (64/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000064_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 65.0 in stage 3.0 (TID 68, localhost, executor driver, partition 65, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 65.0 in stage 3.0 (TID 68)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67) in 116 ms on localhost (executor driver) (65/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000065_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 66.0 in stage 3.0 (TID 69, localhost, executor driver, partition 66, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 66.0 in stage 3.0 (TID 69)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68) in 115 ms on localhost (executor driver) (66/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000066_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 67.0 in stage 3.0 (TID 70, localhost, executor driver, partition 67, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 67.0 in stage 3.0 (TID 70)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69) in 73 ms on localhost (executor driver) (67/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000067_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 68.0 in stage 3.0 (TID 71, localhost, executor driver, partition 68, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 68.0 in stage 3.0 (TID 71)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70) in 82 ms on localhost (executor driver) (68/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000068_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 69.0 in stage 3.0 (TID 72, localhost, executor driver, partition 69, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 69.0 in stage 3.0 (TID 72)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71) in 99 ms on localhost (executor driver) (69/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000069_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 70.0 in stage 3.0 (TID 73, localhost, executor driver, partition 70, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 70.0 in stage 3.0 (TID 73)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72) in 113 ms on localhost (executor driver) (70/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000070_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 71.0 in stage 3.0 (TID 74, localhost, executor driver, partition 71, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 71.0 in stage 3.0 (TID 74)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73) in 83 ms on localhost (executor driver) (71/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000071_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 72.0 in stage 3.0 (TID 75, localhost, executor driver, partition 72, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 72.0 in stage 3.0 (TID 75)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74) in 106 ms on localhost (executor driver) (72/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000072_0: Committed
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Starting task 73.0 in stage 3.0 (TID 76, localhost, executor driver, partition 73, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Running task 73.0 in stage 3.0 (TID 76)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75) in 78 ms on localhost (executor driver) (73/200)
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140405_0003_m_000073_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 74.0 in stage 3.0 (TID 77, localhost, executor driver, partition 74, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 74.0 in stage 3.0 (TID 77)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76) in 235 ms on localhost (executor driver) (74/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000074_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 75.0 in stage 3.0 (TID 78, localhost, executor driver, partition 75, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 75.0 in stage 3.0 (TID 78)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77) in 130 ms on localhost (executor driver) (75/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000075_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 76.0 in stage 3.0 (TID 79, localhost, executor driver, partition 76, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 76.0 in stage 3.0 (TID 79)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78) in 89 ms on localhost (executor driver) (76/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000076_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 77.0 in stage 3.0 (TID 80, localhost, executor driver, partition 77, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 77.0 in stage 3.0 (TID 80)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79) in 82 ms on localhost (executor driver) (77/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000077_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 78.0 in stage 3.0 (TID 81, localhost, executor driver, partition 78, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 78.0 in stage 3.0 (TID 81)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80) in 70 ms on localhost (executor driver) (78/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000078_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 79.0 in stage 3.0 (TID 82, localhost, executor driver, partition 79, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81) in 66 ms on localhost (executor driver) (79/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 79.0 in stage 3.0 (TID 82)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000079_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 80.0 in stage 3.0 (TID 83, localhost, executor driver, partition 80, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 80.0 in stage 3.0 (TID 83)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82) in 73 ms on localhost (executor driver) (80/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000080_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 81.0 in stage 3.0 (TID 84, localhost, executor driver, partition 81, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 81.0 in stage 3.0 (TID 84)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83) in 76 ms on localhost (executor driver) (81/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000081_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 82.0 in stage 3.0 (TID 85, localhost, executor driver, partition 82, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 82.0 in stage 3.0 (TID 85)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84) in 66 ms on localhost (executor driver) (82/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000082_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 83.0 in stage 3.0 (TID 86, localhost, executor driver, partition 83, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 83.0 in stage 3.0 (TID 86)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85) in 103 ms on localhost (executor driver) (83/200)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] attempt_20180428140406_0003_m_000083_0: Committed
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Starting task 84.0 in stage 3.0 (TID 87, localhost, executor driver, partition 84, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Running task 84.0 in stage 3.0 (TID 87)
[INFO ] [2018-04-28 14:04:06] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86) in 90 ms on localhost (executor driver) (84/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000084_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 85.0 in stage 3.0 (TID 88, localhost, executor driver, partition 85, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 85.0 in stage 3.0 (TID 88)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87) in 79 ms on localhost (executor driver) (85/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000085_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 86.0 in stage 3.0 (TID 89, localhost, executor driver, partition 86, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 86.0 in stage 3.0 (TID 89)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88) in 120 ms on localhost (executor driver) (86/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000086_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 87.0 in stage 3.0 (TID 90, localhost, executor driver, partition 87, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 87.0 in stage 3.0 (TID 90)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89) in 111 ms on localhost (executor driver) (87/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000087_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 88.0 in stage 3.0 (TID 91, localhost, executor driver, partition 88, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 88.0 in stage 3.0 (TID 91)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90) in 47 ms on localhost (executor driver) (88/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000088_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 89.0 in stage 3.0 (TID 92, localhost, executor driver, partition 89, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91) in 178 ms on localhost (executor driver) (89/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 89.0 in stage 3.0 (TID 92)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000089_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 90.0 in stage 3.0 (TID 93, localhost, executor driver, partition 90, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92) in 80 ms on localhost (executor driver) (90/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 90.0 in stage 3.0 (TID 93)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000090_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 91.0 in stage 3.0 (TID 94, localhost, executor driver, partition 91, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 91.0 in stage 3.0 (TID 94)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93) in 52 ms on localhost (executor driver) (91/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000091_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 92.0 in stage 3.0 (TID 95, localhost, executor driver, partition 92, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 92.0 in stage 3.0 (TID 95)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94) in 40 ms on localhost (executor driver) (92/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000092_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 93.0 in stage 3.0 (TID 96, localhost, executor driver, partition 93, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 93.0 in stage 3.0 (TID 96)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95) in 40 ms on localhost (executor driver) (93/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000093_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 94.0 in stage 3.0 (TID 97, localhost, executor driver, partition 94, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 94.0 in stage 3.0 (TID 97)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96) in 89 ms on localhost (executor driver) (94/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000094_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 95.0 in stage 3.0 (TID 98, localhost, executor driver, partition 95, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 95.0 in stage 3.0 (TID 98)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97) in 43 ms on localhost (executor driver) (95/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000095_0: Committed
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Starting task 96.0 in stage 3.0 (TID 99, localhost, executor driver, partition 96, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98) in 77 ms on localhost (executor driver) (96/200)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Running task 96.0 in stage 3.0 (TID 99)
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140407_0003_m_000096_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 97.0 in stage 3.0 (TID 100, localhost, executor driver, partition 97, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 97.0 in stage 3.0 (TID 100)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99) in 282 ms on localhost (executor driver) (97/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000097_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 98.0 in stage 3.0 (TID 101, localhost, executor driver, partition 98, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 98.0 in stage 3.0 (TID 101)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100) in 133 ms on localhost (executor driver) (98/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000098_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 99.0 in stage 3.0 (TID 102, localhost, executor driver, partition 99, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 99.0 in stage 3.0 (TID 102)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101) in 99 ms on localhost (executor driver) (99/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000099_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 100.0 in stage 3.0 (TID 103, localhost, executor driver, partition 100, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 100.0 in stage 3.0 (TID 103)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102) in 140 ms on localhost (executor driver) (100/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000100_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 101.0 in stage 3.0 (TID 104, localhost, executor driver, partition 101, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 101.0 in stage 3.0 (TID 104)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103) in 78 ms on localhost (executor driver) (101/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000101_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 102.0 in stage 3.0 (TID 105, localhost, executor driver, partition 102, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 102.0 in stage 3.0 (TID 105)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104) in 105 ms on localhost (executor driver) (102/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000102_0: Committed
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Starting task 103.0 in stage 3.0 (TID 106, localhost, executor driver, partition 103, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Running task 103.0 in stage 3.0 (TID 106)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105) in 147 ms on localhost (executor driver) (103/200)
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140408_0003_m_000103_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 104.0 in stage 3.0 (TID 107, localhost, executor driver, partition 104, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 104.0 in stage 3.0 (TID 107)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106) in 88 ms on localhost (executor driver) (104/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000104_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 105.0 in stage 3.0 (TID 108, localhost, executor driver, partition 105, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 105.0 in stage 3.0 (TID 108)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107) in 167 ms on localhost (executor driver) (105/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000105_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 106.0 in stage 3.0 (TID 109, localhost, executor driver, partition 106, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 106.0 in stage 3.0 (TID 109)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108) in 121 ms on localhost (executor driver) (106/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000106_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 107.0 in stage 3.0 (TID 110, localhost, executor driver, partition 107, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 107.0 in stage 3.0 (TID 110)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109) in 90 ms on localhost (executor driver) (107/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000107_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 108.0 in stage 3.0 (TID 111, localhost, executor driver, partition 108, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 108.0 in stage 3.0 (TID 111)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110) in 88 ms on localhost (executor driver) (108/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000108_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 109.0 in stage 3.0 (TID 112, localhost, executor driver, partition 109, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 109.0 in stage 3.0 (TID 112)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111) in 97 ms on localhost (executor driver) (109/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000109_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 110.0 in stage 3.0 (TID 113, localhost, executor driver, partition 110, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 110.0 in stage 3.0 (TID 113)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112) in 104 ms on localhost (executor driver) (110/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000110_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 111.0 in stage 3.0 (TID 114, localhost, executor driver, partition 111, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 111.0 in stage 3.0 (TID 114)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113) in 102 ms on localhost (executor driver) (111/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000111_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 112.0 in stage 3.0 (TID 115, localhost, executor driver, partition 112, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 112.0 in stage 3.0 (TID 115)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114) in 84 ms on localhost (executor driver) (112/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000112_0: Committed
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Starting task 113.0 in stage 3.0 (TID 116, localhost, executor driver, partition 113, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Running task 113.0 in stage 3.0 (TID 116)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115) in 104 ms on localhost (executor driver) (113/200)
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140409_0003_m_000113_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 114.0 in stage 3.0 (TID 117, localhost, executor driver, partition 114, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 114.0 in stage 3.0 (TID 117)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116) in 127 ms on localhost (executor driver) (114/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000114_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 115.0 in stage 3.0 (TID 118, localhost, executor driver, partition 115, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 115.0 in stage 3.0 (TID 118)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117) in 176 ms on localhost (executor driver) (115/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000115_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 116.0 in stage 3.0 (TID 119, localhost, executor driver, partition 116, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 116.0 in stage 3.0 (TID 119)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118) in 192 ms on localhost (executor driver) (116/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000116_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 117.0 in stage 3.0 (TID 120, localhost, executor driver, partition 117, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 117.0 in stage 3.0 (TID 120)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119) in 102 ms on localhost (executor driver) (117/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000117_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 118.0 in stage 3.0 (TID 121, localhost, executor driver, partition 118, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 118.0 in stage 3.0 (TID 121)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120) in 91 ms on localhost (executor driver) (118/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000118_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 119.0 in stage 3.0 (TID 122, localhost, executor driver, partition 119, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 119.0 in stage 3.0 (TID 122)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121) in 66 ms on localhost (executor driver) (119/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000119_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 120.0 in stage 3.0 (TID 123, localhost, executor driver, partition 120, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 120.0 in stage 3.0 (TID 123)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122) in 70 ms on localhost (executor driver) (120/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000120_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 121.0 in stage 3.0 (TID 124, localhost, executor driver, partition 121, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 121.0 in stage 3.0 (TID 124)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123) in 67 ms on localhost (executor driver) (121/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000121_0: Committed
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Starting task 122.0 in stage 3.0 (TID 125, localhost, executor driver, partition 122, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Running task 122.0 in stage 3.0 (TID 125)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124) in 92 ms on localhost (executor driver) (122/200)
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140410_0003_m_000122_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 123.0 in stage 3.0 (TID 126, localhost, executor driver, partition 123, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 123.0 in stage 3.0 (TID 126)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125) in 74 ms on localhost (executor driver) (123/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000123_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 124.0 in stage 3.0 (TID 127, localhost, executor driver, partition 124, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 124.0 in stage 3.0 (TID 127)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126) in 52 ms on localhost (executor driver) (124/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000124_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 125.0 in stage 3.0 (TID 128, localhost, executor driver, partition 125, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 125.0 in stage 3.0 (TID 128)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127) in 87 ms on localhost (executor driver) (125/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000125_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 126.0 in stage 3.0 (TID 129, localhost, executor driver, partition 126, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 126.0 in stage 3.0 (TID 129)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128) in 63 ms on localhost (executor driver) (126/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000126_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 127.0 in stage 3.0 (TID 130, localhost, executor driver, partition 127, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 127.0 in stage 3.0 (TID 130)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129) in 77 ms on localhost (executor driver) (127/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000127_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 128.0 in stage 3.0 (TID 131, localhost, executor driver, partition 128, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 128.0 in stage 3.0 (TID 131)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130) in 79 ms on localhost (executor driver) (128/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000128_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 129.0 in stage 3.0 (TID 132, localhost, executor driver, partition 129, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 129.0 in stage 3.0 (TID 132)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131) in 49 ms on localhost (executor driver) (129/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000129_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 130.0 in stage 3.0 (TID 133, localhost, executor driver, partition 130, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 130.0 in stage 3.0 (TID 133)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132) in 74 ms on localhost (executor driver) (130/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000130_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 131.0 in stage 3.0 (TID 134, localhost, executor driver, partition 131, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 131.0 in stage 3.0 (TID 134)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133) in 127 ms on localhost (executor driver) (131/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000131_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 132.0 in stage 3.0 (TID 135, localhost, executor driver, partition 132, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134) in 94 ms on localhost (executor driver) (132/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 132.0 in stage 3.0 (TID 135)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000132_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 133.0 in stage 3.0 (TID 136, localhost, executor driver, partition 133, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 133.0 in stage 3.0 (TID 136)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135) in 116 ms on localhost (executor driver) (133/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000133_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 134.0 in stage 3.0 (TID 137, localhost, executor driver, partition 134, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 134.0 in stage 3.0 (TID 137)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136) in 48 ms on localhost (executor driver) (134/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000134_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 135.0 in stage 3.0 (TID 138, localhost, executor driver, partition 135, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 135.0 in stage 3.0 (TID 138)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137) in 70 ms on localhost (executor driver) (135/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000135_0: Committed
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Starting task 136.0 in stage 3.0 (TID 139, localhost, executor driver, partition 136, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Running task 136.0 in stage 3.0 (TID 139)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138) in 46 ms on localhost (executor driver) (136/200)
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140411_0003_m_000136_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 137.0 in stage 3.0 (TID 140, localhost, executor driver, partition 137, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 137.0 in stage 3.0 (TID 140)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139) in 113 ms on localhost (executor driver) (137/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000137_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 138.0 in stage 3.0 (TID 141, localhost, executor driver, partition 138, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 138.0 in stage 3.0 (TID 141)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140) in 81 ms on localhost (executor driver) (138/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000138_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 139.0 in stage 3.0 (TID 142, localhost, executor driver, partition 139, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 139.0 in stage 3.0 (TID 142)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141) in 81 ms on localhost (executor driver) (139/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000139_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 140.0 in stage 3.0 (TID 143, localhost, executor driver, partition 140, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 140.0 in stage 3.0 (TID 143)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142) in 49 ms on localhost (executor driver) (140/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000140_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 141.0 in stage 3.0 (TID 144, localhost, executor driver, partition 141, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143) in 74 ms on localhost (executor driver) (141/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 141.0 in stage 3.0 (TID 144)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000141_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 142.0 in stage 3.0 (TID 145, localhost, executor driver, partition 142, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144) in 171 ms on localhost (executor driver) (142/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 142.0 in stage 3.0 (TID 145)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000142_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 143.0 in stage 3.0 (TID 146, localhost, executor driver, partition 143, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 143.0 in stage 3.0 (TID 146)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145) in 57 ms on localhost (executor driver) (143/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000143_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 144.0 in stage 3.0 (TID 147, localhost, executor driver, partition 144, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 144.0 in stage 3.0 (TID 147)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146) in 57 ms on localhost (executor driver) (144/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000144_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 145.0 in stage 3.0 (TID 148, localhost, executor driver, partition 145, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 145.0 in stage 3.0 (TID 148)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147) in 60 ms on localhost (executor driver) (145/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000145_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 146.0 in stage 3.0 (TID 149, localhost, executor driver, partition 146, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 146.0 in stage 3.0 (TID 149)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148) in 93 ms on localhost (executor driver) (146/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000146_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 147.0 in stage 3.0 (TID 150, localhost, executor driver, partition 147, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 147.0 in stage 3.0 (TID 150)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149) in 100 ms on localhost (executor driver) (147/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000147_0: Committed
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Starting task 148.0 in stage 3.0 (TID 151, localhost, executor driver, partition 148, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Running task 148.0 in stage 3.0 (TID 151)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150) in 46 ms on localhost (executor driver) (148/200)
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140412_0003_m_000148_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 149.0 in stage 3.0 (TID 152, localhost, executor driver, partition 149, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 149.0 in stage 3.0 (TID 152)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151) in 110 ms on localhost (executor driver) (149/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000149_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 150.0 in stage 3.0 (TID 153, localhost, executor driver, partition 150, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 150.0 in stage 3.0 (TID 153)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152) in 75 ms on localhost (executor driver) (150/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000150_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 151.0 in stage 3.0 (TID 154, localhost, executor driver, partition 151, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 151.0 in stage 3.0 (TID 154)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153) in 206 ms on localhost (executor driver) (151/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000151_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 152.0 in stage 3.0 (TID 155, localhost, executor driver, partition 152, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 152.0 in stage 3.0 (TID 155)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154) in 82 ms on localhost (executor driver) (152/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000152_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 153.0 in stage 3.0 (TID 156, localhost, executor driver, partition 153, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155) in 47 ms on localhost (executor driver) (153/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 153.0 in stage 3.0 (TID 156)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000153_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 154.0 in stage 3.0 (TID 157, localhost, executor driver, partition 154, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 154.0 in stage 3.0 (TID 157)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156) in 81 ms on localhost (executor driver) (154/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000154_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 155.0 in stage 3.0 (TID 158, localhost, executor driver, partition 155, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 155.0 in stage 3.0 (TID 158)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157) in 128 ms on localhost (executor driver) (155/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000155_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 156.0 in stage 3.0 (TID 159, localhost, executor driver, partition 156, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 156.0 in stage 3.0 (TID 159)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158) in 50 ms on localhost (executor driver) (156/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000156_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 157.0 in stage 3.0 (TID 160, localhost, executor driver, partition 157, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 157.0 in stage 3.0 (TID 160)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159) in 111 ms on localhost (executor driver) (157/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000157_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 158.0 in stage 3.0 (TID 161, localhost, executor driver, partition 158, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 158.0 in stage 3.0 (TID 161)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160) in 88 ms on localhost (executor driver) (158/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000158_0: Committed
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Starting task 159.0 in stage 3.0 (TID 162, localhost, executor driver, partition 159, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Running task 159.0 in stage 3.0 (TID 162)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161) in 44 ms on localhost (executor driver) (159/200)
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140413_0003_m_000159_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 160.0 in stage 3.0 (TID 163, localhost, executor driver, partition 160, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 160.0 in stage 3.0 (TID 163)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162) in 44 ms on localhost (executor driver) (160/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000160_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 161.0 in stage 3.0 (TID 164, localhost, executor driver, partition 161, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 161.0 in stage 3.0 (TID 164)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163) in 45 ms on localhost (executor driver) (161/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000161_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 162.0 in stage 3.0 (TID 165, localhost, executor driver, partition 162, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 162.0 in stage 3.0 (TID 165)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164) in 73 ms on localhost (executor driver) (162/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000162_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 163.0 in stage 3.0 (TID 166, localhost, executor driver, partition 163, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 163.0 in stage 3.0 (TID 166)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165) in 79 ms on localhost (executor driver) (163/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000163_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 164.0 in stage 3.0 (TID 167, localhost, executor driver, partition 164, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 164.0 in stage 3.0 (TID 167)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166) in 93 ms on localhost (executor driver) (164/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000164_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 165.0 in stage 3.0 (TID 168, localhost, executor driver, partition 165, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 165.0 in stage 3.0 (TID 168)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167) in 90 ms on localhost (executor driver) (165/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000165_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 166.0 in stage 3.0 (TID 169, localhost, executor driver, partition 166, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 166.0 in stage 3.0 (TID 169)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168) in 154 ms on localhost (executor driver) (166/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000166_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 167.0 in stage 3.0 (TID 170, localhost, executor driver, partition 167, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 167.0 in stage 3.0 (TID 170)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169) in 151 ms on localhost (executor driver) (167/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000167_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 168.0 in stage 3.0 (TID 171, localhost, executor driver, partition 168, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 168.0 in stage 3.0 (TID 171)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170) in 71 ms on localhost (executor driver) (168/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000168_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 169.0 in stage 3.0 (TID 172, localhost, executor driver, partition 169, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 169.0 in stage 3.0 (TID 172)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171) in 91 ms on localhost (executor driver) (169/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000169_0: Committed
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Starting task 170.0 in stage 3.0 (TID 173, localhost, executor driver, partition 170, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Running task 170.0 in stage 3.0 (TID 173)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172) in 69 ms on localhost (executor driver) (170/200)
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140414_0003_m_000170_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 171.0 in stage 3.0 (TID 174, localhost, executor driver, partition 171, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173) in 174 ms on localhost (executor driver) (171/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 171.0 in stage 3.0 (TID 174)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000171_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 172.0 in stage 3.0 (TID 175, localhost, executor driver, partition 172, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 172.0 in stage 3.0 (TID 175)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174) in 65 ms on localhost (executor driver) (172/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000172_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 173.0 in stage 3.0 (TID 176, localhost, executor driver, partition 173, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 173.0 in stage 3.0 (TID 176)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175) in 60 ms on localhost (executor driver) (173/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000173_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 174.0 in stage 3.0 (TID 177, localhost, executor driver, partition 174, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176) in 75 ms on localhost (executor driver) (174/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 174.0 in stage 3.0 (TID 177)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000174_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 175.0 in stage 3.0 (TID 178, localhost, executor driver, partition 175, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 175.0 in stage 3.0 (TID 178)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177) in 93 ms on localhost (executor driver) (175/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000175_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 176.0 in stage 3.0 (TID 179, localhost, executor driver, partition 176, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 176.0 in stage 3.0 (TID 179)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178) in 45 ms on localhost (executor driver) (176/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000176_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 177.0 in stage 3.0 (TID 180, localhost, executor driver, partition 177, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 177.0 in stage 3.0 (TID 180)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179) in 44 ms on localhost (executor driver) (177/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000177_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 178.0 in stage 3.0 (TID 181, localhost, executor driver, partition 178, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180) in 44 ms on localhost (executor driver) (178/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 178.0 in stage 3.0 (TID 181)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000178_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 179.0 in stage 3.0 (TID 182, localhost, executor driver, partition 179, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 179.0 in stage 3.0 (TID 182)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181) in 80 ms on localhost (executor driver) (179/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000179_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 180.0 in stage 3.0 (TID 183, localhost, executor driver, partition 180, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 180.0 in stage 3.0 (TID 183)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182) in 73 ms on localhost (executor driver) (180/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000180_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 181.0 in stage 3.0 (TID 184, localhost, executor driver, partition 181, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 181.0 in stage 3.0 (TID 184)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183) in 72 ms on localhost (executor driver) (181/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000181_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 182.0 in stage 3.0 (TID 185, localhost, executor driver, partition 182, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 182.0 in stage 3.0 (TID 185)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184) in 50 ms on localhost (executor driver) (182/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000182_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 183.0 in stage 3.0 (TID 186, localhost, executor driver, partition 183, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 183.0 in stage 3.0 (TID 186)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185) in 84 ms on localhost (executor driver) (183/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000183_0: Committed
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Starting task 184.0 in stage 3.0 (TID 187, localhost, executor driver, partition 184, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Running task 184.0 in stage 3.0 (TID 187)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186) in 63 ms on localhost (executor driver) (184/200)
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140415_0003_m_000184_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 185.0 in stage 3.0 (TID 188, localhost, executor driver, partition 185, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 185.0 in stage 3.0 (TID 188)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187) in 104 ms on localhost (executor driver) (185/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000185_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 186.0 in stage 3.0 (TID 189, localhost, executor driver, partition 186, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 186.0 in stage 3.0 (TID 189)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188) in 67 ms on localhost (executor driver) (186/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000186_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 187.0 in stage 3.0 (TID 190, localhost, executor driver, partition 187, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 187.0 in stage 3.0 (TID 190)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189) in 45 ms on localhost (executor driver) (187/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000187_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 188.0 in stage 3.0 (TID 191, localhost, executor driver, partition 188, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 188.0 in stage 3.0 (TID 191)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190) in 113 ms on localhost (executor driver) (188/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000188_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 189.0 in stage 3.0 (TID 192, localhost, executor driver, partition 189, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 189.0 in stage 3.0 (TID 192)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191) in 78 ms on localhost (executor driver) (189/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000189_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 190.0 in stage 3.0 (TID 193, localhost, executor driver, partition 190, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 190.0 in stage 3.0 (TID 193)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192) in 77 ms on localhost (executor driver) (190/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000190_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 191.0 in stage 3.0 (TID 194, localhost, executor driver, partition 191, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 191.0 in stage 3.0 (TID 194)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193) in 94 ms on localhost (executor driver) (191/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000191_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 192.0 in stage 3.0 (TID 195, localhost, executor driver, partition 192, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 192.0 in stage 3.0 (TID 195)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194) in 117 ms on localhost (executor driver) (192/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000192_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 193.0 in stage 3.0 (TID 196, localhost, executor driver, partition 193, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 193.0 in stage 3.0 (TID 196)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195) in 48 ms on localhost (executor driver) (193/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000193_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 194.0 in stage 3.0 (TID 197, localhost, executor driver, partition 194, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 194.0 in stage 3.0 (TID 197)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196) in 107 ms on localhost (executor driver) (194/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000194_0: Committed
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Starting task 195.0 in stage 3.0 (TID 198, localhost, executor driver, partition 195, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Running task 195.0 in stage 3.0 (TID 198)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197) in 112 ms on localhost (executor driver) (195/200)
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] attempt_20180428140416_0003_m_000195_0: Committed
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Starting task 196.0 in stage 3.0 (TID 199, localhost, executor driver, partition 196, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Running task 196.0 in stage 3.0 (TID 199)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198) in 111 ms on localhost (executor driver) (196/200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] attempt_20180428140417_0003_m_000196_0: Committed
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199) in 96 ms on localhost (executor driver) (197/200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Starting task 197.0 in stage 3.0 (TID 200, localhost, executor driver, partition 197, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Running task 197.0 in stage 3.0 (TID 200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] attempt_20180428140417_0003_m_000197_0: Committed
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Starting task 198.0 in stage 3.0 (TID 201, localhost, executor driver, partition 198, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200) in 89 ms on localhost (executor driver) (198/200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Running task 198.0 in stage 3.0 (TID 201)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] attempt_20180428140417_0003_m_000198_0: Committed
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Starting task 199.0 in stage 3.0 (TID 202, localhost, executor driver, partition 199, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Running task 199.0 in stage 3.0 (TID 202)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201) in 44 ms on localhost (executor driver) (199/200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] attempt_20180428140417_0003_m_000199_0: Committed
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202) in 36 ms on localhost (executor driver) (200/200)
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Removed TaskSet 3.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:121) finished in 21.459 s
[INFO ] [2018-04-28 14:04:17] [Logging$class:logInfo:54] Job 1 finished: saveAsTable at HistoryDataToA_DateRange.scala:121, took 26.042052 s
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 14:04:23] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-1fba5c53-6716-4001-9d19-1a1b1540baed
[INFO ] [2018-04-28 14:20:39] [Logging$class:logInfo:54] Running Spark version 2.2.1
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Submitted application: anda_etl_pos_history_job
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Changing view acls to: SAM
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Changing modify acls to: SAM
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Changing view acls groups to: 
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Changing modify acls groups to: 
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(SAM); groups with view permissions: Set(); users  with modify permissions: Set(SAM); groups with modify permissions: Set()
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Successfully started service 'sparkDriver' on port 62965.
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Registering MapOutputTracker
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Registering BlockManagerMaster
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] BlockManagerMasterEndpoint up
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Created local directory at C:\Users\SAM\AppData\Local\Temp\blockmgr-839948ad-761f-4e2d-8a16-4d1d72e5a2c6
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] MemoryStore started with capacity 1992.0 MB
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Registering OutputCommitCoordinator
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Successfully started service 'SparkUI' on port 4040.
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Bound SparkUI to 0.0.0.0, and started at http://192.168.0.152:4040
[INFO ] [2018-04-28 14:20:40] [Logging$class:logInfo:54] Starting executor ID driver on host localhost
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 62974.
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Server created on 192.168.0.152:62974
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Registering BlockManager BlockManagerId(driver, 192.168.0.152, 62974, None)
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Registering block manager 192.168.0.152:62974 with 1992.0 MB RAM, BlockManagerId(driver, 192.168.0.152, 62974, None)
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Registered BlockManager BlockManagerId(driver, 192.168.0.152, 62974, None)
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Initialized BlockManager: BlockManagerId(driver, 192.168.0.152, 62974, None)
[INFO ] [2018-04-28 14:20:41] [Logging$class:logInfo:54] Block broadcast_0 stored as values in memory (estimated size 214.5 KB, free 1991.8 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.8 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_0_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 0 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_1 stored as values in memory (estimated size 214.6 KB, free 1991.6 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_1_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.5 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_1_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 1 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_2 stored as values in memory (estimated size 214.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_2_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_2_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 2 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_3 stored as values in memory (estimated size 214.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_3_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1991.1 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_3_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 3 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_4 stored as values in memory (estimated size 214.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_4_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_4_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 4 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_5 stored as values in memory (estimated size 214.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Block broadcast_5_piece0 stored as bytes in memory (estimated size 20.6 KB, free 1990.6 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Added broadcast_5_piece0 in memory on 192.168.0.152:62974 (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Created broadcast 5 from hadoopFile at LoadDataUtil.scala:25
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Removed broadcast_3_piece0 on 192.168.0.152:62974 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Removed broadcast_0_piece0 on 192.168.0.152:62974 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Removed broadcast_1_piece0 on 192.168.0.152:62974 in memory (size: 20.6 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:42] [Logging$class:logInfo:54] Removed broadcast_2_piece0 on 192.168.0.152:62974 in memory (size: 20.6 KB, free: 1992.0 MB)
[INFO ] [2018-04-28 14:20:43] [Logging$class:logInfo:54] loading hive config file: file:/D:/IdeaProjects/hg_etl_pos_daily/target/classes/hive-site.xml
[INFO ] [2018-04-28 14:20:43] [Logging$class:logInfo:54] Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse').
[INFO ] [2018-04-28 14:20:43] [Logging$class:logInfo:54] Warehouse path is 'file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse'.
[INFO ] [2018-04-28 14:20:44] [Logging$class:logInfo:54] Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
[INFO ] [2018-04-28 14:20:48] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 14:20:48] [Logging$class:logInfo:54] Warehouse location for Hive client (version 1.2.1) is file:/D:/IdeaProjects/hg_etl_pos_daily/spark-warehouse
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Registered StateStoreCoordinator endpoint
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: ba_model.dim_gid_drid_rel
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: array<string>
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: banner_code='R10003'
[INFO ] [2018-04-28 14:20:49] [Logging$class:logInfo:54] Parsing command: ba_model.original_sale_detail
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:50] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: bigint
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: float
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: string
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Parsing command: int
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:20:55] [Logging$class:logInfo:54] Code generated in 263.586986 ms
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_6 stored as values in memory (estimated size 224.7 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_6_piece0 stored as bytes in memory (estimated size 21.5 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Added broadcast_6_piece0 in memory on 192.168.0.152:62974 (size: 21.5 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Created broadcast 6 from 
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Starting job: run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Got job 0 (run at ThreadPoolExecutor.java:1149) with 1 output partitions
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Final stage: ResultStage 0 (run at ThreadPoolExecutor.java:1149)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Parents of final stage: List()
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Missing parents: List()
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Submitting ResultStage 0 (MapPartitionsRDD[29] at run at ThreadPoolExecutor.java:1149), which has no missing parents
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_7 stored as values in memory (estimated size 12.3 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_7_piece0 stored as bytes in memory (estimated size 6.1 KB, free 1991.3 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Added broadcast_7_piece0 in memory on 192.168.0.152:62974 (size: 6.1 KB, free: 1991.9 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Created broadcast 7 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[29] at run at ThreadPoolExecutor.java:1149) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Adding task set 0.0 with 1 tasks
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, ANY, 4902 bytes)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Running task 0.0 in stage 0.0 (TID 0)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/user/hive/warehouse/ba_model.db/dim_gid_drid_rel/000000_0:0+2843378
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Code generated in 13.899152 ms
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0). 218615 bytes result sent to driver
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Finished task 0.0 in stage 0.0 (TID 0) in 399 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Removed TaskSet 0.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] ResultStage 0 (run at ThreadPoolExecutor.java:1149) finished in 0.413 s
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Job 0 finished: run at ThreadPoolExecutor.java:1149, took 0.489831 s
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Code generated in 10.370652 ms
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_8 stored as values in memory (estimated size 64.5 MB, free 1926.8 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Block broadcast_8_piece0 stored as bytes in memory (estimated size 337.8 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Added broadcast_8_piece0 in memory on 192.168.0.152:62974 (size: 337.8 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Created broadcast 8 from run at ThreadPoolExecutor.java:1149
[INFO ] [2018-04-28 14:20:56] [Logging$class:logInfo:54] Code generated in 30.55276 ms
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Code generated in 15.58241 ms
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Removed broadcast_7_piece0 on 192.168.0.152:62974 in memory (size: 6.1 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Starting job: saveAsTable at HistoryDataToA_DateRange.scala:114
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Registering RDD 35 (saveAsTable at HistoryDataToA_DateRange.scala:114)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Registering RDD 31 (saveAsTable at HistoryDataToA_DateRange.scala:114)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Got job 1 (saveAsTable at HistoryDataToA_DateRange.scala:114) with 200 output partitions
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Final stage: ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:114)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Parents of final stage: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Missing parents: List(ShuffleMapStage 1, ShuffleMapStage 2)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Submitting ShuffleMapStage 1 (MapPartitionsRDD[35] at saveAsTable at HistoryDataToA_DateRange.scala:114), which has no missing parents
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Block broadcast_9 stored as values in memory (estimated size 12.3 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Block broadcast_9_piece0 stored as bytes in memory (estimated size 6.4 KB, free 1926.5 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Added broadcast_9_piece0 in memory on 192.168.0.152:62974 (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Created broadcast 9 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[35] at saveAsTable at HistoryDataToA_DateRange.scala:114) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Adding task set 1.0 with 1 tasks
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Submitting ShuffleMapStage 2 (MapPartitionsRDD[31] at saveAsTable at HistoryDataToA_DateRange.scala:114), which has no missing parents
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Starting task 0.0 in stage 1.0 (TID 1, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Running task 0.0 in stage 1.0 (TID 1)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Block broadcast_10 stored as values in memory (estimated size 16.8 KB, free 1926.4 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Block broadcast_10_piece0 stored as bytes in memory (estimated size 7.4 KB, free 1926.4 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Added broadcast_10_piece0 in memory on 192.168.0.152:62974 (size: 7.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Created broadcast 10 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Submitting 1 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[31] at saveAsTable at HistoryDataToA_DateRange.scala:114) (first 15 tasks are for partitions Vector(0))
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Adding task set 2.0 with 1 tasks
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/金额流水2018.04.25.txt:0+3194310
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Code generated in 9.282085 ms
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Code generated in 15.732687 ms
[INFO ] [2018-04-28 14:20:57] [Logging$class:logInfo:54] Code generated in 39.687589 ms
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1). 1539 bytes result sent to driver
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Starting task 0.0 in stage 2.0 (TID 2, localhost, executor driver, partition 0, ANY, 4891 bytes)
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Running task 0.0 in stage 2.0 (TID 2)
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Finished task 0.0 in stage 1.0 (TID 1) in 1411 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Removed TaskSet 1.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] ShuffleMapStage 1 (saveAsTable at HistoryDataToA_DateRange.scala:114) finished in 1.414 s
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] running: Set(ShuffleMapStage 2)
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Input split: hdfs://192.168.0.151:9000/usr/samgao/input/anda/20180425/实物流水2018.04.25.txt:0+8982999
[INFO ] [2018-04-28 14:20:58] [Logging$class:logInfo:54] Code generated in 44.613895 ms
[INFO ] [2018-04-28 14:20:59] [Logging$class:logInfo:54] Code generated in 121.760587 ms
[INFO ] [2018-04-28 14:20:59] [Logging$class:logInfo:54] Removed broadcast_9_piece0 on 192.168.0.152:62974 in memory (size: 6.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2). 1582 bytes result sent to driver
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Finished task 0.0 in stage 2.0 (TID 2) in 3183 ms on localhost (executor driver) (1/1)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] ShuffleMapStage 2 (saveAsTable at HistoryDataToA_DateRange.scala:114) finished in 4.576 s
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] looking for newly runnable stages
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] running: Set()
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] waiting: Set(ResultStage 3)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] failed: Set()
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Submitting ResultStage 3 (MapPartitionsRDD[40] at saveAsTable at HistoryDataToA_DateRange.scala:114), which has no missing parents
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Removed TaskSet 2.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Block broadcast_11 stored as values in memory (estimated size 114.2 KB, free 1926.3 MB)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Block broadcast_11_piece0 stored as bytes in memory (estimated size 43.4 KB, free 1926.3 MB)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Added broadcast_11_piece0 in memory on 192.168.0.152:62974 (size: 43.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Created broadcast 11 from broadcast at DAGScheduler.scala:1006
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Submitting 200 missing tasks from ResultStage 3 (MapPartitionsRDD[40] at saveAsTable at HistoryDataToA_DateRange.scala:114) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14))
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Adding task set 3.0 with 200 tasks
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Starting task 0.0 in stage 3.0 (TID 3, localhost, executor driver, partition 0, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:01] [Logging$class:logInfo:54] Running task 0.0 in stage 3.0 (TID 3)
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Started 0 remote fetches in 7 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 14.435318 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 10.839609 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 11.62309 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 8.66625 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Removed broadcast_10_piece0 on 192.168.0.152:62974 in memory (size: 7.4 KB, free: 1991.6 MB)
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 6.947876 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 7.398709 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 6.754177 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 20.491347 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Code generated in 9.21903 ms
[INFO ] [2018-04-28 14:21:02] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142102_0003_m_000000_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3). 3814 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 1.0 in stage 3.0 (TID 4, localhost, executor driver, partition 1, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 1.0 in stage 3.0 (TID 4)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 0.0 in stage 3.0 (TID 3) in 1110 ms on localhost (executor driver) (1/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000001_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 2.0 in stage 3.0 (TID 5, localhost, executor driver, partition 2, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 2.0 in stage 3.0 (TID 5)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 1.0 in stage 3.0 (TID 4) in 164 ms on localhost (executor driver) (2/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000002_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 3.0 in stage 3.0 (TID 6, localhost, executor driver, partition 3, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 2.0 in stage 3.0 (TID 5) in 198 ms on localhost (executor driver) (3/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 3.0 in stage 3.0 (TID 6)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000003_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 4.0 in stage 3.0 (TID 7, localhost, executor driver, partition 4, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 3.0 in stage 3.0 (TID 6) in 127 ms on localhost (executor driver) (4/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 4.0 in stage 3.0 (TID 7)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 2 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000004_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 5.0 in stage 3.0 (TID 8, localhost, executor driver, partition 5, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 4.0 in stage 3.0 (TID 7) in 210 ms on localhost (executor driver) (5/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 5.0 in stage 3.0 (TID 8)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000005_0: Committed
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Starting task 6.0 in stage 3.0 (TID 9, localhost, executor driver, partition 6, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Finished task 5.0 in stage 3.0 (TID 8) in 184 ms on localhost (executor driver) (6/200)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Running task 6.0 in stage 3.0 (TID 9)
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:03] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142103_0003_m_000006_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 7.0 in stage 3.0 (TID 10, localhost, executor driver, partition 7, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 7.0 in stage 3.0 (TID 10)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 6.0 in stage 3.0 (TID 9) in 157 ms on localhost (executor driver) (7/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000007_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 8.0 in stage 3.0 (TID 11, localhost, executor driver, partition 8, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 8.0 in stage 3.0 (TID 11)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 7.0 in stage 3.0 (TID 10) in 167 ms on localhost (executor driver) (8/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000008_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 9.0 in stage 3.0 (TID 12, localhost, executor driver, partition 9, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 8.0 in stage 3.0 (TID 11) in 102 ms on localhost (executor driver) (9/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 9.0 in stage 3.0 (TID 12)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000009_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 10.0 in stage 3.0 (TID 13, localhost, executor driver, partition 10, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 9.0 in stage 3.0 (TID 12) in 73 ms on localhost (executor driver) (10/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 10.0 in stage 3.0 (TID 13)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000010_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 11.0 in stage 3.0 (TID 14, localhost, executor driver, partition 11, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 10.0 in stage 3.0 (TID 13) in 91 ms on localhost (executor driver) (11/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 11.0 in stage 3.0 (TID 14)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000011_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 12.0 in stage 3.0 (TID 15, localhost, executor driver, partition 12, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 12.0 in stage 3.0 (TID 15)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 11.0 in stage 3.0 (TID 14) in 116 ms on localhost (executor driver) (12/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000012_0: Committed
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Starting task 13.0 in stage 3.0 (TID 16, localhost, executor driver, partition 13, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Finished task 12.0 in stage 3.0 (TID 15) in 158 ms on localhost (executor driver) (13/200)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Running task 13.0 in stage 3.0 (TID 16)
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:04] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142104_0003_m_000013_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 14.0 in stage 3.0 (TID 17, localhost, executor driver, partition 14, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 14.0 in stage 3.0 (TID 17)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 13.0 in stage 3.0 (TID 16) in 298 ms on localhost (executor driver) (14/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000014_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 15.0 in stage 3.0 (TID 18, localhost, executor driver, partition 15, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 15.0 in stage 3.0 (TID 18)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 14.0 in stage 3.0 (TID 17) in 156 ms on localhost (executor driver) (15/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000015_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 16.0 in stage 3.0 (TID 19, localhost, executor driver, partition 16, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 16.0 in stage 3.0 (TID 19)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 15.0 in stage 3.0 (TID 18) in 97 ms on localhost (executor driver) (16/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000016_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 17.0 in stage 3.0 (TID 20, localhost, executor driver, partition 17, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 17.0 in stage 3.0 (TID 20)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 16.0 in stage 3.0 (TID 19) in 72 ms on localhost (executor driver) (17/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000017_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 18.0 in stage 3.0 (TID 21, localhost, executor driver, partition 18, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 18.0 in stage 3.0 (TID 21)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 17.0 in stage 3.0 (TID 20) in 79 ms on localhost (executor driver) (18/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000018_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 19.0 in stage 3.0 (TID 22, localhost, executor driver, partition 19, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 19.0 in stage 3.0 (TID 22)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 18.0 in stage 3.0 (TID 21) in 121 ms on localhost (executor driver) (19/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000019_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 20.0 in stage 3.0 (TID 23, localhost, executor driver, partition 20, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 20.0 in stage 3.0 (TID 23)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 19.0 in stage 3.0 (TID 22) in 144 ms on localhost (executor driver) (20/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000020_0: Committed
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Starting task 21.0 in stage 3.0 (TID 24, localhost, executor driver, partition 21, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Finished task 20.0 in stage 3.0 (TID 23) in 182 ms on localhost (executor driver) (21/200)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Running task 21.0 in stage 3.0 (TID 24)
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:05] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142105_0003_m_000021_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 22.0 in stage 3.0 (TID 25, localhost, executor driver, partition 22, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 22.0 in stage 3.0 (TID 25)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 21.0 in stage 3.0 (TID 24) in 157 ms on localhost (executor driver) (22/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000022_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 23.0 in stage 3.0 (TID 26, localhost, executor driver, partition 23, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 23.0 in stage 3.0 (TID 26)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 22.0 in stage 3.0 (TID 25) in 127 ms on localhost (executor driver) (23/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000023_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 24.0 in stage 3.0 (TID 27, localhost, executor driver, partition 24, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 23.0 in stage 3.0 (TID 26) in 155 ms on localhost (executor driver) (24/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 24.0 in stage 3.0 (TID 27)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000024_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 25.0 in stage 3.0 (TID 28, localhost, executor driver, partition 25, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 25.0 in stage 3.0 (TID 28)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 24.0 in stage 3.0 (TID 27) in 114 ms on localhost (executor driver) (25/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000025_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 26.0 in stage 3.0 (TID 29, localhost, executor driver, partition 26, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 26.0 in stage 3.0 (TID 29)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 25.0 in stage 3.0 (TID 28) in 101 ms on localhost (executor driver) (26/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000026_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 27.0 in stage 3.0 (TID 30, localhost, executor driver, partition 27, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 27.0 in stage 3.0 (TID 30)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 26.0 in stage 3.0 (TID 29) in 125 ms on localhost (executor driver) (27/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000027_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 28.0 in stage 3.0 (TID 31, localhost, executor driver, partition 28, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 27.0 in stage 3.0 (TID 30) in 81 ms on localhost (executor driver) (28/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 28.0 in stage 3.0 (TID 31)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000028_0: Committed
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Starting task 29.0 in stage 3.0 (TID 32, localhost, executor driver, partition 29, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Running task 29.0 in stage 3.0 (TID 32)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Finished task 28.0 in stage 3.0 (TID 31) in 104 ms on localhost (executor driver) (29/200)
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:06] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142106_0003_m_000029_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 30.0 in stage 3.0 (TID 33, localhost, executor driver, partition 30, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 29.0 in stage 3.0 (TID 32) in 159 ms on localhost (executor driver) (30/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 30.0 in stage 3.0 (TID 33)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000030_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 31.0 in stage 3.0 (TID 34, localhost, executor driver, partition 31, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 30.0 in stage 3.0 (TID 33) in 53 ms on localhost (executor driver) (31/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 31.0 in stage 3.0 (TID 34)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000031_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 32.0 in stage 3.0 (TID 35, localhost, executor driver, partition 32, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 31.0 in stage 3.0 (TID 34) in 160 ms on localhost (executor driver) (32/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 32.0 in stage 3.0 (TID 35)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000032_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 33.0 in stage 3.0 (TID 36, localhost, executor driver, partition 33, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 33.0 in stage 3.0 (TID 36)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 32.0 in stage 3.0 (TID 35) in 167 ms on localhost (executor driver) (33/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000033_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 34.0 in stage 3.0 (TID 37, localhost, executor driver, partition 34, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 33.0 in stage 3.0 (TID 36) in 162 ms on localhost (executor driver) (34/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 34.0 in stage 3.0 (TID 37)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000034_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 35.0 in stage 3.0 (TID 38, localhost, executor driver, partition 35, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 35.0 in stage 3.0 (TID 38)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 34.0 in stage 3.0 (TID 37) in 124 ms on localhost (executor driver) (35/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000035_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 36.0 in stage 3.0 (TID 39, localhost, executor driver, partition 36, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 36.0 in stage 3.0 (TID 39)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 35.0 in stage 3.0 (TID 38) in 125 ms on localhost (executor driver) (36/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000036_0: Committed
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Starting task 37.0 in stage 3.0 (TID 40, localhost, executor driver, partition 37, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Running task 37.0 in stage 3.0 (TID 40)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Finished task 36.0 in stage 3.0 (TID 39) in 130 ms on localhost (executor driver) (37/200)
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:07] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142107_0003_m_000037_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 38.0 in stage 3.0 (TID 41, localhost, executor driver, partition 38, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 37.0 in stage 3.0 (TID 40) in 80 ms on localhost (executor driver) (38/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 38.0 in stage 3.0 (TID 41)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000038_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 39.0 in stage 3.0 (TID 42, localhost, executor driver, partition 39, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 39.0 in stage 3.0 (TID 42)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 38.0 in stage 3.0 (TID 41) in 126 ms on localhost (executor driver) (39/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000039_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 40.0 in stage 3.0 (TID 43, localhost, executor driver, partition 40, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 40.0 in stage 3.0 (TID 43)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 39.0 in stage 3.0 (TID 42) in 141 ms on localhost (executor driver) (40/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000040_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 41.0 in stage 3.0 (TID 44, localhost, executor driver, partition 41, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 41.0 in stage 3.0 (TID 44)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 40.0 in stage 3.0 (TID 43) in 93 ms on localhost (executor driver) (41/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000041_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 42.0 in stage 3.0 (TID 45, localhost, executor driver, partition 42, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 42.0 in stage 3.0 (TID 45)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 41.0 in stage 3.0 (TID 44) in 129 ms on localhost (executor driver) (42/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000042_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 43.0 in stage 3.0 (TID 46, localhost, executor driver, partition 43, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 43.0 in stage 3.0 (TID 46)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 42.0 in stage 3.0 (TID 45) in 92 ms on localhost (executor driver) (43/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000043_0: Committed
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Starting task 44.0 in stage 3.0 (TID 47, localhost, executor driver, partition 44, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Finished task 43.0 in stage 3.0 (TID 46) in 244 ms on localhost (executor driver) (44/200)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Running task 44.0 in stage 3.0 (TID 47)
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:08] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142108_0003_m_000044_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 45.0 in stage 3.0 (TID 48, localhost, executor driver, partition 45, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 45.0 in stage 3.0 (TID 48)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 44.0 in stage 3.0 (TID 47) in 134 ms on localhost (executor driver) (45/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000045_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 46.0 in stage 3.0 (TID 49, localhost, executor driver, partition 46, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 46.0 in stage 3.0 (TID 49)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 45.0 in stage 3.0 (TID 48) in 56 ms on localhost (executor driver) (46/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000046_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 47.0 in stage 3.0 (TID 50, localhost, executor driver, partition 47, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 46.0 in stage 3.0 (TID 49) in 81 ms on localhost (executor driver) (47/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 47.0 in stage 3.0 (TID 50)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000047_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 48.0 in stage 3.0 (TID 51, localhost, executor driver, partition 48, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 48.0 in stage 3.0 (TID 51)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 47.0 in stage 3.0 (TID 50) in 105 ms on localhost (executor driver) (48/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000048_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 49.0 in stage 3.0 (TID 52, localhost, executor driver, partition 49, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 49.0 in stage 3.0 (TID 52)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 48.0 in stage 3.0 (TID 51) in 94 ms on localhost (executor driver) (49/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000049_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 50.0 in stage 3.0 (TID 53, localhost, executor driver, partition 50, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 49.0 in stage 3.0 (TID 52) in 83 ms on localhost (executor driver) (50/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 50.0 in stage 3.0 (TID 53)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000050_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 51.0 in stage 3.0 (TID 54, localhost, executor driver, partition 51, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 50.0 in stage 3.0 (TID 53) in 128 ms on localhost (executor driver) (51/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 51.0 in stage 3.0 (TID 54)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000051_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 52.0 in stage 3.0 (TID 55, localhost, executor driver, partition 52, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 52.0 in stage 3.0 (TID 55)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 51.0 in stage 3.0 (TID 54) in 97 ms on localhost (executor driver) (52/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 2 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000052_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 53.0 in stage 3.0 (TID 56, localhost, executor driver, partition 53, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 52.0 in stage 3.0 (TID 55) in 111 ms on localhost (executor driver) (53/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 53.0 in stage 3.0 (TID 56)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000053_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 54.0 in stage 3.0 (TID 57, localhost, executor driver, partition 54, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 54.0 in stage 3.0 (TID 57)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 53.0 in stage 3.0 (TID 56) in 80 ms on localhost (executor driver) (54/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] attempt_20180428142109_0003_m_000054_0: Committed
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Starting task 55.0 in stage 3.0 (TID 58, localhost, executor driver, partition 55, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Running task 55.0 in stage 3.0 (TID 58)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Finished task 54.0 in stage 3.0 (TID 57) in 137 ms on localhost (executor driver) (55/200)
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:09] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000055_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 56.0 in stage 3.0 (TID 59, localhost, executor driver, partition 56, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 56.0 in stage 3.0 (TID 59)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 55.0 in stage 3.0 (TID 58) in 121 ms on localhost (executor driver) (56/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000056_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 57.0 in stage 3.0 (TID 60, localhost, executor driver, partition 57, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 56.0 in stage 3.0 (TID 59) in 90 ms on localhost (executor driver) (57/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 57.0 in stage 3.0 (TID 60)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000057_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 58.0 in stage 3.0 (TID 61, localhost, executor driver, partition 58, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 58.0 in stage 3.0 (TID 61)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 57.0 in stage 3.0 (TID 60) in 106 ms on localhost (executor driver) (58/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000058_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 59.0 in stage 3.0 (TID 62, localhost, executor driver, partition 59, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 59.0 in stage 3.0 (TID 62)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 58.0 in stage 3.0 (TID 61) in 257 ms on localhost (executor driver) (59/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000059_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 60.0 in stage 3.0 (TID 63, localhost, executor driver, partition 60, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 60.0 in stage 3.0 (TID 63)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 59.0 in stage 3.0 (TID 62) in 157 ms on localhost (executor driver) (60/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000060_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 61.0 in stage 3.0 (TID 64, localhost, executor driver, partition 61, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 61.0 in stage 3.0 (TID 64)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 60.0 in stage 3.0 (TID 63) in 50 ms on localhost (executor driver) (61/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000061_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 62.0 in stage 3.0 (TID 65, localhost, executor driver, partition 62, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 61.0 in stage 3.0 (TID 64) in 80 ms on localhost (executor driver) (62/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 62.0 in stage 3.0 (TID 65)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000062_0: Committed
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Starting task 63.0 in stage 3.0 (TID 66, localhost, executor driver, partition 63, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Running task 63.0 in stage 3.0 (TID 66)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Finished task 62.0 in stage 3.0 (TID 65) in 51 ms on localhost (executor driver) (63/200)
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:10] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142110_0003_m_000063_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 64.0 in stage 3.0 (TID 67, localhost, executor driver, partition 64, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 64.0 in stage 3.0 (TID 67)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 63.0 in stage 3.0 (TID 66) in 138 ms on localhost (executor driver) (64/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000064_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 65.0 in stage 3.0 (TID 68, localhost, executor driver, partition 65, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 64.0 in stage 3.0 (TID 67) in 50 ms on localhost (executor driver) (65/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 65.0 in stage 3.0 (TID 68)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 2 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000065_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 66.0 in stage 3.0 (TID 69, localhost, executor driver, partition 66, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 66.0 in stage 3.0 (TID 69)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 65.0 in stage 3.0 (TID 68) in 103 ms on localhost (executor driver) (66/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000066_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 67.0 in stage 3.0 (TID 70, localhost, executor driver, partition 67, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 67.0 in stage 3.0 (TID 70)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 66.0 in stage 3.0 (TID 69) in 89 ms on localhost (executor driver) (67/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000067_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 68.0 in stage 3.0 (TID 71, localhost, executor driver, partition 68, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 68.0 in stage 3.0 (TID 71)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 67.0 in stage 3.0 (TID 70) in 76 ms on localhost (executor driver) (68/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000068_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 69.0 in stage 3.0 (TID 72, localhost, executor driver, partition 69, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 69.0 in stage 3.0 (TID 72)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 68.0 in stage 3.0 (TID 71) in 113 ms on localhost (executor driver) (69/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000069_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 70.0 in stage 3.0 (TID 73, localhost, executor driver, partition 70, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 70.0 in stage 3.0 (TID 73)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 69.0 in stage 3.0 (TID 72) in 80 ms on localhost (executor driver) (70/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000070_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 71.0 in stage 3.0 (TID 74, localhost, executor driver, partition 71, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 71.0 in stage 3.0 (TID 74)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 70.0 in stage 3.0 (TID 73) in 121 ms on localhost (executor driver) (71/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000071_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 72.0 in stage 3.0 (TID 75, localhost, executor driver, partition 72, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 72.0 in stage 3.0 (TID 75)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 71.0 in stage 3.0 (TID 74) in 81 ms on localhost (executor driver) (72/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000072_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 73.0 in stage 3.0 (TID 76, localhost, executor driver, partition 73, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 73.0 in stage 3.0 (TID 76)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 72.0 in stage 3.0 (TID 75) in 127 ms on localhost (executor driver) (73/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000073_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 74.0 in stage 3.0 (TID 77, localhost, executor driver, partition 74, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 74.0 in stage 3.0 (TID 77)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 73.0 in stage 3.0 (TID 76) in 86 ms on localhost (executor driver) (74/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000074_0: Committed
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Starting task 75.0 in stage 3.0 (TID 78, localhost, executor driver, partition 75, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Running task 75.0 in stage 3.0 (TID 78)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Finished task 74.0 in stage 3.0 (TID 77) in 54 ms on localhost (executor driver) (75/200)
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:11] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142111_0003_m_000075_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 76.0 in stage 3.0 (TID 79, localhost, executor driver, partition 76, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 76.0 in stage 3.0 (TID 79)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 75.0 in stage 3.0 (TID 78) in 131 ms on localhost (executor driver) (76/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000076_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 77.0 in stage 3.0 (TID 80, localhost, executor driver, partition 77, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 76.0 in stage 3.0 (TID 79) in 108 ms on localhost (executor driver) (77/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 77.0 in stage 3.0 (TID 80)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000077_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 78.0 in stage 3.0 (TID 81, localhost, executor driver, partition 78, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 78.0 in stage 3.0 (TID 81)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 77.0 in stage 3.0 (TID 80) in 92 ms on localhost (executor driver) (78/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000078_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 79.0 in stage 3.0 (TID 82, localhost, executor driver, partition 79, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 79.0 in stage 3.0 (TID 82)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 78.0 in stage 3.0 (TID 81) in 74 ms on localhost (executor driver) (79/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000079_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 80.0 in stage 3.0 (TID 83, localhost, executor driver, partition 80, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 80.0 in stage 3.0 (TID 83)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 79.0 in stage 3.0 (TID 82) in 92 ms on localhost (executor driver) (80/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000080_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 81.0 in stage 3.0 (TID 84, localhost, executor driver, partition 81, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 81.0 in stage 3.0 (TID 84)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 80.0 in stage 3.0 (TID 83) in 48 ms on localhost (executor driver) (81/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000081_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 82.0 in stage 3.0 (TID 85, localhost, executor driver, partition 82, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 82.0 in stage 3.0 (TID 85)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 81.0 in stage 3.0 (TID 84) in 113 ms on localhost (executor driver) (82/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000082_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 83.0 in stage 3.0 (TID 86, localhost, executor driver, partition 83, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 83.0 in stage 3.0 (TID 86)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 82.0 in stage 3.0 (TID 85) in 62 ms on localhost (executor driver) (83/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000083_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 84.0 in stage 3.0 (TID 87, localhost, executor driver, partition 84, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 84.0 in stage 3.0 (TID 87)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 83.0 in stage 3.0 (TID 86) in 82 ms on localhost (executor driver) (84/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000084_0: Committed
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Starting task 85.0 in stage 3.0 (TID 88, localhost, executor driver, partition 85, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Running task 85.0 in stage 3.0 (TID 88)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Finished task 84.0 in stage 3.0 (TID 87) in 107 ms on localhost (executor driver) (85/200)
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:12] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142112_0003_m_000085_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 86.0 in stage 3.0 (TID 89, localhost, executor driver, partition 86, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 86.0 in stage 3.0 (TID 89)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 85.0 in stage 3.0 (TID 88) in 125 ms on localhost (executor driver) (86/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000086_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 87.0 in stage 3.0 (TID 90, localhost, executor driver, partition 87, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 87.0 in stage 3.0 (TID 90)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 86.0 in stage 3.0 (TID 89) in 202 ms on localhost (executor driver) (87/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000087_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 88.0 in stage 3.0 (TID 91, localhost, executor driver, partition 88, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 88.0 in stage 3.0 (TID 91)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 87.0 in stage 3.0 (TID 90) in 120 ms on localhost (executor driver) (88/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000088_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 89.0 in stage 3.0 (TID 92, localhost, executor driver, partition 89, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 88.0 in stage 3.0 (TID 91) in 60 ms on localhost (executor driver) (89/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 89.0 in stage 3.0 (TID 92)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000089_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 90.0 in stage 3.0 (TID 93, localhost, executor driver, partition 90, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 90.0 in stage 3.0 (TID 93)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 89.0 in stage 3.0 (TID 92) in 76 ms on localhost (executor driver) (90/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000090_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 91.0 in stage 3.0 (TID 94, localhost, executor driver, partition 91, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 91.0 in stage 3.0 (TID 94)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 90.0 in stage 3.0 (TID 93) in 46 ms on localhost (executor driver) (91/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000091_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 92.0 in stage 3.0 (TID 95, localhost, executor driver, partition 92, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 92.0 in stage 3.0 (TID 95)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 91.0 in stage 3.0 (TID 94) in 108 ms on localhost (executor driver) (92/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000092_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 93.0 in stage 3.0 (TID 96, localhost, executor driver, partition 93, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 93.0 in stage 3.0 (TID 96)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 92.0 in stage 3.0 (TID 95) in 46 ms on localhost (executor driver) (93/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000093_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 94.0 in stage 3.0 (TID 97, localhost, executor driver, partition 94, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 94.0 in stage 3.0 (TID 97)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 93.0 in stage 3.0 (TID 96) in 98 ms on localhost (executor driver) (94/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000094_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 95.0 in stage 3.0 (TID 98, localhost, executor driver, partition 95, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 95.0 in stage 3.0 (TID 98)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 94.0 in stage 3.0 (TID 97) in 47 ms on localhost (executor driver) (95/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000095_0: Committed
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Starting task 96.0 in stage 3.0 (TID 99, localhost, executor driver, partition 96, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Running task 96.0 in stage 3.0 (TID 99)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Finished task 95.0 in stage 3.0 (TID 98) in 154 ms on localhost (executor driver) (96/200)
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:13] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142113_0003_m_000096_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 97.0 in stage 3.0 (TID 100, localhost, executor driver, partition 97, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 96.0 in stage 3.0 (TID 99) in 45 ms on localhost (executor driver) (97/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 97.0 in stage 3.0 (TID 100)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000097_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 98.0 in stage 3.0 (TID 101, localhost, executor driver, partition 98, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 98.0 in stage 3.0 (TID 101)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 97.0 in stage 3.0 (TID 100) in 103 ms on localhost (executor driver) (98/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000098_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 99.0 in stage 3.0 (TID 102, localhost, executor driver, partition 99, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 99.0 in stage 3.0 (TID 102)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 98.0 in stage 3.0 (TID 101) in 120 ms on localhost (executor driver) (99/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000099_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 100.0 in stage 3.0 (TID 103, localhost, executor driver, partition 100, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 100.0 in stage 3.0 (TID 103)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 99.0 in stage 3.0 (TID 102) in 145 ms on localhost (executor driver) (100/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000100_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 101.0 in stage 3.0 (TID 104, localhost, executor driver, partition 101, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 101.0 in stage 3.0 (TID 104)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 100.0 in stage 3.0 (TID 103) in 98 ms on localhost (executor driver) (101/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000101_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 102.0 in stage 3.0 (TID 105, localhost, executor driver, partition 102, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 102.0 in stage 3.0 (TID 105)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 101.0 in stage 3.0 (TID 104) in 125 ms on localhost (executor driver) (102/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000102_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 103.0 in stage 3.0 (TID 106, localhost, executor driver, partition 103, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 102.0 in stage 3.0 (TID 105) in 128 ms on localhost (executor driver) (103/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 103.0 in stage 3.0 (TID 106)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000103_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 104.0 in stage 3.0 (TID 107, localhost, executor driver, partition 104, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 104.0 in stage 3.0 (TID 107)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 103.0 in stage 3.0 (TID 106) in 127 ms on localhost (executor driver) (104/200)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] attempt_20180428142114_0003_m_000104_0: Committed
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Starting task 105.0 in stage 3.0 (TID 108, localhost, executor driver, partition 105, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Running task 105.0 in stage 3.0 (TID 108)
[INFO ] [2018-04-28 14:21:14] [Logging$class:logInfo:54] Finished task 104.0 in stage 3.0 (TID 107) in 147 ms on localhost (executor driver) (105/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000105_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 106.0 in stage 3.0 (TID 109, localhost, executor driver, partition 106, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 106.0 in stage 3.0 (TID 109)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 105.0 in stage 3.0 (TID 108) in 156 ms on localhost (executor driver) (106/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000106_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 107.0 in stage 3.0 (TID 110, localhost, executor driver, partition 107, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 106.0 in stage 3.0 (TID 109) in 66 ms on localhost (executor driver) (107/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 107.0 in stage 3.0 (TID 110)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000107_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 108.0 in stage 3.0 (TID 111, localhost, executor driver, partition 108, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 108.0 in stage 3.0 (TID 111)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 107.0 in stage 3.0 (TID 110) in 66 ms on localhost (executor driver) (108/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000108_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 109.0 in stage 3.0 (TID 112, localhost, executor driver, partition 109, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 109.0 in stage 3.0 (TID 112)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 108.0 in stage 3.0 (TID 111) in 48 ms on localhost (executor driver) (109/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000109_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 110.0 in stage 3.0 (TID 113, localhost, executor driver, partition 110, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 110.0 in stage 3.0 (TID 113)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 109.0 in stage 3.0 (TID 112) in 55 ms on localhost (executor driver) (110/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000110_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 111.0 in stage 3.0 (TID 114, localhost, executor driver, partition 111, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 111.0 in stage 3.0 (TID 114)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 110.0 in stage 3.0 (TID 113) in 82 ms on localhost (executor driver) (111/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000111_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 112.0 in stage 3.0 (TID 115, localhost, executor driver, partition 112, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 112.0 in stage 3.0 (TID 115)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 111.0 in stage 3.0 (TID 114) in 76 ms on localhost (executor driver) (112/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000112_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 113.0 in stage 3.0 (TID 116, localhost, executor driver, partition 113, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 113.0 in stage 3.0 (TID 116)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 112.0 in stage 3.0 (TID 115) in 167 ms on localhost (executor driver) (113/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000113_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 114.0 in stage 3.0 (TID 117, localhost, executor driver, partition 114, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 114.0 in stage 3.0 (TID 117)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 113.0 in stage 3.0 (TID 116) in 118 ms on localhost (executor driver) (114/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000114_0: Committed
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Starting task 115.0 in stage 3.0 (TID 118, localhost, executor driver, partition 115, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Running task 115.0 in stage 3.0 (TID 118)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Finished task 114.0 in stage 3.0 (TID 117) in 118 ms on localhost (executor driver) (115/200)
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:15] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142115_0003_m_000115_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 116.0 in stage 3.0 (TID 119, localhost, executor driver, partition 116, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 116.0 in stage 3.0 (TID 119)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 115.0 in stage 3.0 (TID 118) in 82 ms on localhost (executor driver) (116/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000116_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 117.0 in stage 3.0 (TID 120, localhost, executor driver, partition 117, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 117.0 in stage 3.0 (TID 120)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 116.0 in stage 3.0 (TID 119) in 102 ms on localhost (executor driver) (117/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000117_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 118.0 in stage 3.0 (TID 121, localhost, executor driver, partition 118, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 118.0 in stage 3.0 (TID 121)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 117.0 in stage 3.0 (TID 120) in 50 ms on localhost (executor driver) (118/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000118_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 119.0 in stage 3.0 (TID 122, localhost, executor driver, partition 119, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 119.0 in stage 3.0 (TID 122)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 118.0 in stage 3.0 (TID 121) in 79 ms on localhost (executor driver) (119/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000119_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 120.0 in stage 3.0 (TID 123, localhost, executor driver, partition 120, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 120.0 in stage 3.0 (TID 123)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 119.0 in stage 3.0 (TID 122) in 222 ms on localhost (executor driver) (120/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000120_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 121.0 in stage 3.0 (TID 124, localhost, executor driver, partition 121, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 120.0 in stage 3.0 (TID 123) in 107 ms on localhost (executor driver) (121/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 121.0 in stage 3.0 (TID 124)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000121_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 122.0 in stage 3.0 (TID 125, localhost, executor driver, partition 122, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 122.0 in stage 3.0 (TID 125)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 121.0 in stage 3.0 (TID 124) in 145 ms on localhost (executor driver) (122/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000122_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 123.0 in stage 3.0 (TID 126, localhost, executor driver, partition 123, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 123.0 in stage 3.0 (TID 126)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 122.0 in stage 3.0 (TID 125) in 110 ms on localhost (executor driver) (123/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000123_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 124.0 in stage 3.0 (TID 127, localhost, executor driver, partition 124, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 123.0 in stage 3.0 (TID 126) in 51 ms on localhost (executor driver) (124/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 124.0 in stage 3.0 (TID 127)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000124_0: Committed
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Starting task 125.0 in stage 3.0 (TID 128, localhost, executor driver, partition 125, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Running task 125.0 in stage 3.0 (TID 128)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Finished task 124.0 in stage 3.0 (TID 127) in 80 ms on localhost (executor driver) (125/200)
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:16] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142116_0003_m_000125_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 126.0 in stage 3.0 (TID 129, localhost, executor driver, partition 126, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 126.0 in stage 3.0 (TID 129)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 125.0 in stage 3.0 (TID 128) in 78 ms on localhost (executor driver) (126/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000126_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 127.0 in stage 3.0 (TID 130, localhost, executor driver, partition 127, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 127.0 in stage 3.0 (TID 130)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 126.0 in stage 3.0 (TID 129) in 55 ms on localhost (executor driver) (127/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000127_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 128.0 in stage 3.0 (TID 131, localhost, executor driver, partition 128, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 128.0 in stage 3.0 (TID 131)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 127.0 in stage 3.0 (TID 130) in 99 ms on localhost (executor driver) (128/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000128_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 129.0 in stage 3.0 (TID 132, localhost, executor driver, partition 129, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 129.0 in stage 3.0 (TID 132)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 128.0 in stage 3.0 (TID 131) in 98 ms on localhost (executor driver) (129/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000129_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 130.0 in stage 3.0 (TID 133, localhost, executor driver, partition 130, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 129.0 in stage 3.0 (TID 132) in 110 ms on localhost (executor driver) (130/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 130.0 in stage 3.0 (TID 133)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000130_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 131.0 in stage 3.0 (TID 134, localhost, executor driver, partition 131, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 131.0 in stage 3.0 (TID 134)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 130.0 in stage 3.0 (TID 133) in 88 ms on localhost (executor driver) (131/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000131_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 132.0 in stage 3.0 (TID 135, localhost, executor driver, partition 132, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 131.0 in stage 3.0 (TID 134) in 67 ms on localhost (executor driver) (132/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 132.0 in stage 3.0 (TID 135)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000132_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 133.0 in stage 3.0 (TID 136, localhost, executor driver, partition 133, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 132.0 in stage 3.0 (TID 135) in 51 ms on localhost (executor driver) (133/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 133.0 in stage 3.0 (TID 136)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000133_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 134.0 in stage 3.0 (TID 137, localhost, executor driver, partition 134, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 134.0 in stage 3.0 (TID 137)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 133.0 in stage 3.0 (TID 136) in 152 ms on localhost (executor driver) (134/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000134_0: Committed
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Starting task 135.0 in stage 3.0 (TID 138, localhost, executor driver, partition 135, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Running task 135.0 in stage 3.0 (TID 138)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Finished task 134.0 in stage 3.0 (TID 137) in 166 ms on localhost (executor driver) (135/200)
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:17] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142117_0003_m_000135_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 136.0 in stage 3.0 (TID 139, localhost, executor driver, partition 136, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 136.0 in stage 3.0 (TID 139)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 135.0 in stage 3.0 (TID 138) in 128 ms on localhost (executor driver) (136/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000136_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 137.0 in stage 3.0 (TID 140, localhost, executor driver, partition 137, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 137.0 in stage 3.0 (TID 140)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 136.0 in stage 3.0 (TID 139) in 124 ms on localhost (executor driver) (137/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000137_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 138.0 in stage 3.0 (TID 141, localhost, executor driver, partition 138, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 138.0 in stage 3.0 (TID 141)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 137.0 in stage 3.0 (TID 140) in 74 ms on localhost (executor driver) (138/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000138_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 139.0 in stage 3.0 (TID 142, localhost, executor driver, partition 139, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 139.0 in stage 3.0 (TID 142)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 138.0 in stage 3.0 (TID 141) in 82 ms on localhost (executor driver) (139/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000139_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 140.0 in stage 3.0 (TID 143, localhost, executor driver, partition 140, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 140.0 in stage 3.0 (TID 143)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 139.0 in stage 3.0 (TID 142) in 46 ms on localhost (executor driver) (140/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000140_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 141.0 in stage 3.0 (TID 144, localhost, executor driver, partition 141, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 141.0 in stage 3.0 (TID 144)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 140.0 in stage 3.0 (TID 143) in 99 ms on localhost (executor driver) (141/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000141_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 142.0 in stage 3.0 (TID 145, localhost, executor driver, partition 142, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 142.0 in stage 3.0 (TID 145)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 141.0 in stage 3.0 (TID 144) in 45 ms on localhost (executor driver) (142/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000142_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 143.0 in stage 3.0 (TID 146, localhost, executor driver, partition 143, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 143.0 in stage 3.0 (TID 146)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 142.0 in stage 3.0 (TID 145) in 73 ms on localhost (executor driver) (143/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000143_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 144.0 in stage 3.0 (TID 147, localhost, executor driver, partition 144, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 144.0 in stage 3.0 (TID 147)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 143.0 in stage 3.0 (TID 146) in 115 ms on localhost (executor driver) (144/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000144_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 145.0 in stage 3.0 (TID 148, localhost, executor driver, partition 145, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 145.0 in stage 3.0 (TID 148)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 144.0 in stage 3.0 (TID 147) in 123 ms on localhost (executor driver) (145/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000145_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 146.0 in stage 3.0 (TID 149, localhost, executor driver, partition 146, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 146.0 in stage 3.0 (TID 149)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 145.0 in stage 3.0 (TID 148) in 47 ms on localhost (executor driver) (146/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000146_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 147.0 in stage 3.0 (TID 150, localhost, executor driver, partition 147, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 147.0 in stage 3.0 (TID 150)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 146.0 in stage 3.0 (TID 149) in 46 ms on localhost (executor driver) (147/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000147_0: Committed
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Starting task 148.0 in stage 3.0 (TID 151, localhost, executor driver, partition 148, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Running task 148.0 in stage 3.0 (TID 151)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Finished task 147.0 in stage 3.0 (TID 150) in 53 ms on localhost (executor driver) (148/200)
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:18] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142118_0003_m_000148_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 149.0 in stage 3.0 (TID 152, localhost, executor driver, partition 149, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 149.0 in stage 3.0 (TID 152)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 148.0 in stage 3.0 (TID 151) in 84 ms on localhost (executor driver) (149/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000149_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 150.0 in stage 3.0 (TID 153, localhost, executor driver, partition 150, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 150.0 in stage 3.0 (TID 153)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 149.0 in stage 3.0 (TID 152) in 127 ms on localhost (executor driver) (150/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000150_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 151.0 in stage 3.0 (TID 154, localhost, executor driver, partition 151, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 151.0 in stage 3.0 (TID 154)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 150.0 in stage 3.0 (TID 153) in 86 ms on localhost (executor driver) (151/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 4 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000151_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 152.0 in stage 3.0 (TID 155, localhost, executor driver, partition 152, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 152.0 in stage 3.0 (TID 155)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 151.0 in stage 3.0 (TID 154) in 79 ms on localhost (executor driver) (152/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000152_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 153.0 in stage 3.0 (TID 156, localhost, executor driver, partition 153, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 153.0 in stage 3.0 (TID 156)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 152.0 in stage 3.0 (TID 155) in 79 ms on localhost (executor driver) (153/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000153_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 154.0 in stage 3.0 (TID 157, localhost, executor driver, partition 154, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 153.0 in stage 3.0 (TID 156) in 55 ms on localhost (executor driver) (154/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 154.0 in stage 3.0 (TID 157)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000154_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 155.0 in stage 3.0 (TID 158, localhost, executor driver, partition 155, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 155.0 in stage 3.0 (TID 158)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 154.0 in stage 3.0 (TID 157) in 107 ms on localhost (executor driver) (155/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000155_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 156.0 in stage 3.0 (TID 159, localhost, executor driver, partition 156, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 156.0 in stage 3.0 (TID 159)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 155.0 in stage 3.0 (TID 158) in 137 ms on localhost (executor driver) (156/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000156_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 157.0 in stage 3.0 (TID 160, localhost, executor driver, partition 157, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 157.0 in stage 3.0 (TID 160)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 156.0 in stage 3.0 (TID 159) in 71 ms on localhost (executor driver) (157/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000157_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 158.0 in stage 3.0 (TID 161, localhost, executor driver, partition 158, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 158.0 in stage 3.0 (TID 161)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 157.0 in stage 3.0 (TID 160) in 137 ms on localhost (executor driver) (158/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000158_0: Committed
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Starting task 159.0 in stage 3.0 (TID 162, localhost, executor driver, partition 159, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Running task 159.0 in stage 3.0 (TID 162)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Finished task 158.0 in stage 3.0 (TID 161) in 82 ms on localhost (executor driver) (159/200)
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:19] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142119_0003_m_000159_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 160.0 in stage 3.0 (TID 163, localhost, executor driver, partition 160, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 160.0 in stage 3.0 (TID 163)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 159.0 in stage 3.0 (TID 162) in 45 ms on localhost (executor driver) (160/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000160_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 161.0 in stage 3.0 (TID 164, localhost, executor driver, partition 161, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 161.0 in stage 3.0 (TID 164)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 160.0 in stage 3.0 (TID 163) in 67 ms on localhost (executor driver) (161/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000161_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 162.0 in stage 3.0 (TID 165, localhost, executor driver, partition 162, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 161.0 in stage 3.0 (TID 164) in 110 ms on localhost (executor driver) (162/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 162.0 in stage 3.0 (TID 165)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000162_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 163.0 in stage 3.0 (TID 166, localhost, executor driver, partition 163, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 163.0 in stage 3.0 (TID 166)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 162.0 in stage 3.0 (TID 165) in 108 ms on localhost (executor driver) (163/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000163_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 164.0 in stage 3.0 (TID 167, localhost, executor driver, partition 164, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 164.0 in stage 3.0 (TID 167)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 163.0 in stage 3.0 (TID 166) in 125 ms on localhost (executor driver) (164/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000164_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 165.0 in stage 3.0 (TID 168, localhost, executor driver, partition 165, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 164.0 in stage 3.0 (TID 167) in 123 ms on localhost (executor driver) (165/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 165.0 in stage 3.0 (TID 168)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000165_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 166.0 in stage 3.0 (TID 169, localhost, executor driver, partition 166, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 166.0 in stage 3.0 (TID 169)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 165.0 in stage 3.0 (TID 168) in 329 ms on localhost (executor driver) (166/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000166_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Starting task 167.0 in stage 3.0 (TID 170, localhost, executor driver, partition 167, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Running task 167.0 in stage 3.0 (TID 170)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 166.0 in stage 3.0 (TID 169) in 60 ms on localhost (executor driver) (167/200)
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] attempt_20180428142120_0003_m_000167_0: Committed
[INFO ] [2018-04-28 14:21:20] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 168.0 in stage 3.0 (TID 171, localhost, executor driver, partition 168, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 168.0 in stage 3.0 (TID 171)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 167.0 in stage 3.0 (TID 170) in 49 ms on localhost (executor driver) (168/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000168_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 169.0 in stage 3.0 (TID 172, localhost, executor driver, partition 169, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 169.0 in stage 3.0 (TID 172)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 168.0 in stage 3.0 (TID 171) in 94 ms on localhost (executor driver) (169/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000169_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 170.0 in stage 3.0 (TID 173, localhost, executor driver, partition 170, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 169.0 in stage 3.0 (TID 172) in 79 ms on localhost (executor driver) (170/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 170.0 in stage 3.0 (TID 173)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000170_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 171.0 in stage 3.0 (TID 174, localhost, executor driver, partition 171, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 171.0 in stage 3.0 (TID 174)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 170.0 in stage 3.0 (TID 173) in 119 ms on localhost (executor driver) (171/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000171_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 172.0 in stage 3.0 (TID 175, localhost, executor driver, partition 172, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 172.0 in stage 3.0 (TID 175)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 171.0 in stage 3.0 (TID 174) in 83 ms on localhost (executor driver) (172/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000172_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 173.0 in stage 3.0 (TID 176, localhost, executor driver, partition 173, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 173.0 in stage 3.0 (TID 176)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 172.0 in stage 3.0 (TID 175) in 88 ms on localhost (executor driver) (173/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000173_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 174.0 in stage 3.0 (TID 177, localhost, executor driver, partition 174, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 174.0 in stage 3.0 (TID 177)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 173.0 in stage 3.0 (TID 176) in 67 ms on localhost (executor driver) (174/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000174_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 175.0 in stage 3.0 (TID 178, localhost, executor driver, partition 175, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 174.0 in stage 3.0 (TID 177) in 83 ms on localhost (executor driver) (175/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 175.0 in stage 3.0 (TID 178)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000175_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 176.0 in stage 3.0 (TID 179, localhost, executor driver, partition 176, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 176.0 in stage 3.0 (TID 179)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 175.0 in stage 3.0 (TID 178) in 76 ms on localhost (executor driver) (176/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000176_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 177.0 in stage 3.0 (TID 180, localhost, executor driver, partition 177, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 177.0 in stage 3.0 (TID 180)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 176.0 in stage 3.0 (TID 179) in 47 ms on localhost (executor driver) (177/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000177_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 178.0 in stage 3.0 (TID 181, localhost, executor driver, partition 178, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 178.0 in stage 3.0 (TID 181)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 177.0 in stage 3.0 (TID 180) in 50 ms on localhost (executor driver) (178/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000178_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 179.0 in stage 3.0 (TID 182, localhost, executor driver, partition 179, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 179.0 in stage 3.0 (TID 182)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 178.0 in stage 3.0 (TID 181) in 46 ms on localhost (executor driver) (179/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000179_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 180.0 in stage 3.0 (TID 183, localhost, executor driver, partition 180, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 180.0 in stage 3.0 (TID 183)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 179.0 in stage 3.0 (TID 182) in 50 ms on localhost (executor driver) (180/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000180_0: Committed
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Starting task 181.0 in stage 3.0 (TID 184, localhost, executor driver, partition 181, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Running task 181.0 in stage 3.0 (TID 184)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Finished task 180.0 in stage 3.0 (TID 183) in 47 ms on localhost (executor driver) (181/200)
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:21] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142121_0003_m_000181_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 182.0 in stage 3.0 (TID 185, localhost, executor driver, partition 182, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 182.0 in stage 3.0 (TID 185)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 181.0 in stage 3.0 (TID 184) in 101 ms on localhost (executor driver) (182/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000182_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 183.0 in stage 3.0 (TID 186, localhost, executor driver, partition 183, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 183.0 in stage 3.0 (TID 186)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 182.0 in stage 3.0 (TID 185) in 49 ms on localhost (executor driver) (183/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000183_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 184.0 in stage 3.0 (TID 187, localhost, executor driver, partition 184, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 184.0 in stage 3.0 (TID 187)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 183.0 in stage 3.0 (TID 186) in 74 ms on localhost (executor driver) (184/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000184_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 185.0 in stage 3.0 (TID 188, localhost, executor driver, partition 185, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 185.0 in stage 3.0 (TID 188)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 184.0 in stage 3.0 (TID 187) in 93 ms on localhost (executor driver) (185/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000185_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188). 3771 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 186.0 in stage 3.0 (TID 189, localhost, executor driver, partition 186, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 186.0 in stage 3.0 (TID 189)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 185.0 in stage 3.0 (TID 188) in 105 ms on localhost (executor driver) (186/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000186_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189). 3642 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 187.0 in stage 3.0 (TID 190, localhost, executor driver, partition 187, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 187.0 in stage 3.0 (TID 190)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 186.0 in stage 3.0 (TID 189) in 92 ms on localhost (executor driver) (187/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000187_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 188.0 in stage 3.0 (TID 191, localhost, executor driver, partition 188, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 188.0 in stage 3.0 (TID 191)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 187.0 in stage 3.0 (TID 190) in 101 ms on localhost (executor driver) (188/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000188_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 189.0 in stage 3.0 (TID 192, localhost, executor driver, partition 189, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 189.0 in stage 3.0 (TID 192)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 188.0 in stage 3.0 (TID 191) in 104 ms on localhost (executor driver) (189/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000189_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 190.0 in stage 3.0 (TID 193, localhost, executor driver, partition 190, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 190.0 in stage 3.0 (TID 193)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 189.0 in stage 3.0 (TID 192) in 95 ms on localhost (executor driver) (190/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000190_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 191.0 in stage 3.0 (TID 194, localhost, executor driver, partition 191, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 191.0 in stage 3.0 (TID 194)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 190.0 in stage 3.0 (TID 193) in 129 ms on localhost (executor driver) (191/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000191_0: Committed
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Starting task 192.0 in stage 3.0 (TID 195, localhost, executor driver, partition 192, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Running task 192.0 in stage 3.0 (TID 195)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Finished task 191.0 in stage 3.0 (TID 194) in 80 ms on localhost (executor driver) (192/200)
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:22] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142122_0003_m_000192_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 193.0 in stage 3.0 (TID 196, localhost, executor driver, partition 193, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 193.0 in stage 3.0 (TID 196)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 192.0 in stage 3.0 (TID 195) in 120 ms on localhost (executor driver) (193/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000193_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 194.0 in stage 3.0 (TID 197, localhost, executor driver, partition 194, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 194.0 in stage 3.0 (TID 197)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 193.0 in stage 3.0 (TID 196) in 126 ms on localhost (executor driver) (194/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000194_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 195.0 in stage 3.0 (TID 198, localhost, executor driver, partition 195, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 195.0 in stage 3.0 (TID 198)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 194.0 in stage 3.0 (TID 197) in 100 ms on localhost (executor driver) (195/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000195_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 196.0 in stage 3.0 (TID 199, localhost, executor driver, partition 196, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 196.0 in stage 3.0 (TID 199)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 195.0 in stage 3.0 (TID 198) in 88 ms on localhost (executor driver) (196/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000196_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 197.0 in stage 3.0 (TID 200, localhost, executor driver, partition 197, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 197.0 in stage 3.0 (TID 200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 196.0 in stage 3.0 (TID 199) in 94 ms on localhost (executor driver) (197/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000197_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 198.0 in stage 3.0 (TID 201, localhost, executor driver, partition 198, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 197.0 in stage 3.0 (TID 200) in 48 ms on localhost (executor driver) (198/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 198.0 in stage 3.0 (TID 201)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000198_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201). 3685 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Starting task 199.0 in stage 3.0 (TID 202, localhost, executor driver, partition 199, ANY, 5054 bytes)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Running task 199.0 in stage 3.0 (TID 202)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 198.0 in stage 3.0 (TID 201) in 49 ms on localhost (executor driver) (199/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 1 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Getting 1 non-empty blocks out of 1 blocks
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Started 0 remote fetches in 0 ms
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "bar_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : {
      "HIVE_TYPE_STRING" : "string"
    }
  }, {
    "name" : "flow_no",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "banner_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "retailer_shop_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "good_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_time",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "trade_date_timestamp",
    "type" : "long",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "card_code",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "quantity",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "price",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "amount",
    "type" : "float",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "pay_type",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "is_useful",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary bar_code (UTF8);
  optional binary flow_no (UTF8);
  optional binary banner_code (UTF8);
  optional binary retailer_shop_code (UTF8);
  optional binary good_code (UTF8);
  optional binary trade_date_time (UTF8);
  optional int64 trade_date_timestamp;
  optional binary card_code (UTF8);
  optional float quantity;
  optional float price;
  optional float amount;
  optional binary pay_type (UTF8);
  optional int32 is_useful;
}

       
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] attempt_20180428142123_0003_m_000199_0: Committed
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202). 3728 bytes result sent to driver
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Finished task 199.0 in stage 3.0 (TID 202) in 48 ms on localhost (executor driver) (200/200)
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Removed TaskSet 3.0, whose tasks have all completed, from pool 
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] ResultStage 3 (saveAsTable at HistoryDataToA_DateRange.scala:114) finished in 21.612 s
[INFO ] [2018-04-28 14:21:23] [Logging$class:logInfo:54] Job 1 finished: saveAsTable at HistoryDataToA_DateRange.scala:114, took 26.300910 s
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] Job null committed.
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] Stopped Spark web UI at http://192.168.0.152:4040
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] MapOutputTrackerMasterEndpoint stopped!
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] MemoryStore cleared
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] BlockManager stopped
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] BlockManagerMaster stopped
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] OutputCommitCoordinator stopped!
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] Successfully stopped SparkContext
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] Shutdown hook called
[INFO ] [2018-04-28 14:21:29] [Logging$class:logInfo:54] Deleting directory C:\Users\SAM\AppData\Local\Temp\spark-5d8affad-2a1e-4035-9b24-3e8624838a3e
